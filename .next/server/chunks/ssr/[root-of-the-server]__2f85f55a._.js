module.exports=[43285,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/dynamic-access-async-storage.external.js",()=>require("next/dist/server/app-render/dynamic-access-async-storage.external.js"))},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24725,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},68209,a=>{"use strict";var b=a.i(20237);a.i(69387);var c=a.i(60574);let d=[{id:"q1",title:"Synthesis Master",description:"Build 3 Molecules",total:3,type:"build_molecule"},{id:"q2",title:"Lab Rat",description:"Earn 500 XP",total:500,type:"earn_xp"},{id:"q3",title:"Daily Discovery",description:"Build 1 Complex Molecule",total:1,type:"build_molecule"}];a.s(["UserService",0,{async getProfile(a,e,f){let g=(0,c.doc)(b.db,"users",a),h=await (0,c.getDoc)(g);if(h.exists()){let a=h.data(),b=Date.now();if(!a.lastLogin||b-a.lastLogin>864e5||!a.dailyQuests){let e=d.slice(0,2).map(a=>({...a,progress:0,completed:!1}));await (0,c.updateDoc)(g,{dailyQuests:e,lastLogin:b}),a.dailyQuests=e}return a}{let b=d.slice(0,2).map(a=>({...a,progress:0,completed:!1})),h={uid:a,email:e,displayName:f||"Researcher "+a.slice(0,4),xp:0,level:1,reputation:100,moleculesDiscovered:0,dailyQuests:b,lastLogin:Date.now(),achievements:[],topicMastery:{kinetics:1,regulatory:1,pharmacology:1,chemistry:1}};return await (0,c.setDoc)(g,h),h}},async updateDisplayName(a,d){let e=d.trim();if(!e)throw Error("Display name cannot be empty");let f=(0,c.doc)(b.db,"users",a);return await (0,c.updateDoc)(f,{displayName:e}),e},async updateQuestProgress(a,d,e){let f=(0,c.doc)(b.db,"users",a),g=await (0,c.getDoc)(f);if(g.exists()){let a=g.data(),b=!1,h=(a.dailyQuests||[]).map(a=>{if(a.type===d&&!a.completed){let c=Math.min(a.progress+e,a.total);return b=!0,{...a,progress:c,completed:c>=a.total}}return a});b&&await (0,c.updateDoc)(f,{dailyQuests:h})}},async unlockAchievement(a,d){let e=(0,c.doc)(b.db,"users",a),f=await (0,c.getDoc)(e);if(f.exists()){let a=f.data();if(!(a.achievements||[]).find(a=>a.id===d.id)){let b={...d,unlockedAt:Date.now()};return await (0,c.updateDoc)(e,{achievements:[...a.achievements||[],b]}),b}}return null},async addXP(a,d){let e=(0,c.doc)(b.db,"users",a),f=await (0,c.getDoc)(e);if(f.exists()){let a=f.data(),b=a.xp+d,g=Math.floor(b/1e3)+1;return await (0,c.updateDoc)(e,{xp:b,level:g,moleculesDiscovered:a.moleculesDiscovered+1}),{newXP:b,newLevel:g}}return null},async getLeaderboard(){let a=(0,c.query)((0,c.collection)(b.db,"users"),(0,c.orderBy)("xp","desc"),(0,c.limit)(50));return(await (0,c.getDocs)(a)).docs.map(a=>a.data())},async getUserRank(a){let d=(0,c.query)((0,c.collection)(b.db,"users"),(0,c.orderBy)("xp","desc"),(0,c.limit)(100)),e=(await (0,c.getDocs)(d)).docs.map(a=>a.id).indexOf(a);return -1!==e?e+1:1e3},async updateTopicMastery(a,d,e){let f=(0,c.doc)(b.db,"users",a),g=await (0,c.getDoc)(f);if(g.exists()){let a=g.data(),b=Math.max(1,Math.min(5,(a.topicMastery?.[d]||1)+e));return await (0,c.updateDoc)(f,{[`topicMastery.${d}`]:b}),b}return 1}}])},56025,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(30485);var d=a.i(70896),e=a.i(20237),f=a.i(68209);let g=(0,c.createContext)({user:null,profile:null,loading:!0,refreshProfile:async()=>{}});a.s(["AuthProvider",0,({children:a})=>{let[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(!0),n=async a=>{try{let b=await f.UserService.getProfile(a.uid,a.email||"",a.displayName||"");k(b)}catch(a){console.error("Error fetching profile:",a)}};(0,c.useEffect)(()=>{let a=(0,d.onAuthStateChanged)(e.auth,async a=>{i(a),a?await n(a):k(null),m(!1)});return()=>a()},[]);let o=async()=>{h&&await n(h)};return(0,b.jsx)(g.Provider,{value:{user:h,profile:j,loading:l,refreshProfile:o},children:a})},"useAuth",0,()=>(0,c.useContext)(g)])},51234,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"HandleISRError",{enumerable:!0,get:function(){return e}});let d=a.r(56704).workAsyncStorage;function e({error:a}){if(d){let b=d.getStore();if(b?.isStaticGeneration)throw a&&console.error(a),a}return null}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},40622,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(51234),f={fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},g={fontSize:"14px",fontWeight:400,lineHeight:"28px",margin:"0 8px"},h=function({error:a}){let b=a?.digest;return(0,d.jsxs)("html",{id:"__next_error__",children:[(0,d.jsx)("head",{}),(0,d.jsxs)("body",{children:[(0,d.jsx)(e.HandleISRError,{error:a}),(0,d.jsx)("div",{style:f,children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("h2",{style:g,children:["Application error: a ",b?"server":"client","-side exception has occurred while loading ",window.location.hostname," (see the"," ",b?"server logs":"browser console"," for more information)."]}),b?(0,d.jsx)("p",{style:g,children:`Digest: ${b}`}):null]})})]})]})};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},27454,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025);class e extends Error{constructor(a){super(`UltraContext request failed: ${a.status} ${a.url}`),this.name="UltraContextHttpError",this.status=a.status,this.url=a.url,this.bodyText=a.bodyText}}class f{constructor(a){this.baseUrl=(a.baseUrl??"https://api.ultracontext.ai").replace(/\/+$/,""),this.apiKey=a.apiKey,this.fetchFn=a.fetch??fetch,this.headers=a.headers,this.timeoutMs=a.timeoutMs}async create(a={}){return this.request("/contexts",{method:"POST",body:a})}async append(a,b){return this.request(`/contexts/${encodeURIComponent(a)}`,{method:"POST",body:b})}async get(a,b){if(!a||"object"==typeof a){let b=new URLSearchParams;"object"==typeof a&&a.limit&&b.set("limit",String(a.limit));let c=b.toString();return this.request(`/contexts${c?`?${c}`:""}`,{method:"GET"})}let c=new URLSearchParams;b?.version!==void 0&&c.set("version",String(b.version)),b?.at!==void 0&&c.set("at",String(b.at)),b?.before&&c.set("before",b.before),b?.history&&c.set("history","true");let d=c.toString();return this.request(`/contexts/${encodeURIComponent(a)}${d?`?${d}`:""}`,{method:"GET"})}async update(a,b,c){let d=c?.metadata?{updates:Array.isArray(b)?b:[b],metadata:c.metadata}:b;return this.request(`/contexts/${encodeURIComponent(a)}`,{method:"PATCH",body:d})}async delete(a,b,c){return this.request(`/contexts/${encodeURIComponent(a)}`,{method:"DELETE",body:{ids:b,metadata:c?.metadata}})}async request(a,b){let c,d=`${this.baseUrl}${a.startsWith("/")?"":"/"}${a}`,f={Authorization:`Bearer ${this.apiKey}`,...this.headers??{},...b.headers??{}};void 0!==b.body&&(f["Content-Type"]=f["Content-Type"]??"application/json",c=JSON.stringify(b.body));let h=this.timeoutMs?new AbortController:void 0,i=this.timeoutMs?setTimeout(()=>h?.abort(),this.timeoutMs):void 0;try{let a=await this.fetchFn(d,{method:b.method,headers:f,body:c,signal:h?.signal});if(!a.ok){let b=await g(a);throw new e({status:a.status,url:d,bodyText:b})}if(204===a.status)return;if((a.headers.get("content-type")??"").includes("application/json"))return await a.json();return await a.text()}finally{i&&clearTimeout(i)}}}async function g(a){try{return await a.text()}catch{return}}let h=null;function i(){return h||(h=new f({apiKey:"uc_live_OuU12w0yaepGFV1sIYl1sKtpT6E3TAvx"})),h}let j={async createContext(a){try{let b=i(),c=await b.create({metadata:a});return console.log("[UltraContext] Created context:",c.id),c}catch(a){throw console.error("[UltraContext] Failed to create context:",a),a}},async forkContext(a,b){try{let c=i(),d=await c.create({from:a,...void 0!==b&&{version:b}});return console.log("[UltraContext] Forked context:",d.id,"from:",a),d}catch(a){throw console.error("[UltraContext] Failed to fork context:",a),a}},async getContext(a,b){try{let c=i();return await c.get(a,b)}catch(a){throw console.error("[UltraContext] Failed to get context:",a),a}},async listContexts(){try{let a=i();return(await a.get()).data||[]}catch(a){throw console.error("[UltraContext] Failed to list contexts:",a),a}},async appendMessage(a,b){try{let c=i();await c.append(a,b),console.log("[UltraContext] Appended message(s) to:",a)}catch(a){throw console.error("[UltraContext] Failed to append message:",a),a}},async updateMessage(a,b){try{let c=i();await c.update(a,b),console.log("[UltraContext] Updated message in:",a)}catch(a){throw console.error("[UltraContext] Failed to update message:",a),a}},async deleteMessage(a,b){try{let c=i();await c.delete(a,b),console.log("[UltraContext] Deleted message from:",a)}catch(a){throw console.error("[UltraContext] Failed to delete message:",a),a}},async getContextAtVersion(a,b){return this.getContext(a,{version:b})},async getContextWithHistory(a){return this.getContext(a,{history:!0})},async createMoleculeAnalysisContext(a,b){return this.createContext({userId:a,feature:"molecule-analysis",createdAt:new Date().toISOString(),moleculeName:b})},async createQuizContext(a,b){return this.createContext({userId:a,feature:"quiz",createdAt:new Date().toISOString(),topic:b})},async createTrialContext(a,b){return this.createContext({userId:a,feature:"clinical-trial",createdAt:new Date().toISOString(),trialId:b})},async saveConversationExchange(a,b,c){await this.appendMessage(a,[{role:"user",content:b},{role:"assistant",content:c}])}},k=(0,c.createContext)(null);function l({children:a}){let{user:e}=(0,d.useAuth)(),[f,g]=(0,c.useState)({activeContextId:null,isLoading:!1,error:null}),h=a=>{g(b=>({...b,isLoading:a}))},i=a=>{g(b=>({...b,error:a,isLoading:!1}))},l=(0,c.useCallback)(()=>{g(a=>({...a,error:null}))},[]),m=(0,c.useCallback)(a=>{g(b=>({...b,activeContextId:a}))},[]),n=(0,c.useCallback)(async a=>{h(!0);try{let b=await j.createContext({userId:e?.uid,...a});return g(a=>({...a,activeContextId:b.id,isLoading:!1,error:null})),b}catch(a){return i(a instanceof Error?a.message:"Failed to create context"),null}},[e?.uid]),o=(0,c.useCallback)(async a=>{if(!e?.uid)return i("User not authenticated"),null;h(!0);try{let b=await j.createMoleculeAnalysisContext(e.uid,a);return g(a=>({...a,activeContextId:b.id,isLoading:!1,error:null})),b}catch(a){return i(a instanceof Error?a.message:"Failed to create molecule context"),null}},[e?.uid]),p=(0,c.useCallback)(async a=>{if(!e?.uid)return i("User not authenticated"),null;h(!0);try{let b=await j.createQuizContext(e.uid,a);return g(a=>({...a,activeContextId:b.id,isLoading:!1,error:null})),b}catch(a){return i(a instanceof Error?a.message:"Failed to create quiz context"),null}},[e?.uid]),q=(0,c.useCallback)(async a=>{if(!e?.uid)return i("User not authenticated"),null;h(!0);try{let b=await j.createTrialContext(e.uid,a);return g(a=>({...a,activeContextId:b.id,isLoading:!1,error:null})),b}catch(a){return i(a instanceof Error?a.message:"Failed to create trial context"),null}},[e?.uid]),r=(0,c.useCallback)(async()=>{if(!f.activeContextId)return console.warn("[UltraContext] No active context"),[];try{return(await j.getContext(f.activeContextId)).data||[]}catch(a){return console.error("[UltraContext] Failed to get messages:",a),[]}},[f.activeContextId]),s=(0,c.useCallback)(async a=>{if(!f.activeContextId)return void i("No active context");try{await j.appendMessage(f.activeContextId,a)}catch(a){i(a instanceof Error?a.message:"Failed to append message")}},[f.activeContextId]),t=(0,c.useCallback)(async(a,b)=>{if(!f.activeContextId)return void i("No active context");try{await j.saveConversationExchange(f.activeContextId,a,b)}catch(a){i(a instanceof Error?a.message:"Failed to save exchange")}},[f.activeContextId]),u=(0,c.useCallback)(async()=>{if(!f.activeContextId)return console.warn("[UltraContext] No active context"),null;try{return await j.getContextWithHistory(f.activeContextId)}catch(a){return console.error("[UltraContext] Failed to get history:",a),null}},[f.activeContextId]),v={...f,createContext:n,createMoleculeContext:o,createQuizContext:p,createTrialContext:q,setActiveContext:m,getMessages:r,appendMessage:s,saveExchange:t,getHistory:u,clearError:l};return(0,b.jsx)(k.Provider,{value:v,children:a})}function m(){let a=(0,c.useContext)(k);if(!a)throw Error("useUltraContext must be used within an UltraContextProvider");return a}a.s(["UltraContextProvider",()=>l,"default",0,l,"useUltraContext",()=>m],27454)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2f85f55a._.js.map