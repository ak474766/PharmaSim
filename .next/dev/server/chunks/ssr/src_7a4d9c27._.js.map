{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/layout/TopHeader.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actions\": \"TopHeader-module__TNE3sW__actions\",\n  \"header\": \"TopHeader-module__TNE3sW__header\",\n  \"iconBtn\": \"TopHeader-module__TNE3sW__iconBtn\",\n  \"primaryBtn\": \"TopHeader-module__TNE3sW__primaryBtn\",\n  \"subtitle\": \"TopHeader-module__TNE3sW__subtitle\",\n  \"title\": \"TopHeader-module__TNE3sW__title\",\n  \"titleSection\": \"TopHeader-module__TNE3sW__titleSection\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/components/layout/TopHeader.tsx"],"sourcesContent":["\n'use client';\n\nimport styles from './TopHeader.module.css';\n\ninterface TopHeaderProps {\n    title?: string;\n    subtitle?: string;\n}\n\nexport default function TopHeader({ title = \"Research Lab Dashboard\", subtitle = \"Welcome back, researcher. Your next breakthrough awaits.\" }: TopHeaderProps) {\n    return (\n        <header className={styles.header}>\n            <div className={styles.titleSection}>\n                <h1 className={styles.title}>{title}</h1>\n                <p className={styles.subtitle}>{subtitle}</p>\n            </div>\n\n            <div className={styles.actions}>\n                <button className={styles.iconBtn}>\n                    ðŸ””\n                </button>\n                <button className={styles.primaryBtn}>\n                    <span>+</span> New Simulation\n                </button>\n            </div>\n        </header>\n    );\n}\n"],"names":[],"mappings":";;;;;AAGA;AAFA;;;AASe,SAAS,UAAU,EAAE,QAAQ,wBAAwB,EAAE,WAAW,0DAA0D,EAAkB;IACzJ,qBACI,8OAAC;QAAO,WAAW,+JAAM,CAAC,MAAM;;0BAC5B,8OAAC;gBAAI,WAAW,+JAAM,CAAC,YAAY;;kCAC/B,8OAAC;wBAAG,WAAW,+JAAM,CAAC,KAAK;kCAAG;;;;;;kCAC9B,8OAAC;wBAAE,WAAW,+JAAM,CAAC,QAAQ;kCAAG;;;;;;;;;;;;0BAGpC,8OAAC;gBAAI,WAAW,+JAAM,CAAC,OAAO;;kCAC1B,8OAAC;wBAAO,WAAW,+JAAM,CAAC,OAAO;kCAAE;;;;;;kCAGnC,8OAAC;wBAAO,WAAW,+JAAM,CAAC,UAAU;;0CAChC,8OAAC;0CAAK;;;;;;4BAAQ;;;;;;;;;;;;;;;;;;;AAKlC"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/chemistry.ts"],"sourcesContent":["\nexport interface ElementData {\n    name: string;\n    symbol: string;\n    atomicNumber: number;\n    color: number; // Hex color\n    radius: number; // Van der Waals radius (approx) mechanism\n    mass: number;\n    valence: number[]; // Common valences\n}\n\nexport const PeriodicTable: Record<string, ElementData> = {\n    H: { name: 'Hydrogen', symbol: 'H', atomicNumber: 1, color: 0xffffff, radius: 0.8, mass: 1.008, valence: [1] },\n    C: { name: 'Carbon', symbol: 'C', atomicNumber: 6, color: 0x909090, radius: 1.2, mass: 12.011, valence: [4] },\n    N: { name: 'Nitrogen', symbol: 'N', atomicNumber: 7, color: 0x3050f8, radius: 1.1, mass: 14.007, valence: [3, 4, 5] },\n    O: { name: 'Oxygen', symbol: 'O', atomicNumber: 8, color: 0xff0d0d, radius: 1.0, mass: 15.999, valence: [2] },\n    F: { name: 'Fluorine', symbol: 'F', atomicNumber: 9, color: 0x90e050, radius: 0.9, mass: 18.998, valence: [1] },\n    P: { name: 'Phosphorus', symbol: 'P', atomicNumber: 15, color: 0xff8000, radius: 1.3, mass: 30.974, valence: [3, 5] },\n    S: { name: 'Sulfur', symbol: 'S', atomicNumber: 16, color: 0xffff30, radius: 1.3, mass: 32.06, valence: [2, 4, 6] },\n    Cl: { name: 'Chlorine', symbol: 'Cl', atomicNumber: 17, color: 0x1ff01f, radius: 1.2, mass: 35.45, valence: [1] },\n    Br: { name: 'Bromine', symbol: 'Br', atomicNumber: 35, color: 0xa62929, radius: 1.4, mass: 79.904, valence: [1] },\n    I: { name: 'Iodine', symbol: 'I', atomicNumber: 53, color: 0x940094, radius: 1.6, mass: 126.90, valence: [1] },\n};\n\nexport interface Atom {\n    id: number;\n    element: string; // Symbol\n    x: number;\n    y: number;\n    z: number;\n}\n\nexport interface Bond {\n    id: number;\n    sourceId: number;\n    targetId: number;\n    order: number; // 1, 2, 3\n}\n\nexport interface MoleculeData {\n    atoms: Atom[];\n    bonds: Bond[];\n}\n"],"names":[],"mappings":";;;;AAWO,MAAM,gBAA6C;IACtD,GAAG;QAAE,MAAM;QAAY,QAAQ;QAAK,cAAc;QAAG,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAO,SAAS;YAAC;SAAE;IAAC;IAC7G,GAAG;QAAE,MAAM;QAAU,QAAQ;QAAK,cAAc;QAAG,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;SAAE;IAAC;IAC5G,GAAG;QAAE,MAAM;QAAY,QAAQ;QAAK,cAAc;QAAG,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;YAAG;YAAG;SAAE;IAAC;IACpH,GAAG;QAAE,MAAM;QAAU,QAAQ;QAAK,cAAc;QAAG,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;SAAE;IAAC;IAC5G,GAAG;QAAE,MAAM;QAAY,QAAQ;QAAK,cAAc;QAAG,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;SAAE;IAAC;IAC9G,GAAG;QAAE,MAAM;QAAc,QAAQ;QAAK,cAAc;QAAI,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;YAAG;SAAE;IAAC;IACpH,GAAG;QAAE,MAAM;QAAU,QAAQ;QAAK,cAAc;QAAI,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAO,SAAS;YAAC;YAAG;YAAG;SAAE;IAAC;IAClH,IAAI;QAAE,MAAM;QAAY,QAAQ;QAAM,cAAc;QAAI,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAO,SAAS;YAAC;SAAE;IAAC;IAChH,IAAI;QAAE,MAAM;QAAW,QAAQ;QAAM,cAAc;QAAI,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;SAAE;IAAC;IAChH,GAAG;QAAE,MAAM;QAAU,QAAQ;QAAK,cAAc;QAAI,OAAO;QAAU,QAAQ;QAAK,MAAM;QAAQ,SAAS;YAAC;SAAE;IAAC;AACjH"}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/Molecule3D.ts"],"sourcesContent":["\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { Atom, Bond, PeriodicTable } from './chemistry';\n\nexport class MoleculeScene {\n    private scene: THREE.Scene;\n    private camera: THREE.PerspectiveCamera;\n    private renderer: THREE.WebGLRenderer;\n    private controls: OrbitControls;\n    private raycaster: THREE.Raycaster;\n    private mouse: THREE.Vector2;\n    private container: HTMLElement;\n\n    // Data\n    private atoms: Atom[] = [];\n    private bonds: Bond[] = [];\n    private atomMeshes: Map<number, THREE.Mesh> = new Map();\n    private bondMeshes: Map<number, THREE.Mesh[]> = new Map();\n\n    // Interaction\n    private onAtomClick?: (atomId: number) => void;\n    private onEmptyClick?: (position: THREE.Vector3) => void;\n    private onAtomHover?: (atom: Atom | null) => void;\n\n    private ghostMesh: THREE.Mesh | null = null;\n    private hoveredAtomId: number | null = null;\n\n    constructor(\n        container: HTMLElement,\n        width: number,\n        height: number,\n        onAtomClick?: (id: number) => void,\n        onEmptyClick?: (pos: THREE.Vector3) => void,\n        onAtomHover?: (atom: Atom | null) => void\n    ) {\n        this.container = container;\n        this.onAtomClick = onAtomClick;\n        this.onEmptyClick = onEmptyClick;\n        this.onAtomHover = onAtomHover;\n\n        // Scene Setup\n        this.scene = new THREE.Scene();\n        this.scene.background = new THREE.Color(0x050508);\n        this.scene.fog = new THREE.Fog(0x050508, 15, 60);\n\n        // Camera\n        this.camera = new THREE.PerspectiveCamera(55, width / height, 0.1, 1000);\n        this.camera.position.set(0, 8, 18);\n\n        // Renderer\n        this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n        this.renderer.setSize(width, height);\n        this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n        container.appendChild(this.renderer.domElement);\n\n        // Controls\n        this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n        this.controls.enableDamping = true;\n        this.controls.dampingFactor = 0.05;\n        this.controls.minDistance = 5;\n        this.controls.maxDistance = 50;\n\n        // Lights\n        const ambientLight = new THREE.AmbientLight(0x404050, 2);\n        this.scene.add(ambientLight);\n\n        const pointLight = new THREE.PointLight(0xffffff, 2.5);\n        pointLight.position.set(10, 15, 10);\n        this.scene.add(pointLight);\n\n        const dirLight = new THREE.DirectionalLight(0xffffff, 1.5);\n        dirLight.position.set(-5, 10, -5);\n        this.scene.add(dirLight);\n\n        // Grid\n        const gridHelper = new THREE.GridHelper(40, 40, 0x333340, 0x1a1a25);\n        this.scene.add(gridHelper);\n\n        // Interaction\n        this.raycaster = new THREE.Raycaster();\n        this.mouse = new THREE.Vector2();\n\n        // Event Listeners\n        this.renderer.domElement.addEventListener('click', this.handleClick.bind(this));\n        this.renderer.domElement.addEventListener('mousemove', this.handleMouseMove.bind(this));\n\n        // Start Loop\n        this.animate();\n    }\n\n    public updateGhost(elementSymbol: string | null) {\n        if (this.ghostMesh) {\n            this.scene.remove(this.ghostMesh);\n            this.ghostMesh = null;\n        }\n\n        if (elementSymbol && PeriodicTable[elementSymbol]) {\n            const data = PeriodicTable[elementSymbol];\n            const geometry = new THREE.SphereGeometry(1, 32, 32);\n            const material = new THREE.MeshPhongMaterial({\n                color: data.color,\n                opacity: 0.4,\n                transparent: true,\n                emissive: data.color,\n                emissiveIntensity: 0.3\n            });\n            this.ghostMesh = new THREE.Mesh(geometry, material);\n            const scale = data.radius * 0.5;\n            this.ghostMesh.scale.set(scale, scale, scale);\n            this.scene.add(this.ghostMesh);\n        }\n    }\n\n    private handleMouseMove(event: MouseEvent) {\n        const rect = this.renderer.domElement.getBoundingClientRect();\n        this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n        this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n        this.raycaster.setFromCamera(this.mouse, this.camera);\n\n        // Check for atom hover\n        const atomMeshArray = Array.from(this.atomMeshes.values());\n        const intersects = this.raycaster.intersectObjects(atomMeshArray);\n\n        if (intersects.length > 0) {\n            const object = intersects[0].object;\n            for (const [id, mesh] of this.atomMeshes.entries()) {\n                if (mesh === object) {\n                    if (this.hoveredAtomId !== id) {\n                        this.hoveredAtomId = id;\n                        const atom = this.atoms.find(a => a.id === id);\n                        if (this.onAtomHover) this.onAtomHover(atom || null);\n                    }\n                    break;\n                }\n            }\n        } else {\n            if (this.hoveredAtomId !== null) {\n                this.hoveredAtomId = null;\n                if (this.onAtomHover) this.onAtomHover(null);\n            }\n        }\n\n        // Ghost positioning\n        if (this.ghostMesh) {\n            const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n            const target = new THREE.Vector3();\n            const intersection = this.raycaster.ray.intersectPlane(plane, target);\n\n            if (intersection) {\n                this.ghostMesh.position.copy(intersection);\n                this.ghostMesh.visible = true;\n            } else {\n                this.ghostMesh.visible = false;\n            }\n        }\n    }\n\n    private handleClick(event: MouseEvent) {\n        const rect = this.renderer.domElement.getBoundingClientRect();\n        this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n        this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n        this.raycaster.setFromCamera(this.mouse, this.camera);\n\n        // Raycast against atoms\n        const atomMeshArray = Array.from(this.atomMeshes.values());\n        const intersects = this.raycaster.intersectObjects(atomMeshArray);\n\n        if (intersects.length > 0) {\n            // Clicked an atom\n            const object = intersects[0].object;\n            for (const [id, mesh] of this.atomMeshes.entries()) {\n                if (mesh === object && this.onAtomClick) {\n                    this.onAtomClick(id);\n                    return;\n                }\n            }\n        } else {\n            // Clicked empty space\n            const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n            const target = new THREE.Vector3();\n            const intersection = this.raycaster.ray.intersectPlane(plane, target);\n\n            if (intersection && this.onEmptyClick) {\n                this.onEmptyClick(intersection);\n            }\n        }\n    }\n\n    public updateMolecule(atoms: Atom[], bonds: Bond[]) {\n        this.atoms = atoms;\n        this.bonds = bonds;\n        this.renderMolecule();\n    }\n\n    private renderMolecule() {\n        // Clear existing meshes\n        this.atomMeshes.forEach(mesh => this.scene.remove(mesh));\n        this.atomMeshes.clear();\n\n        this.bondMeshes.forEach(meshes => meshes.forEach(m => this.scene.remove(m)));\n        this.bondMeshes.clear();\n\n        const sphereGeometry = new THREE.SphereGeometry(1, 32, 32);\n        const cylinderGeometry = new THREE.CylinderGeometry(0.15, 0.15, 1, 16);\n\n        // Render Atoms\n        this.atoms.forEach(atom => {\n            const data = PeriodicTable[atom.element];\n            if (!data) return;\n\n            const material = new THREE.MeshPhongMaterial({\n                color: data.color,\n                shininess: 80,\n                specular: 0x444444\n            });\n            const mesh = new THREE.Mesh(sphereGeometry, material);\n\n            // Scale by radius\n            const scale = data.radius * 0.5;\n            mesh.scale.set(scale, scale, scale);\n\n            mesh.position.set(atom.x, atom.y, atom.z);\n\n            this.scene.add(mesh);\n            this.atomMeshes.set(atom.id, mesh);\n        });\n\n        // Render Bonds\n        this.bonds.forEach(bond => {\n            const startAtom = this.atoms.find(a => a.id === bond.sourceId);\n            const endAtom = this.atoms.find(a => a.id === bond.targetId);\n            if (!startAtom || !endAtom) return;\n\n            const startPos = new THREE.Vector3(startAtom.x, startAtom.y, startAtom.z);\n            const endPos = new THREE.Vector3(endAtom.x, endAtom.y, endAtom.z);\n\n            const distance = startPos.distanceTo(endPos);\n            const mid = new THREE.Vector3().addVectors(startPos, endPos).multiplyScalar(0.5);\n\n            // Orientation\n            const direction = new THREE.Vector3().subVectors(endPos, startPos).normalize();\n            const quaternion = new THREE.Quaternion();\n            quaternion.setFromUnitVectors(new THREE.Vector3(0, 1, 0), direction);\n\n            const bondColor = 0x666680;\n\n            if (bond.order === 1) {\n                const material = new THREE.MeshPhongMaterial({ color: bondColor });\n                const mesh = new THREE.Mesh(cylinderGeometry, material);\n                mesh.position.copy(mid);\n                mesh.quaternion.copy(quaternion);\n                mesh.scale.set(1, distance, 1);\n                this.scene.add(mesh);\n                this.bondMeshes.set(bond.id, [mesh]);\n            } else if (bond.order >= 2) {\n                // Double/Triple bond\n                const offset = 0.2;\n                let axis = new THREE.Vector3(0, 0, 1);\n                if (Math.abs(direction.z) > 0.9) axis.set(1, 0, 0);\n                const offsetVec = new THREE.Vector3().crossVectors(direction, axis).normalize().multiplyScalar(offset);\n\n                const m1 = new THREE.Mesh(cylinderGeometry, new THREE.MeshPhongMaterial({ color: bondColor }));\n                m1.position.copy(mid).add(offsetVec);\n                m1.quaternion.copy(quaternion);\n                m1.scale.set(0.8, distance, 0.8);\n\n                const m2 = new THREE.Mesh(cylinderGeometry, new THREE.MeshPhongMaterial({ color: bondColor }));\n                m2.position.copy(mid).sub(offsetVec);\n                m2.quaternion.copy(quaternion);\n                m2.scale.set(0.8, distance, 0.8);\n\n                this.scene.add(m1);\n                this.scene.add(m2);\n                this.bondMeshes.set(bond.id, [m1, m2]);\n            }\n        });\n    }\n\n    public resize(width: number, height: number) {\n        this.camera.aspect = width / height;\n        this.camera.updateProjectionMatrix();\n        this.renderer.setSize(width, height);\n    }\n\n    public dispose() {\n        this.renderer.dispose();\n        if (this.container.contains(this.renderer.domElement)) {\n            this.container.removeChild(this.renderer.domElement);\n        }\n    }\n\n    private animate() {\n        requestAnimationFrame(this.animate.bind(this));\n        this.controls.update();\n        this.renderer.render(this.scene, this.camera);\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 491, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/components/builder/View3D.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef, useState, forwardRef, useImperativeHandle } from 'react';\nimport { MoleculeScene } from '@/lib/Molecule3D';\nimport * as THREE from 'three';\nimport { Atom, Bond, PeriodicTable } from '@/lib/chemistry';\n\ninterface View3DProps {\n    atoms: Atom[];\n    bonds: Bond[];\n    selectedElement?: string | null;\n    onAtomClick?: (id: number) => void;\n    onEmptyClick?: (position: THREE.Vector3) => void;\n}\n\nexport interface View3DHandle {\n    resize: () => void;\n}\n\nconst View3D = forwardRef<View3DHandle, View3DProps>(({ atoms, bonds, selectedElement, onAtomClick, onEmptyClick }, ref) => {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const sceneRef = useRef<MoleculeScene | null>(null);\n    const [hoveredAtom, setHoveredAtom] = useState<Atom | null>(null);\n    const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 });\n\n    // Store callbacks in refs to avoid re-creating scene\n    const onAtomClickRef = useRef(onAtomClick);\n    const onEmptyClickRef = useRef(onEmptyClick);\n\n    useEffect(() => {\n        onAtomClickRef.current = onAtomClick;\n    }, [onAtomClick]);\n\n    useEffect(() => {\n        onEmptyClickRef.current = onEmptyClick;\n    }, [onEmptyClick]);\n\n    useImperativeHandle(ref, () => ({\n        resize: () => {\n            if (sceneRef.current && containerRef.current) {\n                const { clientWidth, clientHeight } = containerRef.current;\n                sceneRef.current.resize(clientWidth, clientHeight);\n            }\n        }\n    }));\n\n    useEffect(() => {\n        if (!containerRef.current) return;\n\n        const { clientWidth, clientHeight } = containerRef.current;\n        const scene = new MoleculeScene(\n            containerRef.current,\n            clientWidth,\n            clientHeight,\n            (id) => onAtomClickRef.current?.(id),\n            (pos) => onEmptyClickRef.current?.(pos),\n            (atom) => setHoveredAtom(atom)\n        );\n        sceneRef.current = scene;\n\n        // Resize observer\n        const resizeObserver = new ResizeObserver(() => {\n            if (containerRef.current && sceneRef.current) {\n                const { clientWidth, clientHeight } = containerRef.current;\n                sceneRef.current.resize(clientWidth, clientHeight);\n            }\n        });\n        resizeObserver.observe(containerRef.current);\n\n        return () => {\n            scene.dispose();\n            resizeObserver.disconnect();\n        };\n    }, []); // Only run once\n\n    // Update molecule when props change\n    useEffect(() => {\n        if (sceneRef.current) {\n            sceneRef.current.updateMolecule(atoms, bonds);\n            sceneRef.current.updateGhost(selectedElement || null);\n        }\n    }, [atoms, bonds, selectedElement]);\n\n    // Track mouse for tooltip positioning\n    const handleMouseMove = (e: React.MouseEvent) => {\n        if (containerRef.current) {\n            const rect = containerRef.current.getBoundingClientRect();\n            setTooltipPos({\n                x: e.clientX - rect.left + 15,\n                y: e.clientY - rect.top - 10\n            });\n        }\n    };\n\n    return (\n        <div\n            ref={containerRef}\n            onMouseMove={handleMouseMove}\n            style={{ width: '100%', height: '100%', position: 'relative', cursor: hoveredAtom ? 'pointer' : 'crosshair' }}\n        >\n            {/* Atom Tooltip */}\n            {hoveredAtom && (\n                <div style={{\n                    position: 'absolute',\n                    left: tooltipPos.x,\n                    top: tooltipPos.y,\n                    background: 'rgba(0, 0, 0, 0.9)',\n                    color: '#fff',\n                    padding: '8px 12px',\n                    borderRadius: '8px',\n                    fontSize: '0.85rem',\n                    fontWeight: 600,\n                    pointerEvents: 'none',\n                    zIndex: 100,\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '8px',\n                    border: '1px solid rgba(255,255,255,0.15)',\n                    boxShadow: '0 4px 12px rgba(0,0,0,0.4)'\n                }}>\n                    <div style={{\n                        width: '14px',\n                        height: '14px',\n                        borderRadius: '50%',\n                        background: `#${PeriodicTable[hoveredAtom.element]?.color.toString(16).padStart(6, '0') || 'ffffff'}`\n                    }} />\n                    <span>{PeriodicTable[hoveredAtom.element]?.name || hoveredAtom.element}</span>\n                    <span style={{ color: '#6b7280', fontWeight: 400, fontSize: '0.75rem' }}>({hoveredAtom.element})</span>\n                </div>\n            )}\n        </div>\n    );\n});\n\nView3D.displayName = 'View3D';\nexport default View3D;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 654, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/syllabusData.ts"],"sourcesContent":["\nexport interface AtomTemplate {\n    id: number;\n    element: string;\n    position: [number, number, number];\n}\n\nexport interface BondTemplate {\n    source: number;\n    target: number;\n    order: number; // 1 = single, 2 = double, 3 = triple\n}\n\nexport interface MoleculeTemplate {\n    name: string;\n    description: string;\n    atoms: AtomTemplate[];\n    bonds: BondTemplate[];\n}\n\nexport interface SyllabusLevel {\n    level: number;\n    semester: string;\n    title: string;\n    description: string;\n    moleculeTemplate: MoleculeTemplate;\n    quizTopic: string;\n    learningObjective: string;\n}\n\n// ==================== MOLECULE TEMPLATES ====================\n// All molecules now include hydrogen atoms and proper bond orders\n\nconst PARACETAMOL_TEMPLATE: MoleculeTemplate = {\n    name: 'Paracetamol',\n    description: 'C8H9NO2 - Benzene ring + Hydroxyl + Acetamide group.',\n    atoms: [\n        // Benzene ring\n        { id: 1, element: 'C', position: [0, 0, 0] },\n        { id: 2, element: 'C', position: [1.4, 0, 0] },\n        { id: 3, element: 'C', position: [2.1, 1.2, 0] },\n        { id: 4, element: 'C', position: [1.4, 2.4, 0] },\n        { id: 5, element: 'C', position: [0, 2.4, 0] },\n        { id: 6, element: 'C', position: [-0.7, 1.2, 0] },\n        // Functional groups\n        { id: 7, element: 'O', position: [2.1, -1.2, 0] },  // Hydroxyl O\n        { id: 8, element: 'H', position: [3.0, -1.4, 0] },  // Hydroxyl H\n        { id: 9, element: 'N', position: [-2.1, 1.2, 0] },  // Amide N\n        { id: 10, element: 'H', position: [-2.5, 2.1, 0] }, // Amide H\n        { id: 11, element: 'C', position: [-3.0, 0, 0] },   // Acetyl C\n        { id: 12, element: 'O', position: [-3.5, -1.0, 0] }, // Carbonyl O\n        { id: 13, element: 'C', position: [-4.2, 0.8, 0] },  // Methyl C\n        // Ring hydrogens\n        { id: 14, element: 'H', position: [3.1, 1.2, 0] },\n        { id: 15, element: 'H', position: [2.0, 3.3, 0] },\n        { id: 16, element: 'H', position: [-0.6, 3.3, 0] },\n        // Methyl hydrogens\n        { id: 17, element: 'H', position: [-4.8, 0.0, 0] },\n        { id: 18, element: 'H', position: [-4.8, 1.3, 0] },\n        { id: 19, element: 'H', position: [-3.8, 1.6, 0] },\n    ],\n    bonds: [\n        // Benzene ring (alternating double bonds for resonance)\n        { source: 1, target: 2, order: 2 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 2 },\n        { source: 4, target: 5, order: 1 },\n        { source: 5, target: 6, order: 2 },\n        { source: 6, target: 1, order: 1 },\n        // Hydroxyl group\n        { source: 2, target: 7, order: 1 },\n        { source: 7, target: 8, order: 1 },\n        // Acetamide group\n        { source: 6, target: 9, order: 1 },\n        { source: 9, target: 10, order: 1 },\n        { source: 9, target: 11, order: 1 },\n        { source: 11, target: 12, order: 2 },\n        { source: 11, target: 13, order: 1 },\n        // Ring hydrogens\n        { source: 3, target: 14, order: 1 },\n        { source: 4, target: 15, order: 1 },\n        { source: 5, target: 16, order: 1 },\n        // Methyl hydrogens\n        { source: 13, target: 17, order: 1 },\n        { source: 13, target: 18, order: 1 },\n        { source: 13, target: 19, order: 1 },\n    ]\n};\n\nconst ASPIRIN_TEMPLATE: MoleculeTemplate = {\n    name: 'Aspirin',\n    description: 'C9H8O4 - Acetylsalicylic Acid.',\n    atoms: [\n        // Benzene ring\n        { id: 1, element: 'C', position: [0, 0, 0] },\n        { id: 2, element: 'C', position: [1.4, 0, 0] },\n        { id: 3, element: 'C', position: [2.1, 1.2, 0] },\n        { id: 4, element: 'C', position: [1.4, 2.4, 0] },\n        { id: 5, element: 'C', position: [0, 2.4, 0] },\n        { id: 6, element: 'C', position: [-0.7, 1.2, 0] },\n        // Carboxylic acid\n        { id: 7, element: 'C', position: [2.8, -1.2, 0] },\n        { id: 8, element: 'O', position: [4.0, -0.8, 0] },  // =O\n        { id: 9, element: 'O', position: [2.4, -2.4, 0] },  // -OH\n        { id: 10, element: 'H', position: [3.2, -2.8, 0] }, // COOH H\n        // Ester group\n        { id: 11, element: 'O', position: [-2.0, 1.2, 0] },\n        { id: 12, element: 'C', position: [-3.0, 0.4, 0] },  // Acetyl C\n        { id: 13, element: 'O', position: [-3.5, -0.6, 0] }, // =O\n        { id: 14, element: 'C', position: [-4.0, 1.4, 0] },  // CH3\n        // Ring hydrogens\n        { id: 15, element: 'H', position: [0, -0.9, 0] },\n        { id: 16, element: 'H', position: [3.1, 1.2, 0] },\n        { id: 17, element: 'H', position: [2.0, 3.3, 0] },\n        { id: 18, element: 'H', position: [-0.6, 3.3, 0] },\n        // Methyl hydrogens\n        { id: 19, element: 'H', position: [-4.6, 0.8, 0] },\n        { id: 20, element: 'H', position: [-4.6, 2.0, 0] },\n        { id: 21, element: 'H', position: [-3.4, 2.2, 0] },\n    ],\n    bonds: [\n        // Benzene ring\n        { source: 1, target: 2, order: 2 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 2 },\n        { source: 4, target: 5, order: 1 },\n        { source: 5, target: 6, order: 2 },\n        { source: 6, target: 1, order: 1 },\n        // Carboxylic acid\n        { source: 2, target: 7, order: 1 },\n        { source: 7, target: 8, order: 2 },\n        { source: 7, target: 9, order: 1 },\n        { source: 9, target: 10, order: 1 },\n        // Ester group\n        { source: 6, target: 11, order: 1 },\n        { source: 11, target: 12, order: 1 },\n        { source: 12, target: 13, order: 2 },\n        { source: 12, target: 14, order: 1 },\n        // Ring hydrogens\n        { source: 1, target: 15, order: 1 },\n        { source: 3, target: 16, order: 1 },\n        { source: 4, target: 17, order: 1 },\n        { source: 5, target: 18, order: 1 },\n        // Methyl hydrogens\n        { source: 14, target: 19, order: 1 },\n        { source: 14, target: 20, order: 1 },\n        { source: 14, target: 21, order: 1 },\n    ]\n};\n\nconst BENZENE_TEMPLATE: MoleculeTemplate = {\n    name: 'Benzene',\n    description: 'C6H6 - The fundamental aromatic ring with delocalized electrons.',\n    atoms: [\n        { id: 1, element: 'C', position: [0, 1.4, 0] },\n        { id: 2, element: 'C', position: [1.2, 0.7, 0] },\n        { id: 3, element: 'C', position: [1.2, -0.7, 0] },\n        { id: 4, element: 'C', position: [0, -1.4, 0] },\n        { id: 5, element: 'C', position: [-1.2, -0.7, 0] },\n        { id: 6, element: 'C', position: [-1.2, 0.7, 0] },\n        // All hydrogens\n        { id: 7, element: 'H', position: [0, 2.4, 0] },\n        { id: 8, element: 'H', position: [2.1, 1.2, 0] },\n        { id: 9, element: 'H', position: [2.1, -1.2, 0] },\n        { id: 10, element: 'H', position: [0, -2.4, 0] },\n        { id: 11, element: 'H', position: [-2.1, -1.2, 0] },\n        { id: 12, element: 'H', position: [-2.1, 1.2, 0] },\n    ],\n    bonds: [\n        // Alternating double bonds (resonance structure)\n        { source: 1, target: 2, order: 2 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 2 },\n        { source: 4, target: 5, order: 1 },\n        { source: 5, target: 6, order: 2 },\n        { source: 6, target: 1, order: 1 },\n        // C-H bonds\n        { source: 1, target: 7, order: 1 },\n        { source: 2, target: 8, order: 1 },\n        { source: 3, target: 9, order: 1 },\n        { source: 4, target: 10, order: 1 },\n        { source: 5, target: 11, order: 1 },\n        { source: 6, target: 12, order: 1 },\n    ]\n};\n\nconst IBUPROFEN_TEMPLATE: MoleculeTemplate = {\n    name: 'Ibuprofen',\n    description: 'C13H18O2 - Propionic acid derivative NSAID.',\n    atoms: [\n        // Benzene ring\n        { id: 1, element: 'C', position: [0, 0, 0] },\n        { id: 2, element: 'C', position: [1.4, 0, 0] },\n        { id: 3, element: 'C', position: [2.1, 1.2, 0] },\n        { id: 4, element: 'C', position: [1.4, 2.4, 0] },\n        { id: 5, element: 'C', position: [0, 2.4, 0] },\n        { id: 6, element: 'C', position: [-0.7, 1.2, 0] },\n        // Propionic acid chain\n        { id: 7, element: 'C', position: [3.5, 1.2, 0] },  // CH\n        { id: 8, element: 'C', position: [4.2, 0.2, 0] },  // CH3\n        { id: 9, element: 'C', position: [4.2, 2.4, 0] },  // COOH\n        { id: 10, element: 'O', position: [5.4, 2.2, 0] }, // =O\n        { id: 11, element: 'O', position: [3.8, 3.6, 0] }, // -OH\n        { id: 12, element: 'H', position: [4.5, 4.0, 0] }, // -OH H\n        // Isobutyl group\n        { id: 13, element: 'C', position: [-2.1, 1.2, 0] }, // CH2\n        { id: 14, element: 'C', position: [-3.0, 0.0, 0] }, // CH\n        { id: 15, element: 'C', position: [-4.4, 0.2, 0] }, // CH3\n        { id: 16, element: 'C', position: [-2.6, -1.4, 0] }, // CH3\n        // Key hydrogens\n        { id: 17, element: 'H', position: [0, -0.9, 0] },\n        { id: 18, element: 'H', position: [2.0, -0.9, 0] },\n        { id: 19, element: 'H', position: [2.0, 3.3, 0] },\n        { id: 20, element: 'H', position: [-0.6, 3.3, 0] },\n    ],\n    bonds: [\n        // Benzene ring\n        { source: 1, target: 2, order: 2 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 2 },\n        { source: 4, target: 5, order: 1 },\n        { source: 5, target: 6, order: 2 },\n        { source: 6, target: 1, order: 1 },\n        // Propionic acid\n        { source: 3, target: 7, order: 1 },\n        { source: 7, target: 8, order: 1 },\n        { source: 7, target: 9, order: 1 },\n        { source: 9, target: 10, order: 2 },\n        { source: 9, target: 11, order: 1 },\n        { source: 11, target: 12, order: 1 },\n        // Isobutyl\n        { source: 6, target: 13, order: 1 },\n        { source: 13, target: 14, order: 1 },\n        { source: 14, target: 15, order: 1 },\n        { source: 14, target: 16, order: 1 },\n        // Ring H\n        { source: 1, target: 17, order: 1 },\n        { source: 2, target: 18, order: 1 },\n        { source: 4, target: 19, order: 1 },\n        { source: 5, target: 20, order: 1 },\n    ]\n};\n\nconst PENICILLIN_TEMPLATE: MoleculeTemplate = {\n    name: 'Penicillin G Core',\n    description: 'Beta-lactam + Thiazolidine ring system.',\n    atoms: [\n        // Beta-lactam ring (4-membered)\n        { id: 1, element: 'C', position: [0, 0, 0] },\n        { id: 2, element: 'N', position: [1.2, 0.5, 0] },\n        { id: 3, element: 'C', position: [1.2, 1.8, 0] },\n        { id: 4, element: 'C', position: [0, 1.3, 0] },\n        { id: 5, element: 'O', position: [2.2, 2.5, 0] }, // Carbonyl =O\n        // Thiazolidine ring (5-membered)\n        { id: 6, element: 'S', position: [-1.2, 0.5, 0] },\n        { id: 7, element: 'C', position: [-1.2, 2.0, 0] },\n        { id: 8, element: 'C', position: [-2.4, 2.8, 0] }, // COOH\n        { id: 9, element: 'O', position: [-3.4, 2.2, 0] }, // =O\n        { id: 10, element: 'O', position: [-2.4, 4.0, 0] }, // -OH\n        { id: 11, element: 'H', position: [-3.2, 4.4, 0] },\n        // Methyl groups on thiazolidine\n        { id: 12, element: 'C', position: [-2.0, 3.0, 1.0] },\n        { id: 13, element: 'C', position: [-2.0, 3.0, -1.0] },\n        // Amide side chain\n        { id: 14, element: 'C', position: [2.4, -0.2, 0] }, // C=O\n        { id: 15, element: 'O', position: [2.8, -1.3, 0] },\n        { id: 16, element: 'H', position: [2.8, 0.6, 0] },\n    ],\n    bonds: [\n        // Beta-lactam ring\n        { source: 1, target: 2, order: 1 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 1 },\n        { source: 4, target: 1, order: 1 },\n        { source: 3, target: 5, order: 2 },\n        // Thiazolidine\n        { source: 4, target: 6, order: 1 },\n        { source: 6, target: 7, order: 1 },\n        { source: 7, target: 4, order: 1 },\n        { source: 7, target: 8, order: 1 },\n        { source: 8, target: 9, order: 2 },\n        { source: 8, target: 10, order: 1 },\n        { source: 10, target: 11, order: 1 },\n        // Methyl\n        { source: 7, target: 12, order: 1 },\n        { source: 7, target: 13, order: 1 },\n        // Side chain\n        { source: 2, target: 14, order: 1 },\n        { source: 14, target: 15, order: 2 },\n        { source: 14, target: 16, order: 1 },\n    ]\n};\n\nconst MORPHINE_TEMPLATE: MoleculeTemplate = {\n    name: 'Morphine Core',\n    description: 'C17H19NO3 - Phenanthrene backbone with key functional groups.',\n    atoms: [\n        // Ring A (aromatic)\n        { id: 1, element: 'C', position: [0, 0, 0] },\n        { id: 2, element: 'C', position: [1.4, 0, 0] },\n        { id: 3, element: 'C', position: [2.1, 1.2, 0] },\n        { id: 4, element: 'C', position: [1.4, 2.4, 0] },\n        { id: 5, element: 'C', position: [0, 2.4, 0] },\n        { id: 6, element: 'C', position: [-0.7, 1.2, 0] },\n        // Phenolic OH\n        { id: 7, element: 'O', position: [-2.0, 1.2, 0] },\n        { id: 8, element: 'H', position: [-2.5, 0.5, 0] },\n        // Ether oxygen bridge\n        { id: 9, element: 'O', position: [3.4, 1.2, 0] },\n        // Ring B carbon\n        { id: 10, element: 'C', position: [3.8, 2.4, 0] },\n        // Tertiary amine nitrogen\n        { id: 11, element: 'N', position: [0, 3.8, 1.0] },\n        { id: 12, element: 'C', position: [-1.2, 4.4, 1.2] }, // N-CH3\n        // Allylic OH\n        { id: 13, element: 'C', position: [2.8, 3.4, 0.5] },\n        { id: 14, element: 'O', position: [3.2, 4.6, 0.8] },\n        { id: 15, element: 'H', position: [4.0, 4.8, 0.5] },\n    ],\n    bonds: [\n        // Aromatic ring\n        { source: 1, target: 2, order: 2 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 2 },\n        { source: 4, target: 5, order: 1 },\n        { source: 5, target: 6, order: 2 },\n        { source: 6, target: 1, order: 1 },\n        // Phenol\n        { source: 6, target: 7, order: 1 },\n        { source: 7, target: 8, order: 1 },\n        // Ether bridge\n        { source: 3, target: 9, order: 1 },\n        { source: 9, target: 10, order: 1 },\n        // Tertiary amine\n        { source: 5, target: 11, order: 1 },\n        { source: 11, target: 12, order: 1 },\n        // Alcohol\n        { source: 4, target: 13, order: 1 },\n        { source: 13, target: 14, order: 1 },\n        { source: 14, target: 15, order: 1 },\n    ]\n};\n\nconst LIPOSOME_TEMPLATE: MoleculeTemplate = {\n    name: 'Phospholipid',\n    description: 'Phosphatidylcholine - key component of liposomal delivery.',\n    atoms: [\n        // Phosphate head\n        { id: 1, element: 'P', position: [0, 3, 0] },\n        { id: 2, element: 'O', position: [0.8, 3.8, 0] },  // P=O\n        { id: 3, element: 'O', position: [-0.8, 3.8, 0] }, // P-O-\n        { id: 4, element: 'O', position: [0, 2, 0] },      // Ester O\n        // Glycerol backbone\n        { id: 5, element: 'C', position: [0, 1, 0] },\n        { id: 6, element: 'C', position: [1.2, 0.5, 0] },\n        { id: 7, element: 'C', position: [-1.2, 0.5, 0] },\n        // Fatty acid tails\n        { id: 8, element: 'O', position: [2.0, 1.2, 0] },  // Ester O\n        { id: 9, element: 'C', position: [3.0, 0.8, 0] },  // C=O\n        { id: 10, element: 'O', position: [3.5, 1.6, 0] }, // =O\n        { id: 11, element: 'C', position: [3.5, -0.4, 0] }, // Chain start\n        { id: 12, element: 'C', position: [4.0, -1.6, 0] },\n        { id: 13, element: 'C', position: [4.5, -2.8, 0] },\n        // Second tail\n        { id: 14, element: 'O', position: [-2.0, 1.2, 0] },\n        { id: 15, element: 'C', position: [-3.0, 0.8, 0] },\n        { id: 16, element: 'O', position: [-3.5, 1.6, 0] },\n        { id: 17, element: 'C', position: [-3.5, -0.4, 0] },\n        { id: 18, element: 'C', position: [-4.0, -1.6, 0] },\n        { id: 19, element: 'C', position: [-4.5, -2.8, 0] },\n        // Choline head\n        { id: 20, element: 'N', position: [0, 5, 0] },\n    ],\n    bonds: [\n        // Phosphate\n        { source: 1, target: 2, order: 2 },\n        { source: 1, target: 3, order: 1 },\n        { source: 1, target: 4, order: 1 },\n        { source: 4, target: 5, order: 1 },\n        // Glycerol\n        { source: 5, target: 6, order: 1 },\n        { source: 5, target: 7, order: 1 },\n        // Tail 1\n        { source: 6, target: 8, order: 1 },\n        { source: 8, target: 9, order: 1 },\n        { source: 9, target: 10, order: 2 },\n        { source: 9, target: 11, order: 1 },\n        { source: 11, target: 12, order: 1 },\n        { source: 12, target: 13, order: 1 },\n        // Tail 2\n        { source: 7, target: 14, order: 1 },\n        { source: 14, target: 15, order: 1 },\n        { source: 15, target: 16, order: 2 },\n        { source: 15, target: 17, order: 1 },\n        { source: 17, target: 18, order: 1 },\n        { source: 18, target: 19, order: 1 },\n        // Choline\n        { source: 3, target: 20, order: 1 },\n    ]\n};\n\nconst CANDIDATE_X_TEMPLATE: MoleculeTemplate = {\n    name: 'Candidate-X',\n    description: 'Novel Fluorinated Oncology Drug for Clinical Trial.',\n    atoms: [\n        // Core structure\n        { id: 1, element: 'C', position: [0, 0, 0] },\n        { id: 2, element: 'C', position: [1.4, 0, 0] },\n        { id: 3, element: 'N', position: [2.1, 1.0, 0] },\n        { id: 4, element: 'C', position: [3.4, 1.2, 0] },\n        { id: 5, element: 'O', position: [4.0, 2.2, 0] },\n        // Fluorine substituents (for enhanced activity)\n        { id: 6, element: 'F', position: [-1.0, 0.8, 0] },\n        { id: 7, element: 'F', position: [-1.0, -0.8, 0] },\n        // Additional ring\n        { id: 8, element: 'C', position: [4.0, 0, 0] },\n        { id: 9, element: 'C', position: [5.2, 0.5, 0] },\n        { id: 10, element: 'N', position: [5.8, -0.5, 0] },\n        // Hydrogens\n        { id: 11, element: 'H', position: [0, -0.9, 0] },\n        { id: 12, element: 'H', position: [1.8, -0.9, 0] },\n        { id: 13, element: 'H', position: [1.8, 1.8, 0] },\n        { id: 14, element: 'H', position: [3.8, -0.9, 0] },\n        { id: 15, element: 'H', position: [6.8, -0.5, 0] },\n    ],\n    bonds: [\n        // Core\n        { source: 1, target: 2, order: 2 },\n        { source: 2, target: 3, order: 1 },\n        { source: 3, target: 4, order: 1 },\n        { source: 4, target: 5, order: 2 },\n        // Fluorines\n        { source: 1, target: 6, order: 1 },\n        { source: 1, target: 7, order: 1 },\n        // Ring extension\n        { source: 4, target: 8, order: 1 },\n        { source: 8, target: 9, order: 2 },\n        { source: 9, target: 10, order: 1 },\n        // Hydrogens\n        { source: 2, target: 11, order: 1 },\n        { source: 2, target: 12, order: 1 },\n        { source: 3, target: 13, order: 1 },\n        { source: 8, target: 14, order: 1 },\n        { source: 10, target: 15, order: 1 },\n    ]\n};\n\n// ==================== SYLLABUS LEVELS ====================\n\nexport const SYLLABUS_DATA: SyllabusLevel[] = [\n    {\n        level: 1,\n        semester: 'Sem 1',\n        title: 'Pharm. Analysis',\n        description: 'Synthesize Paracetamol and verify its structural purity.',\n        moleculeTemplate: PARACETAMOL_TEMPLATE,\n        quizTopic: 'chemistry',\n        learningObjective: 'Understand basic aromatic substitution and purity analysis.'\n    },\n    {\n        level: 2,\n        semester: 'Sem 2',\n        title: 'Organic Chemistry I',\n        description: 'Synthesize Aspirin and modify the ester group for stability.',\n        moleculeTemplate: ASPIRIN_TEMPLATE,\n        quizTopic: 'chemistry',\n        learningObjective: 'Master esterification reactions.'\n    },\n    {\n        level: 3,\n        semester: 'Sem 3',\n        title: 'Organic Chemistry II',\n        description: 'Analyze Benzene stability and aromatic resonance.',\n        moleculeTemplate: BENZENE_TEMPLATE,\n        quizTopic: 'chemistry',\n        learningObjective: 'Understand aromaticity and resonance energy.'\n    },\n    {\n        level: 4,\n        semester: 'Sem 4',\n        title: 'Med. Chem I',\n        description: 'Optimize Ibuprofen side-chains for better receptor binding.',\n        moleculeTemplate: IBUPROFEN_TEMPLATE,\n        quizTopic: 'pharmacology',\n        learningObjective: 'Chirality and Structure-Activity Relationship (SAR).'\n    },\n    {\n        level: 5,\n        semester: 'Sem 5',\n        title: 'Pharmacology',\n        description: 'Propose Penicillin modifications to fight bacterial resistance.',\n        moleculeTemplate: PENICILLIN_TEMPLATE,\n        quizTopic: 'pharmacology',\n        learningObjective: 'Antibiotic mechanisms and resistance.'\n    },\n    {\n        level: 6,\n        semester: 'Sem 6',\n        title: 'Herbal Tech',\n        description: 'Perform extraction analysis on Morphine alkaloids.',\n        moleculeTemplate: MORPHINE_TEMPLATE,\n        quizTopic: 'kinetics',\n        learningObjective: 'Extraction techniques and alkaloid chemistry.'\n    },\n    {\n        level: 7,\n        semester: 'Sem 7',\n        title: 'NDDS',\n        description: 'Design a Liposomal delivery system for targeted therapy.',\n        moleculeTemplate: LIPOSOME_TEMPLATE,\n        quizTopic: 'kinetics',\n        learningObjective: 'Novel Drug Delivery Systems.'\n    },\n    {\n        level: 8,\n        semester: 'Sem 8',\n        title: 'Clinical Research',\n        description: 'Guide Candidate-X through a complete Phase I-III Clinical Trial.',\n        moleculeTemplate: CANDIDATE_X_TEMPLATE,\n        quizTopic: 'regulatory',\n        learningObjective: 'Complete IND/NDA process.'\n    }\n];\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2796, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/aiService.ts"],"sourcesContent":["/**\n * AI Service - Client-side facade for AI API operations\n * \n * This service handles:\n * 1. API calls to the AI routes with proper typing\n * 2. Error handling with fallback responses\n * 3. Rate limit and quota handling with graceful degradation\n */\n\nimport { TrialPhaseData, CachedTrialEvent } from './trialService';\nimport {\n    MoleculeAnalysisResult,\n    QuizQuestionResult,\n    TrialRoadmapResult,\n    TrialEventResult\n} from '@/app/actions/ai';\n\n// ============================================================================\n// Type Re-exports for backward compatibility\n// ============================================================================\n\n/** Roadmap data returned from AI (without generatedAt which is added by TrialService) */\nexport interface AIRoadmapData {\n    summary: string;\n    phases: TrialPhaseData[];\n    successProbability: number;\n}\n\n// ============================================================================\n// API Response Types\n// ============================================================================\n\ninterface APISuccessResponse<T> {\n    success: true;\n    [key: string]: unknown;\n}\n\ninterface APIErrorResponse {\n    success: false;\n    error: string;\n    errorType: string;\n    message: string;\n}\n\ntype APIResponse<T> = (APISuccessResponse<T> & T) | APIErrorResponse;\n\n// ============================================================================\n// HTTP Client Utilities\n// ============================================================================\n\n/**\n * Type-safe POST request with error handling\n */\nasync function postJSON<T>(url: string, body: unknown): Promise<T> {\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(body)\n    });\n\n    const text = await res.text();\n    let parsed: APIResponse<T> | null = null;\n\n    try {\n        parsed = text ? JSON.parse(text) : null;\n    } catch {\n        parsed = null;\n    }\n\n    if (!res.ok) {\n        const message = (parsed as APIErrorResponse)?.message ||\n            (parsed as APIErrorResponse)?.error ||\n            text ||\n            res.statusText;\n        const err = new Error(message) as Error & { status: number; errorType?: string };\n        err.status = res.status;\n        err.errorType = (parsed as APIErrorResponse)?.errorType;\n        throw err;\n    }\n\n    return (parsed ?? {}) as T;\n}\n\n/**\n * Check if error is rate limit or quota related\n */\nfunction isRateLimitError(errorMessage: string, errorStatus?: number): boolean {\n    return (\n        errorStatus === 429 ||\n        errorMessage.includes('429') ||\n        errorMessage.includes('quota') ||\n        errorMessage.includes('RESOURCE_EXHAUSTED') ||\n        errorMessage.includes('rate limit') ||\n        errorMessage.includes('Rate Limit') ||\n        errorStatus === 404 ||\n        errorMessage.includes('404') ||\n        errorMessage.includes('not found')\n    );\n}\n\n/**\n * Extract error info from unknown error\n */\nfunction parseError(error: unknown): { message: string; status?: number } {\n    const err = error as { message?: string; status?: number; response?: { status?: number } };\n    return {\n        message: err?.message || String(error) || 'Unknown error',\n        status: err?.status || err?.response?.status\n    };\n}\n\n// ============================================================================\n// AI Service - Public API\n// ============================================================================\n\nexport const AiService = {\n    /**\n     * Analyze a molecule modification\n     * Returns AI analysis with efficacy/safety scores, or fallback data on failure\n     */\n    async analyzeMolecule(\n        moleculeName: string,\n        atomCount: number,\n        userModifications: string\n    ): Promise<MoleculeAnalysisResult> {\n        try {\n            const response = await postJSON<MoleculeAnalysisResult & { success?: boolean }>(\n                '/api/ai/analyze-molecule',\n                { moleculeName, atomCount, userModifications }\n            );\n\n            // Extract just the result fields\n            return {\n                analysis: response.analysis,\n                efficacy: response.efficacy,\n                safety: response.safety,\n                feedback: response.feedback\n            };\n\n        } catch (error: unknown) {\n            const { message, status } = parseError(error);\n\n            // API key missing - clear message to user\n            if (status === 503) {\n                return {\n                    analysis: \"AI Service Unavailable (Missing Key)\",\n                    safety: 50,\n                    efficacy: 50,\n                    feedback: \"Please configure your API key in .env.local\"\n                };\n            }\n\n            // Rate limit - return simulated data\n            if (isRateLimitError(message, status)) {\n                console.warn(\"AI Service: Rate limit reached. Using simulated analysis.\");\n                return {\n                    analysis: `[Simulated] Your ${moleculeName} modification shows promise. The ${atomCount} atom structure maintains core stability.`,\n                    efficacy: 65 + Math.floor(Math.random() * 20),\n                    safety: 70 + Math.floor(Math.random() * 15),\n                    feedback: \"API quota exceeded - using simulated analysis.\"\n                };\n            }\n\n            // Connection error\n            console.warn(\"AI Service Error:\", message);\n            return {\n                analysis: \"Analysis failed due to connection error.\",\n                efficacy: 40,\n                safety: 40,\n                feedback: \"Could not connect to AI lab expert. Please check your connection.\"\n            };\n        }\n    },\n\n    /**\n     * Generate a quiz question\n     * Returns null on failure (allows fallback to local question bank)\n     */\n    async generateQuestion(topic: string, level: number): Promise<QuizQuestionResult | null> {\n        try {\n            const response = await postJSON<{ question: QuizQuestionResult | null; success?: boolean }>(\n                '/api/ai/generate-question',\n                { topic, level }\n            );\n            return response.question;\n\n        } catch (error: unknown) {\n            const { message, status } = parseError(error);\n\n            if (isRateLimitError(message, status)) {\n                console.warn(\"AI Service: Rate limit - using local question bank.\");\n            } else {\n                console.error(\"AI Question Gen Failed:\", message);\n            }\n\n            return null; // Fallback to local questions\n        }\n    },\n\n    /**\n     * Generate clinical trial roadmap\n     * Returns AI-generated phases or fallback data on failure\n     */\n    async generateTrialRoadmap(\n        moleculeName: string,\n        efficacy: number,\n        safety: number\n    ): Promise<AIRoadmapData> {\n        try {\n            const response = await postJSON<TrialRoadmapResult & { success?: boolean }>(\n                '/api/ai/trial-roadmap',\n                { moleculeName, efficacy, safety }\n            );\n\n            return {\n                summary: response.summary,\n                phases: response.phases,\n                successProbability: response.successProbability\n            };\n\n        } catch (error: unknown) {\n            const { message, status } = parseError(error);\n\n            if (isRateLimitError(message, status)) {\n                console.warn(\"AI Service: Rate limit - using fallback roadmap.\");\n            } else {\n                console.warn(\"AI Roadmap Generation Failed:\", message);\n            }\n\n            return this.getFallbackRoadmap(moleculeName, efficacy, safety);\n        }\n    },\n\n    /**\n     * Fallback roadmap when AI is unavailable\n     */\n    getFallbackRoadmap(moleculeName: string, efficacy: number, safety: number): AIRoadmapData {\n        const successProb = Math.round((efficacy * 0.6 + safety * 0.4) * 0.8);\n        return {\n            summary: `${moleculeName} is a promising drug candidate currently under development. Based on preliminary analysis, it shows potential for therapeutic application.`,\n            phases: [\n                {\n                    name: \"Preclinical\",\n                    duration: \"6-12 months\",\n                    description: \"Laboratory and animal testing to evaluate basic safety and biological activity. This phase determines if the compound is safe enough for human trials.\",\n                    keyActivities: [\"In vitro cell studies\", \"Animal toxicology tests\", \"Pharmacokinetic analysis\"],\n                    risks: safety < 60 ? \"Safety concerns may require additional testing\" : \"Standard preclinical risks apply\"\n                },\n                {\n                    name: \"Phase I Clinical Trial\",\n                    duration: \"1-2 years\",\n                    description: \"First-in-human studies with 20-100 healthy volunteers. Focus is on safety, dosage, and side effects.\",\n                    keyActivities: [\"Healthy volunteer recruitment\", \"Dose escalation studies\", \"Safety monitoring\"],\n                    risks: \"Unexpected adverse reactions in humans\"\n                },\n                {\n                    name: \"Phase II Clinical Trial\",\n                    duration: \"2-3 years\",\n                    description: \"Testing in 100-500 patients with the target condition. Evaluates efficacy and optimal dosing.\",\n                    keyActivities: [\"Patient recruitment\", \"Efficacy measurements\", \"Side effect profiling\"],\n                    risks: efficacy < 70 ? \"Efficacy may not meet primary endpoints\" : \"Competition from similar drugs in development\"\n                },\n                {\n                    name: \"Phase III & FDA Review\",\n                    duration: \"3-5 years\",\n                    description: \"Large-scale trials with 1000-5000+ patients. Confirms effectiveness and monitors long-term safety before FDA submission.\",\n                    keyActivities: [\"Multi-center trials\", \"NDA preparation\", \"FDA review process\"],\n                    risks: \"Regulatory delays or additional data requirements\"\n                }\n            ],\n            successProbability: successProb\n        };\n    },\n\n    /**\n     * Generate a placeholder image URL for a molecule\n     */\n    generateMoleculeImageUrl(moleculeName: string, color: string = '#3b82f6'): string {\n        const encodedName = encodeURIComponent(moleculeName.slice(0, 20));\n        const bgColor = color.replace('#', '');\n        return `https://via.placeholder.com/400x300/${bgColor}/ffffff?text=${encodedName}`;\n    },\n\n    /**\n     * Generate a dynamic trial event for the simulation\n     * Returns AI event or fallback data on failure\n     */\n    async generateTrialEvent(\n        moleculeName: string,\n        phaseName: string,\n        phaseDescription: string,\n        currentStats: { budget: number; efficacy: number; safety: number },\n        previousEvents: string[]\n    ): Promise<CachedTrialEvent> {\n        try {\n            const response = await postJSON<TrialEventResult & { success?: boolean }>(\n                '/api/ai/trial-event',\n                { moleculeName, phaseName, phaseDescription, currentStats, previousEvents }\n            );\n\n            return {\n                title: response.title,\n                description: response.description,\n                choices: response.choices,\n                isPhaseComplete: response.isPhaseComplete\n            };\n\n        } catch (error: unknown) {\n            const { message, status } = parseError(error);\n\n            if (isRateLimitError(message, status)) {\n                console.warn(\"AI Service: Rate limit - using fallback event.\");\n            } else {\n                console.warn(\"AI Trial Event Failed:\", message);\n            }\n\n            return this.getFallbackTrialEvent(phaseName, currentStats);\n        }\n    },\n\n    /**\n     * Fallback trial event when AI is unavailable\n     */\n    getFallbackTrialEvent(\n        phaseName: string,\n        currentStats: { budget: number; efficacy: number; safety: number }\n    ): CachedTrialEvent {\n        const events: Record<string, CachedTrialEvent> = {\n            'Preclinical': {\n                title: 'Animal Study Results',\n                description: 'Initial animal studies are showing promising results, but there are some concerning liver enzyme readings in a subset of test subjects.',\n                choices: [\n                    {\n                        text: 'Conduct additional testing',\n                        budgetEffect: -1500000,\n                        efficacyEffect: 5,\n                        safetyEffect: 10,\n                        outcomeText: 'Extended testing revealed the issue was dose-related. Protocol adjusted successfully.'\n                    },\n                    {\n                        text: 'Proceed with current protocol',\n                        budgetEffect: 0,\n                        efficacyEffect: 0,\n                        safetyEffect: -10,\n                        outcomeText: 'Trial continues with documented risks. Safety team is monitoring closely.'\n                    }\n                ],\n                isPhaseComplete: currentStats.efficacy >= 40 && currentStats.safety >= 60\n            },\n            'Phase I Clinical Trial': {\n                title: 'Volunteer Recruitment Challenge',\n                description: 'Healthy volunteer enrollment is slower than expected. The trial timeline may be affected.',\n                choices: [\n                    {\n                        text: 'Increase incentives ($2M)',\n                        budgetEffect: -2000000,\n                        efficacyEffect: 0,\n                        safetyEffect: 5,\n                        outcomeText: 'Enrollment targets met ahead of schedule with high-quality participants.'\n                    },\n                    {\n                        text: 'Expand recruitment sites',\n                        budgetEffect: -800000,\n                        efficacyEffect: -5,\n                        safetyEffect: 0,\n                        outcomeText: 'More sites added but data consistency slightly reduced.'\n                    }\n                ],\n                isPhaseComplete: currentStats.efficacy >= 50 && currentStats.safety >= 65\n            },\n            'Phase II Clinical Trial': {\n                title: 'Efficacy Data Review',\n                description: 'Mid-trial analysis shows the drug is effective in most patients, but a specific demographic shows reduced response.',\n                choices: [\n                    {\n                        text: 'Focus on responsive group',\n                        budgetEffect: -500000,\n                        efficacyEffect: 15,\n                        safetyEffect: 5,\n                        outcomeText: 'Refined targeting significantly improved overall efficacy metrics.'\n                    },\n                    {\n                        text: 'Broaden study population',\n                        budgetEffect: -3000000,\n                        efficacyEffect: -5,\n                        safetyEffect: 0,\n                        outcomeText: 'Inclusive approach yielded average results but broader applicability data.'\n                    }\n                ],\n                isPhaseComplete: currentStats.efficacy >= 70 && currentStats.safety >= 75\n            },\n            'Phase III & FDA Review': {\n                title: 'FDA Pre-Submission Meeting',\n                description: 'The FDA has reviewed your pre-submission package and has questions about long-term safety data.',\n                choices: [\n                    {\n                        text: 'Conduct extended follow-up',\n                        budgetEffect: -4000000,\n                        efficacyEffect: 5,\n                        safetyEffect: 15,\n                        outcomeText: 'Extended data collection satisfied FDA concerns. Approval pathway cleared.'\n                    },\n                    {\n                        text: 'Submit current data with justification',\n                        budgetEffect: -500000,\n                        efficacyEffect: 0,\n                        safetyEffect: -5,\n                        outcomeText: 'FDA accepted with conditions. Post-market surveillance required.'\n                    }\n                ],\n                isPhaseComplete: currentStats.efficacy >= 80 && currentStats.safety >= 80\n            }\n        };\n\n        return events[phaseName] || events['Preclinical'];\n    }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3130, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/validation.ts"],"sourcesContent":["/**\n * Enhanced Molecular Validation System\n * Provides comprehensive chemistry validation for PharmaSim\n * \n * Features:\n * - Valence validation with detailed error messages\n * - Graph connectivity analysis\n * - Ring detection (aromatic and aliphatic)\n * - Functional group identification\n * - Expanded molecule recognition database\n * - Molecular weight calculation\n * - Drug-likeness scoring\n * - Educational warnings and hints\n */\n\nimport { Atom, Bond, PeriodicTable, ElementData } from './chemistry';\n\n// ============================================================================\n// Type Definitions\n// ============================================================================\n\nexport interface ValidationResult {\n    valid: boolean;\n    errors: string[];\n    warnings: string[];\n    score: number;\n    name?: string;\n    formula?: string;\n    molecularWeight?: number;\n    functionalGroups?: string[];\n    rings?: RingInfo[];\n    properties?: MoleculeProperties;\n}\n\nexport interface RingInfo {\n    size: number;\n    atomIds: number[];\n    isAromatic: boolean;\n}\n\nexport interface MoleculeProperties {\n    atomCount: number;\n    bondCount: number;\n    heavyAtomCount: number;  // Non-hydrogen atoms\n    rotableBonds: number;\n    hBondDonors: number;     // OH, NH groups\n    hBondAcceptors: number;  // O, N atoms\n    isConnected: boolean;\n    hasAromaticRing: boolean;\n    complexity: number;      // 1-100 scale\n}\n\nexport interface FunctionalGroup {\n    name: string;\n    displayName: string;\n    pattern: (atoms: Atom[], bonds: Bond[], graph: Map<number, number[]>) => number;  // Returns count\n    icon: string;\n    drugRelevance: string;\n}\n\n// ============================================================================\n// Molecule Recognition Database\n// ============================================================================\n\ninterface MoleculeEntry {\n    formula: string;\n    name: string;\n    score: number;\n    category: 'simple' | 'organic' | 'drug' | 'biomolecule';\n    description?: string;\n}\n\nconst MOLECULE_DATABASE: MoleculeEntry[] = [\n    // Simple molecules\n    { formula: 'H2', name: 'Hydrogen Gas', score: 10, category: 'simple' },\n    { formula: 'O2', name: 'Oxygen Gas', score: 10, category: 'simple' },\n    { formula: 'N2', name: 'Nitrogen Gas', score: 10, category: 'simple' },\n    { formula: 'H2O', name: 'Water', score: 30, category: 'simple', description: 'Universal solvent' },\n    { formula: 'CO2', name: 'Carbon Dioxide', score: 40, category: 'simple' },\n    { formula: 'NH3', name: 'Ammonia', score: 35, category: 'simple' },\n    { formula: 'HCl', name: 'Hydrochloric Acid', score: 25, category: 'simple' },\n    { formula: 'HF', name: 'Hydrofluoric Acid', score: 25, category: 'simple' },\n    { formula: 'H2S', name: 'Hydrogen Sulfide', score: 30, category: 'simple' },\n\n    // Basic organic\n    { formula: 'CH4', name: 'Methane', score: 50, category: 'organic', description: 'Simplest alkane' },\n    { formula: 'C2H6', name: 'Ethane', score: 60, category: 'organic' },\n    { formula: 'C3H8', name: 'Propane', score: 70, category: 'organic' },\n    { formula: 'C4H10', name: 'Butane', score: 80, category: 'organic' },\n    { formula: 'C2H4', name: 'Ethylene', score: 65, category: 'organic', description: 'Simplest alkene' },\n    { formula: 'C2H2', name: 'Acetylene', score: 70, category: 'organic', description: 'Simplest alkyne' },\n    { formula: 'C6H6', name: 'Benzene', score: 150, category: 'organic', description: 'Aromatic ring' },\n\n    // Alcohols\n    { formula: 'CH4O', name: 'Methanol', score: 80, category: 'organic' },\n    { formula: 'C2H6O', name: 'Ethanol', score: 100, category: 'organic', description: 'Drinking alcohol' },\n    { formula: 'C3H8O', name: 'Propanol', score: 110, category: 'organic' },\n    { formula: 'C3H8O3', name: 'Glycerol', score: 140, category: 'organic' },\n\n    // Aldehydes & Ketones\n    { formula: 'CH2O', name: 'Formaldehyde', score: 70, category: 'organic' },\n    { formula: 'C2H4O', name: 'Acetaldehyde', score: 85, category: 'organic' },\n    { formula: 'C3H6O', name: 'Acetone', score: 95, category: 'organic' },\n\n    // Carboxylic Acids\n    { formula: 'CH2O2', name: 'Formic Acid', score: 75, category: 'organic' },\n    { formula: 'C2H4O2', name: 'Acetic Acid', score: 90, category: 'organic', description: 'Vinegar' },\n    { formula: 'C3H6O2', name: 'Propionic Acid', score: 100, category: 'organic' },\n\n    // Amines\n    { formula: 'CH5N', name: 'Methylamine', score: 70, category: 'organic' },\n    { formula: 'C2H7N', name: 'Ethylamine', score: 80, category: 'organic' },\n    { formula: 'C6H7N', name: 'Aniline', score: 130, category: 'organic' },\n\n    // Pharmaceuticals\n    { formula: 'C8H9NO2', name: 'Paracetamol', score: 300, category: 'drug', description: 'Acetaminophen - analgesic' },\n    { formula: 'C9H8O4', name: 'Aspirin', score: 350, category: 'drug', description: 'Acetylsalicylic acid - NSAID' },\n    { formula: 'C13H18O2', name: 'Ibuprofen', score: 400, category: 'drug', description: 'NSAID anti-inflammatory' },\n    { formula: 'C8H10N4O2', name: 'Caffeine', score: 450, category: 'drug', description: 'Stimulant' },\n    { formula: 'C17H19NO3', name: 'Morphine', score: 500, category: 'drug', description: 'Opioid analgesic' },\n    { formula: 'C16H18N2O4S', name: 'Penicillin G', score: 550, category: 'drug', description: 'Beta-lactam antibiotic' },\n    { formula: 'C10H15N', name: 'Amphetamine', score: 380, category: 'drug' },\n    { formula: 'C20H25N3O', name: 'LSD', score: 600, category: 'drug' },\n    { formula: 'C21H23NO5', name: 'Codeine', score: 480, category: 'drug' },\n    { formula: 'C14H18N2O5', name: 'Aspartame', score: 350, category: 'organic' },\n\n    // Biomolecules\n    { formula: 'C6H12O6', name: 'Glucose', score: 250, category: 'biomolecule', description: 'Simple sugar' },\n    { formula: 'C5H10O5', name: 'Ribose', score: 220, category: 'biomolecule' },\n    { formula: 'C4H8N2O3', name: 'Asparagine', score: 280, category: 'biomolecule', description: 'Amino acid' },\n    { formula: 'C5H9NO4', name: 'Glutamic Acid', score: 290, category: 'biomolecule', description: 'Amino acid' },\n    { formula: 'C3H7NO2', name: 'Alanine', score: 200, category: 'biomolecule', description: 'Simple amino acid' },\n    { formula: 'C2H5NO2', name: 'Glycine', score: 180, category: 'biomolecule', description: 'Simplest amino acid' },\n\n    // Solvents & Industrial\n    { formula: 'CHCl3', name: 'Chloroform', score: 120, category: 'organic' },\n    { formula: 'CCl4', name: 'Carbon Tetrachloride', score: 110, category: 'organic' },\n    { formula: 'C4H8O2', name: 'Ethyl Acetate', score: 130, category: 'organic', description: 'Common solvent' },\n];\n\n// ============================================================================\n// Functional Group Definitions\n// ============================================================================\n\nconst FUNCTIONAL_GROUPS: FunctionalGroup[] = [\n    {\n        name: 'hydroxyl',\n        displayName: 'Hydroxyl (-OH)',\n        icon: 'ðŸ’§',\n        drugRelevance: 'Increases water solubility',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'O') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const bondInfo = getBondInfo(atom.id, bonds);\n                    // Single-bonded oxygen with one H neighbor\n                    if (bondInfo.totalOrder === 2) {\n                        const hasH = neighbors.some(nId => atoms.find(a => a.id === nId)?.element === 'H');\n                        const hasC = neighbors.some(nId => atoms.find(a => a.id === nId)?.element === 'C');\n                        if (hasH && hasC) count++;\n                    }\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'carbonyl',\n        displayName: 'Carbonyl (C=O)',\n        icon: 'âš—ï¸',\n        drugRelevance: 'Reactive center, H-bond acceptor',\n        pattern: (atoms, bonds) => {\n            let count = 0;\n            bonds.forEach(bond => {\n                if (bond.order === 2) {\n                    const source = atoms.find(a => a.id === bond.sourceId);\n                    const target = atoms.find(a => a.id === bond.targetId);\n                    if ((source?.element === 'C' && target?.element === 'O') ||\n                        (source?.element === 'O' && target?.element === 'C')) {\n                        count++;\n                    }\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'carboxyl',\n        displayName: 'Carboxyl (-COOH)',\n        icon: 'ðŸ§ª',\n        drugRelevance: 'Acidic, increases solubility',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            // Find C atoms double-bonded to O and single-bonded to OH\n            atoms.forEach(atom => {\n                if (atom.element === 'C') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const neighborAtoms = neighbors.map(nId => atoms.find(a => a.id === nId)).filter(Boolean);\n\n                    const hasDoubleBondO = bonds.some(b => {\n                        if (b.order !== 2) return false;\n                        const otherId = b.sourceId === atom.id ? b.targetId : (b.targetId === atom.id ? b.sourceId : null);\n                        if (!otherId) return false;\n                        return atoms.find(a => a.id === otherId)?.element === 'O';\n                    });\n\n                    const hasSingleBondOH = neighborAtoms.some(neighbor => {\n                        if (neighbor?.element !== 'O') return false;\n                        const oNeighbors = graph.get(neighbor.id) || [];\n                        return oNeighbors.some(onId => atoms.find(a => a.id === onId)?.element === 'H');\n                    });\n\n                    if (hasDoubleBondO && hasSingleBondOH) count++;\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'amine',\n        displayName: 'Amine (-NHâ‚‚/-NHR)',\n        icon: 'ðŸ”µ',\n        drugRelevance: 'Basic, H-bond donor',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'N') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const hasH = neighbors.some(nId => atoms.find(a => a.id === nId)?.element === 'H');\n                    const bondInfo = getBondInfo(atom.id, bonds);\n                    // Primary or secondary amine (not in amide)\n                    if (hasH && bondInfo.totalOrder <= 3) {\n                        const hasDoubleBondC = bonds.some(b => {\n                            if (b.order !== 2) return false;\n                            const otherId = b.sourceId === atom.id ? b.targetId : (b.targetId === atom.id ? b.sourceId : null);\n                            return otherId && atoms.find(a => a.id === otherId)?.element === 'C';\n                        });\n                        if (!hasDoubleBondC) count++;\n                    }\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'amide',\n        displayName: 'Amide (-CONHâ‚‚)',\n        icon: 'ðŸ”—',\n        drugRelevance: 'Peptide bond mimic, stable',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'C') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const hasDoubleBondO = bonds.some(b => {\n                        if (b.order !== 2) return false;\n                        const otherId = b.sourceId === atom.id ? b.targetId : (b.targetId === atom.id ? b.sourceId : null);\n                        return otherId && atoms.find(a => a.id === otherId)?.element === 'O';\n                    });\n                    const hasSingleBondN = neighbors.some(nId => {\n                        const neighbor = atoms.find(a => a.id === nId);\n                        if (neighbor?.element !== 'N') return false;\n                        const bond = bonds.find(b =>\n                            (b.sourceId === atom.id && b.targetId === nId) ||\n                            (b.targetId === atom.id && b.sourceId === nId)\n                        );\n                        return bond?.order === 1;\n                    });\n                    if (hasDoubleBondO && hasSingleBondN) count++;\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'ether',\n        displayName: 'Ether (C-O-C)',\n        icon: 'â­•',\n        drugRelevance: 'Increases lipophilicity',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'O') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const bondInfo = getBondInfo(atom.id, bonds);\n                    // O bonded to exactly 2 carbons with single bonds\n                    if (bondInfo.totalOrder === 2 && neighbors.length === 2) {\n                        const allCarbon = neighbors.every(nId => atoms.find(a => a.id === nId)?.element === 'C');\n                        if (allCarbon) count++;\n                    }\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'ester',\n        displayName: 'Ester (-COO-)',\n        icon: 'ðŸ‹',\n        drugRelevance: 'Prodrug linkage, good absorption',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'C') {\n                    const neighbors = graph.get(atom.id) || [];\n                    let hasDoubleBondO = false;\n                    let hasSingleBondOC = false;\n\n                    neighbors.forEach(nId => {\n                        const neighbor = atoms.find(a => a.id === nId);\n                        if (!neighbor) return;\n\n                        const bond = bonds.find(b =>\n                            (b.sourceId === atom.id && b.targetId === nId) ||\n                            (b.targetId === atom.id && b.sourceId === nId)\n                        );\n\n                        if (neighbor.element === 'O' && bond?.order === 2) {\n                            hasDoubleBondO = true;\n                        }\n                        if (neighbor.element === 'O' && bond?.order === 1) {\n                            // Check if this O is connected to C (not H)\n                            const oNeighbors = graph.get(nId) || [];\n                            const connectedToC = oNeighbors.some(onId =>\n                                onId !== atom.id && atoms.find(a => a.id === onId)?.element === 'C'\n                            );\n                            if (connectedToC) hasSingleBondOC = true;\n                        }\n                    });\n\n                    if (hasDoubleBondO && hasSingleBondOC) count++;\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'halogen',\n        displayName: 'Halogen (F/Cl/Br/I)',\n        icon: 'ðŸŸ¢',\n        drugRelevance: 'Metabolic stability, lipophilicity',\n        pattern: (atoms) => {\n            return atoms.filter(a => ['F', 'Cl', 'Br', 'I'].includes(a.element)).length;\n        }\n    },\n    {\n        name: 'thiol',\n        displayName: 'Thiol (-SH)',\n        icon: 'ðŸŸ¡',\n        drugRelevance: 'Reactive, covalent drug target',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'S') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const hasH = neighbors.some(nId => atoms.find(a => a.id === nId)?.element === 'H');\n                    if (hasH) count++;\n                }\n            });\n            return count;\n        }\n    },\n    {\n        name: 'phosphate',\n        displayName: 'Phosphate (-POâ‚„)',\n        icon: 'ðŸŸ ',\n        drugRelevance: 'Energy transfer, nucleotides',\n        pattern: (atoms, bonds, graph) => {\n            let count = 0;\n            atoms.forEach(atom => {\n                if (atom.element === 'P') {\n                    const neighbors = graph.get(atom.id) || [];\n                    const oxygenCount = neighbors.filter(nId =>\n                        atoms.find(a => a.id === nId)?.element === 'O'\n                    ).length;\n                    if (oxygenCount >= 3) count++;\n                }\n            });\n            return count;\n        }\n    }\n];\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\nfunction getBondInfo(atomId: number, bonds: Bond[]): { count: number; totalOrder: number } {\n    const atomBonds = bonds.filter(b => b.sourceId === atomId || b.targetId === atomId);\n    return {\n        count: atomBonds.length,\n        totalOrder: atomBonds.reduce((acc, b) => acc + b.order, 0)\n    };\n}\n\nfunction buildAdjacencyGraph(atoms: Atom[], bonds: Bond[]): Map<number, number[]> {\n    const graph = new Map<number, number[]>();\n    atoms.forEach(atom => graph.set(atom.id, []));\n\n    bonds.forEach(bond => {\n        graph.get(bond.sourceId)?.push(bond.targetId);\n        graph.get(bond.targetId)?.push(bond.sourceId);\n    });\n\n    return graph;\n}\n\nfunction isConnected(atoms: Atom[], graph: Map<number, number[]>): boolean {\n    if (atoms.length === 0) return true;\n    if (atoms.length === 1) return true;\n\n    const visited = new Set<number>();\n    const queue: number[] = [atoms[0].id];\n\n    while (queue.length > 0) {\n        const current = queue.shift()!;\n        if (visited.has(current)) continue;\n        visited.add(current);\n\n        const neighbors = graph.get(current) || [];\n        neighbors.forEach(n => {\n            if (!visited.has(n)) queue.push(n);\n        });\n    }\n\n    return visited.size === atoms.length;\n}\n\nfunction findRings(atoms: Atom[], bonds: Bond[], graph: Map<number, number[]>): RingInfo[] {\n    const rings: RingInfo[] = [];\n    const visited = new Set<number>();\n\n    // Simple ring detection using DFS with parent tracking\n    function dfs(nodeId: number, parentId: number | null, path: number[]): void {\n        if (path.length > 7) return; // Limit to reasonable ring sizes\n\n        const neighbors = graph.get(nodeId) || [];\n\n        for (const neighborId of neighbors) {\n            if (neighborId === parentId) continue;\n\n            const pathIndex = path.indexOf(neighborId);\n            if (pathIndex !== -1) {\n                // Found a ring\n                const ringAtoms = path.slice(pathIndex);\n                const ringSize = ringAtoms.length;\n\n                // Only accept 3-7 membered rings\n                if (ringSize >= 3 && ringSize <= 7) {\n                    // Check if this ring is already found (by sorting atom IDs)\n                    const sortedRing = [...ringAtoms].sort((a, b) => a - b).join(',');\n                    const isNewRing = !rings.some(r =>\n                        [...r.atomIds].sort((a, b) => a - b).join(',') === sortedRing\n                    );\n\n                    if (isNewRing) {\n                        const isAromatic = checkAromaticity(ringAtoms, atoms, bonds);\n                        rings.push({ size: ringSize, atomIds: ringAtoms, isAromatic });\n                    }\n                }\n            } else if (!visited.has(neighborId)) {\n                dfs(neighborId, nodeId, [...path, neighborId]);\n            }\n        }\n    }\n\n    atoms.forEach(atom => {\n        if (!visited.has(atom.id)) {\n            dfs(atom.id, null, [atom.id]);\n            visited.add(atom.id);\n        }\n    });\n\n    return rings;\n}\n\nfunction checkAromaticity(ringAtomIds: number[], atoms: Atom[], bonds: Bond[]): boolean {\n    // Simple aromaticity check: \n    // - Ring must be planar (we assume this)\n    // - All atoms in ring should be C or N\n    // - Should have alternating single/double bonds or be all aromatic\n\n    if (ringAtomIds.length !== 6 && ringAtomIds.length !== 5) return false;\n\n    const ringAtoms = ringAtomIds.map(id => atoms.find(a => a.id === id)).filter(Boolean);\n    if (ringAtoms.length !== ringAtomIds.length) return false;\n\n    // Check if all non-H elements (C, N for simple aromatic)\n    const validElements = ['C', 'N', 'O', 'S'];\n    if (!ringAtoms.every(a => validElements.includes(a!.element))) return false;\n\n    // Count double bonds in ring\n    let doubleBondCount = 0;\n    for (let i = 0; i < ringAtomIds.length; i++) {\n        const a1 = ringAtomIds[i];\n        const a2 = ringAtomIds[(i + 1) % ringAtomIds.length];\n        const bond = bonds.find(b =>\n            (b.sourceId === a1 && b.targetId === a2) ||\n            (b.sourceId === a2 && b.targetId === a1)\n        );\n        if (bond?.order === 2) doubleBondCount++;\n    }\n\n    // For 6-membered ring: should have 3 double bonds (benzene-like)\n    // For 5-membered ring: should have 2 double bonds (furan/pyrrole-like)\n    if (ringAtomIds.length === 6 && doubleBondCount >= 2) return true;\n    if (ringAtomIds.length === 5 && doubleBondCount >= 2) return true;\n\n    return false;\n}\n\nfunction getFormula(atoms: Atom[]): string {\n    const counts: Record<string, number> = {};\n    atoms.forEach(a => {\n        counts[a.element] = (counts[a.element] || 0) + 1;\n    });\n\n    // Hill system: C first, then H, then alphabetical\n    const keys = Object.keys(counts).sort((a, b) => {\n        if (a === 'C') return -1;\n        if (b === 'C') return 1;\n        if (a === 'H') return -1;\n        if (b === 'H') return 1;\n        return a.localeCompare(b);\n    });\n\n    return keys.map(k => `${k}${counts[k] > 1 ? counts[k] : ''}`).join('');\n}\n\nfunction calculateMolecularWeight(atoms: Atom[]): number {\n    return atoms.reduce((sum, atom) => {\n        const element = PeriodicTable[atom.element];\n        return sum + (element?.mass || 0);\n    }, 0);\n}\n\nfunction countRotatableBonds(atoms: Atom[], bonds: Bond[], graph: Map<number, number[]>): number {\n    // Rotatable bonds: single bonds between non-terminal, non-ring atoms\n    let count = 0;\n\n    bonds.forEach(bond => {\n        if (bond.order !== 1) return;\n\n        const source = atoms.find(a => a.id === bond.sourceId);\n        const target = atoms.find(a => a.id === bond.targetId);\n\n        if (!source || !target) return;\n\n        // Exclude H atoms\n        if (source.element === 'H' || target.element === 'H') return;\n\n        // Exclude terminal atoms (only one neighbor)\n        const sourceNeighbors = graph.get(source.id)?.length || 0;\n        const targetNeighbors = graph.get(target.id)?.length || 0;\n\n        if (sourceNeighbors > 1 && targetNeighbors > 1) {\n            count++;\n        }\n    });\n\n    return count;\n}\n\nfunction countHBondDonors(atoms: Atom[], graph: Map<number, number[]>): number {\n    // H-bond donors: OH, NH groups\n    let count = 0;\n\n    atoms.forEach(atom => {\n        if (atom.element === 'O' || atom.element === 'N') {\n            const neighbors = graph.get(atom.id) || [];\n            const hasH = neighbors.some(nId =>\n                atoms.find(a => a.id === nId)?.element === 'H'\n            );\n            if (hasH) count++;\n        }\n    });\n\n    return count;\n}\n\nfunction countHBondAcceptors(atoms: Atom[]): number {\n    // H-bond acceptors: O and N atoms\n    return atoms.filter(a => a.element === 'O' || a.element === 'N').length;\n}\n\nfunction calculateComplexity(atoms: Atom[], bonds: Bond[], rings: RingInfo[], functionalGroupCount: number): number {\n    // Complexity score: 0-100\n    const atomScore = Math.min(atoms.length * 2, 30);\n    const bondScore = Math.min(bonds.length * 1.5, 20);\n    const ringScore = Math.min(rings.length * 10, 25);\n    const aromaticBonus = rings.filter(r => r.isAromatic).length * 5;\n    const fgScore = Math.min(functionalGroupCount * 5, 20);\n\n    return Math.min(100, Math.round(atomScore + bondScore + ringScore + aromaticBonus + fgScore));\n}\n\n// ============================================================================\n// Main Validation Function\n// ============================================================================\n\nexport function validateMolecule(atoms: Atom[], bonds: Bond[]): ValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n    let score = 0;\n\n    // Empty check\n    if (atoms.length === 0) {\n        return {\n            valid: false,\n            errors: ['Molecule is empty'],\n            warnings: [],\n            score: 0\n        };\n    }\n\n    // Build adjacency graph\n    const graph = buildAdjacencyGraph(atoms, bonds);\n\n    // ========== Connectivity Check ==========\n    const connected = isConnected(atoms, graph);\n    if (!connected) {\n        warnings.push('âš ï¸ Molecule has disconnected fragments');\n    }\n\n    // ========== Valence Validation ==========\n    let allValenceSatisfied = true;\n\n    atoms.forEach(atom => {\n        const bondInfo = getBondInfo(atom.id, bonds);\n        const elementData = PeriodicTable[atom.element];\n\n        if (!elementData) {\n            errors.push(`Unknown element: ${atom.element}`);\n            allValenceSatisfied = false;\n            return;\n        }\n\n        const satisfies = elementData.valence.includes(bondInfo.totalOrder);\n\n        if (!satisfies) {\n            allValenceSatisfied = false;\n            const atomLabel = `${elementData.name} #${atom.id.toString().slice(-4)}`;\n            const current = bondInfo.totalOrder;\n            const needed = elementData.valence.join(' or ');\n\n            if (current === 0) {\n                errors.push(`${atomLabel} has no bonds (needs ${needed})`);\n            } else if (current < Math.min(...elementData.valence)) {\n                errors.push(`${atomLabel} needs more bonds: has ${current}, needs ${needed}`);\n            } else if (current > Math.max(...elementData.valence)) {\n                errors.push(`${atomLabel} has too many bonds: has ${current}, max is ${Math.max(...elementData.valence)}`);\n            } else {\n                errors.push(`${atomLabel} has ${current} bonds (needs exactly ${needed})`);\n            }\n        }\n\n        // Warning for unusual valence states\n        if (atom.element === 'C' && bondInfo.totalOrder === 3) {\n            warnings.push(`Carbon atom may be a carbocation (unstable)`);\n        }\n    });\n\n    // ========== Ring Detection ==========\n    const rings = findRings(atoms, bonds, graph);\n\n    // Check for strained rings\n    rings.forEach(ring => {\n        if (ring.size === 3) {\n            warnings.push(`âš ï¸ 3-membered ring detected (high ring strain)`);\n        } else if (ring.size === 4) {\n            warnings.push(`âš ï¸ 4-membered ring detected (moderate ring strain)`);\n        }\n    });\n\n    // ========== Functional Group Detection ==========\n    const detectedGroups: string[] = [];\n    let totalFGCount = 0;\n\n    FUNCTIONAL_GROUPS.forEach(fg => {\n        const count = fg.pattern(atoms, bonds, graph);\n        if (count > 0) {\n            totalFGCount += count;\n            detectedGroups.push(`${fg.icon} ${fg.displayName}${count > 1 ? ` (Ã—${count})` : ''}`);\n        }\n    });\n\n    // ========== Calculate Properties ==========\n    const formula = getFormula(atoms);\n    const molecularWeight = calculateMolecularWeight(atoms);\n    const heavyAtomCount = atoms.filter(a => a.element !== 'H').length;\n    const rotableBonds = countRotatableBonds(atoms, bonds, graph);\n    const hBondDonors = countHBondDonors(atoms, graph);\n    const hBondAcceptors = countHBondAcceptors(atoms);\n    const hasAromaticRing = rings.some(r => r.isAromatic);\n    const complexity = calculateComplexity(atoms, bonds, rings, totalFGCount);\n\n    const properties: MoleculeProperties = {\n        atomCount: atoms.length,\n        bondCount: bonds.length,\n        heavyAtomCount,\n        rotableBonds,\n        hBondDonors,\n        hBondAcceptors,\n        isConnected: connected,\n        hasAromaticRing,\n        complexity\n    };\n\n    // ========== Molecule Recognition ==========\n    let name: string | undefined;\n\n    if (allValenceSatisfied) {\n        const match = MOLECULE_DATABASE.find(m => m.formula === formula);\n\n        if (match) {\n            name = match.name;\n            score = match.score;\n\n            if (match.description) {\n                warnings.unshift(`ðŸ’Š ${match.description}`);\n            }\n        } else {\n            name = \"Valid Unknown Compound\";\n            // Calculate score based on complexity\n            score = Math.round(\n                atoms.length * 8 +\n                rings.length * 20 +\n                totalFGCount * 15 +\n                (hasAromaticRing ? 50 : 0)\n            );\n        }\n\n        // Bonus for aromatic compounds\n        if (hasAromaticRing) {\n            warnings.unshift('ðŸ”µ Contains aromatic ring system');\n        }\n\n        // Drug-likeness check (Lipinski's Rule of 5)\n        if (molecularWeight <= 500 && hBondDonors <= 5 && hBondAcceptors <= 10) {\n            if (heavyAtomCount >= 5) {\n                warnings.unshift('âœ… Passes Lipinski drug-likeness criteria');\n                score += 25;\n            }\n        } else if (molecularWeight > 500) {\n            warnings.push('âš ï¸ Molecular weight >500 (may have poor absorption)');\n        }\n    }\n\n    return {\n        valid: allValenceSatisfied,\n        errors,\n        warnings,\n        score,\n        name,\n        formula,\n        molecularWeight: Math.round(molecularWeight * 100) / 100,\n        functionalGroups: detectedGroups,\n        rings,\n        properties\n    };\n}\n\n// ============================================================================\n// Utility Exports\n// ============================================================================\n\nexport { getFormula, calculateMolecularWeight };\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4022, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/smilesParser.ts"],"sourcesContent":["/**\n * SMILES Parser - Converts SMILES notation to 3D molecular structures\n * \n * Supported features:\n * - Organic subset atoms: B, C, N, O, P, S, F, Cl, Br, I\n * - Bracket atoms: [NH4+], [O-], [13C], etc.\n * - Bond types: - (single), = (double), # (triple)\n * - Branches: parentheses ()\n * - Ring closures: numeric digits 1-9, %10-%99\n * - Aromatic atoms: lowercase c, n, o, s\n * - Implicit hydrogens (added automatically)\n * \n * Limitations:\n * - Stereochemistry (@, @@, /, \\) is parsed but not applied to 3D\n * - Charges are parsed but not used in rendering\n * - Isotopes are parsed but not used\n */\n\nimport { Atom, Bond, PeriodicTable } from './chemistry';\n\n// ============================================================================\n// Types\n// ============================================================================\n\ninterface ParsedAtom {\n    element: string;\n    aromatic: boolean;\n    charge: number;\n    hCount: number | null;  // Explicit H count, null means implicit\n    isotope: number | null;\n}\n\ninterface ParserState {\n    pos: number;\n    atoms: ParsedAtom[];\n    bonds: Array<{ source: number; target: number; order: number }>;\n    ringClosures: Map<number, { atomIndex: number; bondOrder: number }>;\n    branchStack: number[];  // Stack of atom indices for branch returns\n    lastAtomIndex: number;\n    pendingBondOrder: number;\n}\n\nexport interface SmilesParseResult {\n    success: boolean;\n    atoms: Atom[];\n    bonds: Bond[];\n    error?: string;\n}\n\n// ============================================================================\n// Element Data for Valence\n// ============================================================================\n\nconst VALENCE_MAP: Record<string, number[]> = {\n    'H': [1],\n    'B': [3],\n    'C': [4],\n    'N': [3, 4, 5],\n    'O': [2],\n    'P': [3, 5],\n    'S': [2, 4, 6],\n    'F': [1],\n    'Cl': [1],\n    'Br': [1],\n    'I': [1],\n};\n\n// Organic subset - atoms that can appear without brackets\nconst ORGANIC_SUBSET = new Set(['B', 'C', 'N', 'O', 'P', 'S', 'F', 'Cl', 'Br', 'I']);\n\n// Aromatic atoms (lowercase in SMILES)\nconst AROMATIC_ATOMS: Record<string, string> = {\n    'c': 'C',\n    'n': 'N',\n    'o': 'O',\n    's': 'S',\n    'p': 'P',\n};\n\n// ============================================================================\n// Parser Functions\n// ============================================================================\n\nfunction peek(smiles: string, state: ParserState): string {\n    return smiles[state.pos] || '';\n}\n\nfunction consume(smiles: string, state: ParserState): string {\n    return smiles[state.pos++] || '';\n}\n\nfunction parseNumber(smiles: string, state: ParserState): number | null {\n    let numStr = '';\n    while (state.pos < smiles.length && /[0-9]/.test(smiles[state.pos])) {\n        numStr += consume(smiles, state);\n    }\n    return numStr ? parseInt(numStr, 10) : null;\n}\n\nfunction parseBracketAtom(smiles: string, state: ParserState): ParsedAtom | null {\n    // Assumes '[' has been consumed\n    let isotope: number | null = null;\n    let element = '';\n    let aromatic = false;\n    let hCount: number | null = null;\n    let charge = 0;\n\n    // Isotope (optional)\n    const isoNum = parseNumber(smiles, state);\n    if (isoNum !== null) isotope = isoNum;\n\n    // Element symbol (1-2 chars)\n    const first = consume(smiles, state);\n    if (!first) return null;\n\n    if (first === first.toLowerCase() && AROMATIC_ATOMS[first]) {\n        aromatic = true;\n        element = AROMATIC_ATOMS[first];\n    } else {\n        element = first.toUpperCase();\n        // Check for two-character elements\n        const next = peek(smiles, state);\n        if (next && next === next.toLowerCase() && /[a-z]/.test(next)) {\n            element += consume(smiles, state);\n        }\n    }\n\n    // Parse remaining bracket contents\n    while (state.pos < smiles.length && peek(smiles, state) !== ']') {\n        const char = peek(smiles, state);\n\n        if (char === 'H') {\n            consume(smiles, state);\n            const num = parseNumber(smiles, state);\n            hCount = num !== null ? num : 1;\n        } else if (char === '+') {\n            consume(smiles, state);\n            const num = parseNumber(smiles, state);\n            charge = num !== null ? num : 1;\n        } else if (char === '-') {\n            consume(smiles, state);\n            const num = parseNumber(smiles, state);\n            charge = -(num !== null ? num : 1);\n        } else if (char === '@') {\n            // Skip stereochemistry\n            consume(smiles, state);\n            if (peek(smiles, state) === '@') consume(smiles, state);\n        } else {\n            // Skip unknown characters\n            consume(smiles, state);\n        }\n    }\n\n    // Consume closing bracket\n    if (peek(smiles, state) === ']') consume(smiles, state);\n\n    return { element, aromatic, charge, hCount, isotope };\n}\n\nfunction parseOrganicAtom(smiles: string, state: ParserState): ParsedAtom | null {\n    const char = peek(smiles, state);\n\n    // Check for aromatic atoms\n    if (AROMATIC_ATOMS[char]) {\n        consume(smiles, state);\n        return { element: AROMATIC_ATOMS[char], aromatic: true, charge: 0, hCount: null, isotope: null };\n    }\n\n    // Check for two-character elements first (Cl, Br)\n    const twoChar = smiles.slice(state.pos, state.pos + 2);\n    if (twoChar === 'Cl' || twoChar === 'Br') {\n        state.pos += 2;\n        return { element: twoChar, aromatic: false, charge: 0, hCount: null, isotope: null };\n    }\n\n    // Single character organic subset\n    const upper = char.toUpperCase();\n    if (ORGANIC_SUBSET.has(upper) && char === upper) {\n        consume(smiles, state);\n        return { element: upper, aromatic: false, charge: 0, hCount: null, isotope: null };\n    }\n\n    return null;\n}\n\nfunction parseBondOrder(smiles: string, state: ParserState): number {\n    const char = peek(smiles, state);\n\n    switch (char) {\n        case '-': consume(smiles, state); return 1;\n        case '=': consume(smiles, state); return 2;\n        case '#': consume(smiles, state); return 3;\n        case ':': consume(smiles, state); return 1; // Aromatic bond treated as single\n        default: return 0; // Implicit bond\n    }\n}\n\nfunction parseRingClosure(smiles: string, state: ParserState): number | null {\n    const char = peek(smiles, state);\n\n    // Single digit ring\n    if (/[0-9]/.test(char)) {\n        consume(smiles, state);\n        return parseInt(char, 10);\n    }\n\n    // Double digit ring (%XX)\n    if (char === '%') {\n        consume(smiles, state);\n        const num = parseNumber(smiles, state);\n        return num;\n    }\n\n    return null;\n}\n\nfunction addBond(state: ParserState, source: number, target: number, order: number) {\n    // Avoid duplicate bonds\n    const exists = state.bonds.some(b =>\n        (b.source === source && b.target === target) ||\n        (b.source === target && b.target === source)\n    );\n    if (!exists && source !== target && source >= 0 && target >= 0) {\n        state.bonds.push({ source, target, order });\n    }\n}\n\nfunction calculateImplicitHydrogens(parsedAtoms: ParsedAtom[], bonds: Array<{ source: number; target: number; order: number }>): number[] {\n    return parsedAtoms.map((atom, idx) => {\n        // If explicit H count is specified, use it\n        if (atom.hCount !== null) return atom.hCount;\n\n        // Calculate current bond order sum\n        const bondOrderSum = bonds\n            .filter(b => b.source === idx || b.target === idx)\n            .reduce((sum, b) => sum + b.order, 0);\n\n        // Get target valence\n        const valences = VALENCE_MAP[atom.element] || [0];\n        const targetValence = valences.find(v => v >= bondOrderSum) || valences[valences.length - 1];\n\n        // Aromatic atoms typically have one less hydrogen\n        const aromaticAdjust = atom.aromatic ? 1 : 0;\n\n        return Math.max(0, targetValence - bondOrderSum - aromaticAdjust);\n    });\n}\n\n// ============================================================================\n// 3D Coordinate Generation\n// ============================================================================\n\nfunction generate3DCoordinates(atomCount: number, bonds: Array<{ source: number; target: number; order: number }>): Array<{ x: number; y: number; z: number }> {\n    // Simple force-directed layout in 3D\n    const positions: Array<{ x: number; y: number; z: number }> = [];\n\n    // Initialize with random positions in a sphere\n    for (let i = 0; i < atomCount; i++) {\n        const theta = Math.random() * Math.PI * 2;\n        const phi = Math.acos(2 * Math.random() - 1);\n        const r = 2 + Math.random() * 2;\n        positions.push({\n            x: r * Math.sin(phi) * Math.cos(theta),\n            y: r * Math.sin(phi) * Math.sin(theta),\n            z: r * Math.cos(phi)\n        });\n    }\n\n    // Force-directed iterations\n    const ITERATIONS = 100;\n    const IDEAL_BOND_LENGTH = 1.5;\n    const REPULSION = 2.0;\n    const ATTRACTION = 0.1;\n    const DAMPING = 0.9;\n\n    const velocities = positions.map(() => ({ x: 0, y: 0, z: 0 }));\n\n    for (let iter = 0; iter < ITERATIONS; iter++) {\n        const forces = positions.map(() => ({ x: 0, y: 0, z: 0 }));\n\n        // Repulsion between all atoms\n        for (let i = 0; i < atomCount; i++) {\n            for (let j = i + 1; j < atomCount; j++) {\n                const dx = positions[i].x - positions[j].x;\n                const dy = positions[i].y - positions[j].y;\n                const dz = positions[i].z - positions[j].z;\n                const dist = Math.sqrt(dx * dx + dy * dy + dz * dz) + 0.01;\n                const force = REPULSION / (dist * dist);\n\n                forces[i].x += (dx / dist) * force;\n                forces[i].y += (dy / dist) * force;\n                forces[i].z += (dz / dist) * force;\n                forces[j].x -= (dx / dist) * force;\n                forces[j].y -= (dy / dist) * force;\n                forces[j].z -= (dz / dist) * force;\n            }\n        }\n\n        // Attraction along bonds\n        bonds.forEach(bond => {\n            const i = bond.source;\n            const j = bond.target;\n            if (i >= atomCount || j >= atomCount) return;\n\n            const dx = positions[j].x - positions[i].x;\n            const dy = positions[j].y - positions[i].y;\n            const dz = positions[j].z - positions[i].z;\n            const dist = Math.sqrt(dx * dx + dy * dy + dz * dz) + 0.01;\n            const displacement = dist - IDEAL_BOND_LENGTH;\n            const force = ATTRACTION * displacement;\n\n            forces[i].x += (dx / dist) * force;\n            forces[i].y += (dy / dist) * force;\n            forces[i].z += (dz / dist) * force;\n            forces[j].x -= (dx / dist) * force;\n            forces[j].y -= (dy / dist) * force;\n            forces[j].z -= (dz / dist) * force;\n        });\n\n        // Apply forces with damping\n        for (let i = 0; i < atomCount; i++) {\n            velocities[i].x = (velocities[i].x + forces[i].x) * DAMPING;\n            velocities[i].y = (velocities[i].y + forces[i].y) * DAMPING;\n            velocities[i].z = (velocities[i].z + forces[i].z) * DAMPING;\n\n            positions[i].x += velocities[i].x;\n            positions[i].y += velocities[i].y;\n            positions[i].z += velocities[i].z;\n        }\n    }\n\n    // Center the molecule\n    const center = { x: 0, y: 0, z: 0 };\n    positions.forEach(p => {\n        center.x += p.x;\n        center.y += p.y;\n        center.z += p.z;\n    });\n    center.x /= atomCount || 1;\n    center.y /= atomCount || 1;\n    center.z /= atomCount || 1;\n\n    return positions.map(p => ({\n        x: Math.round((p.x - center.x) * 100) / 100,\n        y: Math.round((p.y - center.y) * 100) / 100,\n        z: Math.round((p.z - center.z) * 100) / 100\n    }));\n}\n\n// ============================================================================\n// Main Parser\n// ============================================================================\n\nexport function parseSmiles(smiles: string): SmilesParseResult {\n    // Sanitize input\n    smiles = smiles.trim();\n\n    if (!smiles) {\n        return { success: false, atoms: [], bonds: [], error: 'Empty SMILES string' };\n    }\n\n    const state: ParserState = {\n        pos: 0,\n        atoms: [],\n        bonds: [],\n        ringClosures: new Map(),\n        branchStack: [],\n        lastAtomIndex: -1,\n        pendingBondOrder: 0,\n    };\n\n    try {\n        while (state.pos < smiles.length) {\n            const char = peek(smiles, state);\n\n            // Skip whitespace\n            if (/\\s/.test(char)) {\n                consume(smiles, state);\n                continue;\n            }\n\n            // Skip stereochemistry markers\n            if (char === '/' || char === '\\\\') {\n                consume(smiles, state);\n                continue;\n            }\n\n            // Bond order\n            if (char === '-' || char === '=' || char === '#' || char === ':') {\n                state.pendingBondOrder = parseBondOrder(smiles, state);\n                continue;\n            }\n\n            // Branch start\n            if (char === '(') {\n                consume(smiles, state);\n                state.branchStack.push(state.lastAtomIndex);\n                continue;\n            }\n\n            // Branch end\n            if (char === ')') {\n                consume(smiles, state);\n                if (state.branchStack.length > 0) {\n                    state.lastAtomIndex = state.branchStack.pop()!;\n                }\n                continue;\n            }\n\n            // Disconnection (dot)\n            if (char === '.') {\n                consume(smiles, state);\n                state.lastAtomIndex = -1;\n                continue;\n            }\n\n            // Ring closure\n            const ringNum = parseRingClosure(smiles, state);\n            if (ringNum !== null) {\n                const bondOrder = state.pendingBondOrder || 1;\n                state.pendingBondOrder = 0;\n\n                if (state.ringClosures.has(ringNum)) {\n                    // Close the ring\n                    const opener = state.ringClosures.get(ringNum)!;\n                    const closerOrder = Math.max(opener.bondOrder, bondOrder);\n                    addBond(state, opener.atomIndex, state.lastAtomIndex, closerOrder);\n                    state.ringClosures.delete(ringNum);\n                } else {\n                    // Open a new ring\n                    state.ringClosures.set(ringNum, {\n                        atomIndex: state.lastAtomIndex,\n                        bondOrder\n                    });\n                }\n                continue;\n            }\n\n            // Bracket atom\n            if (char === '[') {\n                consume(smiles, state);\n                const atom = parseBracketAtom(smiles, state);\n                if (!atom) {\n                    return { success: false, atoms: [], bonds: [], error: `Invalid bracket atom at position ${state.pos}` };\n                }\n\n                const atomIndex = state.atoms.length;\n                state.atoms.push(atom);\n\n                if (state.lastAtomIndex >= 0) {\n                    const bondOrder = state.pendingBondOrder || 1;\n                    addBond(state, state.lastAtomIndex, atomIndex, bondOrder);\n                }\n                state.pendingBondOrder = 0;\n                state.lastAtomIndex = atomIndex;\n                continue;\n            }\n\n            // Organic subset atom\n            const atom = parseOrganicAtom(smiles, state);\n            if (atom) {\n                const atomIndex = state.atoms.length;\n                state.atoms.push(atom);\n\n                if (state.lastAtomIndex >= 0) {\n                    const bondOrder = state.pendingBondOrder || (atom.aromatic && state.atoms[state.lastAtomIndex]?.aromatic ? 1 : 1);\n                    addBond(state, state.lastAtomIndex, atomIndex, bondOrder);\n                }\n                state.pendingBondOrder = 0;\n                state.lastAtomIndex = atomIndex;\n                continue;\n            }\n\n            // Unknown character\n            return { success: false, atoms: [], bonds: [], error: `Unexpected character '${char}' at position ${state.pos}` };\n        }\n\n        // Check for unclosed rings\n        if (state.ringClosures.size > 0) {\n            const unclosed = Array.from(state.ringClosures.keys()).join(', ');\n            return { success: false, atoms: [], bonds: [], error: `Unclosed ring(s): ${unclosed}` };\n        }\n\n        // Calculate implicit hydrogens and add them\n        const implicitH = calculateImplicitHydrogens(state.atoms, state.bonds);\n\n        // Add hydrogen atoms\n        const allAtoms: ParsedAtom[] = [...state.atoms];\n        const allBonds = [...state.bonds];\n\n        implicitH.forEach((hCount, parentIdx) => {\n            for (let h = 0; h < hCount; h++) {\n                const hIdx = allAtoms.length;\n                allAtoms.push({ element: 'H', aromatic: false, charge: 0, hCount: 0, isotope: null });\n                allBonds.push({ source: parentIdx, target: hIdx, order: 1 });\n            }\n        });\n\n        // Generate 3D coordinates\n        const positions = generate3DCoordinates(allAtoms.length, allBonds);\n\n        // Convert to output format\n        const outputAtoms: Atom[] = allAtoms.map((a, i) => ({\n            id: Date.now() + i,\n            element: a.element,\n            x: positions[i]?.x || 0,\n            y: positions[i]?.y || 0,\n            z: positions[i]?.z || 0\n        }));\n\n        const outputBonds: Bond[] = allBonds.map((b, i) => ({\n            id: Date.now() + 1000 + i,\n            sourceId: outputAtoms[b.source]?.id || 0,\n            targetId: outputAtoms[b.target]?.id || 0,\n            order: b.order\n        }));\n\n        return { success: true, atoms: outputAtoms, bonds: outputBonds };\n\n    } catch (error) {\n        return {\n            success: false,\n            atoms: [],\n            bonds: [],\n            error: `Parse error: ${error instanceof Error ? error.message : 'Unknown error'}`\n        };\n    }\n}\n\n// ============================================================================\n// Common SMILES Examples for Quick Input\n// ============================================================================\n\nexport const SMILES_EXAMPLES: Array<{ name: string; smiles: string; category: string }> = [\n    // Simple\n    { name: 'Water', smiles: 'O', category: 'Simple' },\n    { name: 'Ammonia', smiles: 'N', category: 'Simple' },\n    { name: 'Methane', smiles: 'C', category: 'Simple' },\n    { name: 'Carbon Dioxide', smiles: 'O=C=O', category: 'Simple' },\n    { name: 'Hydrogen Peroxide', smiles: 'OO', category: 'Simple' },\n\n    // Alkanes\n    { name: 'Ethane', smiles: 'CC', category: 'Alkanes' },\n    { name: 'Propane', smiles: 'CCC', category: 'Alkanes' },\n    { name: 'Butane', smiles: 'CCCC', category: 'Alkanes' },\n    { name: 'Isobutane', smiles: 'CC(C)C', category: 'Alkanes' },\n\n    // Alcohols\n    { name: 'Methanol', smiles: 'CO', category: 'Alcohols' },\n    { name: 'Ethanol', smiles: 'CCO', category: 'Alcohols' },\n    { name: 'Isopropanol', smiles: 'CC(O)C', category: 'Alcohols' },\n    { name: 'Glycerol', smiles: 'OCC(O)CO', category: 'Alcohols' },\n\n    // Aromatics\n    { name: 'Benzene', smiles: 'c1ccccc1', category: 'Aromatics' },\n    { name: 'Toluene', smiles: 'Cc1ccccc1', category: 'Aromatics' },\n    { name: 'Phenol', smiles: 'Oc1ccccc1', category: 'Aromatics' },\n    { name: 'Aniline', smiles: 'Nc1ccccc1', category: 'Aromatics' },\n\n    // Drugs\n    { name: 'Aspirin', smiles: 'CC(=O)Oc1ccccc1C(=O)O', category: 'Drugs' },\n    { name: 'Paracetamol', smiles: 'CC(=O)Nc1ccc(O)cc1', category: 'Drugs' },\n    { name: 'Caffeine', smiles: 'Cn1cnc2c1c(=O)n(C)c(=O)n2C', category: 'Drugs' },\n    { name: 'Ibuprofen', smiles: 'CC(C)Cc1ccc(C(C)C(=O)O)cc1', category: 'Drugs' },\n\n    // Amino Acids\n    { name: 'Glycine', smiles: 'NCC(=O)O', category: 'Amino Acids' },\n    { name: 'Alanine', smiles: 'CC(N)C(=O)O', category: 'Amino Acids' },\n    { name: 'Serine', smiles: 'NC(CO)C(=O)O', category: 'Amino Acids' },\n];\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4698, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/builder/Builder.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"active\": \"Builder-module__puRpEa__active\",\n  \"aiFeedback\": \"Builder-module__puRpEa__aiFeedback\",\n  \"btn\": \"Builder-module__puRpEa__btn\",\n  \"btnPrimary\": \"Builder-module__puRpEa__btnPrimary\",\n  \"btnSuccess\": \"Builder-module__puRpEa__btnSuccess\",\n  \"builderContainer\": \"Builder-module__puRpEa__builderContainer\",\n  \"canvasArea\": \"Builder-module__puRpEa__canvasArea\",\n  \"canvasContainer\": \"Builder-module__puRpEa__canvasContainer\",\n  \"canvasHeader\": \"Builder-module__puRpEa__canvasHeader\",\n  \"container\": \"Builder-module__puRpEa__container\",\n  \"controls\": \"Builder-module__puRpEa__controls\",\n  \"elementCard\": \"Builder-module__puRpEa__elementCard\",\n  \"elementList\": \"Builder-module__puRpEa__elementList\",\n  \"elementsGrid\": \"Builder-module__puRpEa__elementsGrid\",\n  \"feedbackStats\": \"Builder-module__puRpEa__feedbackStats\",\n  \"header\": \"Builder-module__puRpEa__header\",\n  \"hintCard\": \"Builder-module__puRpEa__hintCard\",\n  \"hintText\": \"Builder-module__puRpEa__hintText\",\n  \"hintTitle\": \"Builder-module__puRpEa__hintTitle\",\n  \"iconPurple\": \"Builder-module__puRpEa__iconPurple\",\n  \"palette\": \"Builder-module__puRpEa__palette\",\n  \"propBar\": \"Builder-module__puRpEa__propBar\",\n  \"propFill\": \"Builder-module__puRpEa__propFill\",\n  \"propHeader\": \"Builder-module__puRpEa__propHeader\",\n  \"propLabel\": \"Builder-module__puRpEa__propLabel\",\n  \"propSection\": \"Builder-module__puRpEa__propSection\",\n  \"propTags\": \"Builder-module__puRpEa__propTags\",\n  \"propValue\": \"Builder-module__puRpEa__propValue\",\n  \"properties\": \"Builder-module__puRpEa__properties\",\n  \"selected\": \"Builder-module__puRpEa__selected\",\n  \"sidebar\": \"Builder-module__puRpEa__sidebar\",\n  \"statusMsg\": \"Builder-module__puRpEa__statusMsg\",\n  \"tag\": \"Builder-module__puRpEa__tag\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 4737, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/components/builder/MissionSelector.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { SYLLABUS_DATA, SyllabusLevel } from '@/lib/syllabusData';\n\ninterface MissionSelectorProps {\n    userLevel: number;\n    onSelectMission: (mission: SyllabusLevel) => void;\n    currentMissionId: number;\n}\n\nexport default function MissionSelector({ userLevel, onSelectMission, currentMissionId }: MissionSelectorProps) {\n\n    // Sort levels just in case\n    const sortedLevels = [...SYLLABUS_DATA].sort((a, b) => a.level - b.level);\n\n    return (\n        <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '12px',\n            marginBottom: '20px',\n        }}>\n            <h3 style={{ margin: 0, fontSize: '0.85rem', fontWeight: 700, color: '#9ca3af', textTransform: 'uppercase', letterSpacing: '0.5px' }}>\n                ðŸ—ºï¸ Syllabus Map\n            </h3>\n\n            <div className=\"no-scrollbar\" style={{\n                display: 'flex',\n                gap: '8px',\n                overflowX: 'auto',\n                paddingBottom: '4px',\n                maskImage: 'linear-gradient(to right, black 85%, transparent 100%)',\n                WebkitMaskImage: 'linear-gradient(to right, black 85%, transparent 100%)'\n            }}>\n                <style jsx>{`\n                    .no-scrollbar::-webkit-scrollbar {\n                        display: none;\n                    }\n                    .no-scrollbar {\n                        -ms-overflow-style: none;\n                        scrollbar-width: none;\n                    }\n                `}</style>\n                {sortedLevels.map((level) => {\n                    const isLocked = level.level > userLevel;\n                    const isActive = level.level === currentMissionId;\n                    const isCompleted = level.level < userLevel;\n\n                    return (\n                        <div\n                            key={level.level}\n                            onClick={() => !isLocked && onSelectMission(level)}\n                            style={{\n                                minWidth: '120px',\n                                padding: '10px',\n                                borderRadius: '10px',\n                                background: isActive ? '#2563eb' : (isLocked ? '#1f2937' : '#1f2937'),\n                                border: isActive ? '1px solid #60a5fa' : '1px solid #374151',\n                                cursor: isLocked ? 'not-allowed' : 'pointer',\n                                opacity: isLocked ? 0.5 : 1,\n                                display: 'flex',\n                                flexDirection: 'column',\n                                gap: '2px',\n                                position: 'relative',\n                                transition: 'all 0.2s',\n                                transform: isActive ? 'scale(1.02)' : 'scale(1)'\n                            }}\n                        >\n                            {/* Header */}\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>\n                                <span style={{\n                                    fontSize: '0.65rem',\n                                    fontWeight: 'bold',\n                                    color: isActive ? '#e0e7ff' : '#6b7280',\n                                    textTransform: 'uppercase'\n                                }}>\n                                    {level.semester}\n                                </span>\n                                {isLocked && <span style={{ fontSize: '0.7rem' }}>ðŸ”’</span>}\n                                {isCompleted && <span style={{ fontSize: '0.7rem' }}>âœ…</span>}\n                            </div>\n\n                            {/* Title */}\n                            <div style={{\n                                fontSize: '0.85rem',\n                                fontWeight: '600',\n                                color: isActive ? '#fff' : '#e5e7eb',\n                                lineHeight: '1.2',\n                                whiteSpace: 'nowrap',\n                                overflow: 'hidden',\n                                textOverflow: 'ellipsis'\n                            }}>\n                                {level.moleculeTemplate.name}\n                            </div>\n\n                            {/* Active Indicator */}\n                            {isActive && (\n                                <div style={{\n                                    height: '2px',\n                                    background: '#fff',\n                                    marginTop: '6px',\n                                    borderRadius: '1px',\n                                    opacity: 0.5\n                                }} />\n                            )}\n                        </div>\n                    );\n                })}\n            </div>\n\n            <div style={{\n                fontSize: '0.75rem',\n                color: '#9ca3af',\n                background: '#151921',\n                padding: '10px',\n                borderRadius: '8px',\n                border: '1px solid rgba(255,255,255,0.05)',\n                lineHeight: '1.4'\n            }}>\n                <span style={{ color: '#60a5fa', fontWeight: 600 }}>Objective:</span> {\n                    SYLLABUS_DATA.find(s => s.level === userLevel)?.learningObjective || \"Master the syllabus.\"\n                }\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;;AAGA;AAHA;;;;AAWe,SAAS,gBAAgB,EAAE,SAAS,EAAE,eAAe,EAAE,gBAAgB,EAAwB;IAE1G,2BAA2B;IAC3B,MAAM,eAAe;WAAI,2IAAa;KAAC,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,KAAK,GAAG,EAAE,KAAK;IAExE,qBACI,8OAAC;QAAI,OAAO;YACR,SAAS;YACT,eAAe;YACf,KAAK;YACL,cAAc;QAClB;;0BACI,8OAAC;gBAAG,OAAO;oBAAE,QAAQ;oBAAG,UAAU;oBAAW,YAAY;oBAAK,OAAO;oBAAW,eAAe;oBAAa,eAAe;gBAAQ;0BAAG;;;;;;0BAItI,8OAAC;gBAA6B,OAAO;oBACjC,SAAS;oBACT,KAAK;oBACL,WAAW;oBACX,eAAe;oBACf,WAAW;oBACX,iBAAiB;gBACrB;0DAPe;;;;;;oBAiBV,aAAa,GAAG,CAAC,CAAC;wBACf,MAAM,WAAW,MAAM,KAAK,GAAG;wBAC/B,MAAM,WAAW,MAAM,KAAK,KAAK;wBACjC,MAAM,cAAc,MAAM,KAAK,GAAG;wBAElC,qBACI,8OAAC;4BAEG,SAAS,IAAM,CAAC,YAAY,gBAAgB;4BAC5C,OAAO;gCACH,UAAU;gCACV,SAAS;gCACT,cAAc;gCACd,YAAY,WAAW,YAAa,WAAW,YAAY;gCAC3D,QAAQ,WAAW,sBAAsB;gCACzC,QAAQ,WAAW,gBAAgB;gCACnC,SAAS,WAAW,MAAM;gCAC1B,SAAS;gCACT,eAAe;gCACf,KAAK;gCACL,UAAU;gCACV,YAAY;gCACZ,WAAW,WAAW,gBAAgB;4BAC1C;;;8CAGA,8OAAC;oCAAI,OAAO;wCAAE,SAAS;wCAAQ,gBAAgB;wCAAiB,YAAY;wCAAU,cAAc;oCAAM;;;sDACtG,8OAAC;4CAAK,OAAO;gDACT,UAAU;gDACV,YAAY;gDACZ,OAAO,WAAW,YAAY;gDAC9B,eAAe;4CACnB;;sDACK,MAAM,QAAQ;;;;;;wCAElB,0BAAY,8OAAC;4CAAK,OAAO;gDAAE,UAAU;4CAAS;;sDAAG;;;;;;wCACjD,6BAAe,8OAAC;4CAAK,OAAO;gDAAE,UAAU;4CAAS;;sDAAG;;;;;;;;;;;;8CAIzD,8OAAC;oCAAI,OAAO;wCACR,UAAU;wCACV,YAAY;wCACZ,OAAO,WAAW,SAAS;wCAC3B,YAAY;wCACZ,YAAY;wCACZ,UAAU;wCACV,cAAc;oCAClB;;8CACK,MAAM,gBAAgB,CAAC,IAAI;;;;;;gCAI/B,0BACG,8OAAC;oCAAI,OAAO;wCACR,QAAQ;wCACR,YAAY;wCACZ,WAAW;wCACX,cAAc;wCACd,SAAS;oCACb;;;;;;;;2BArDC,MAAM,KAAK;;;;;oBAyD5B;;;;;;;0BAGJ,8OAAC;gBAAI,OAAO;oBACR,UAAU;oBACV,OAAO;oBACP,YAAY;oBACZ,SAAS;oBACT,cAAc;oBACd,QAAQ;oBACR,YAAY;gBAChB;;kCACI,8OAAC;wBAAK,OAAO;4BAAE,OAAO;4BAAW,YAAY;wBAAI;kCAAG;;;;;;oBAAiB;oBACjE,2IAAa,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,YAAY,qBAAqB;;;;;;;;;;;;;AAKzF"}},
    {"offset": {"line": 4950, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/trialService.ts"],"sourcesContent":["/**\n * Trial Service - Manages clinical trial submissions in Firebase\n * Stores trial data including AI-generated roadmaps persistently\n */\n\nimport { db } from './firebase';\nimport { doc, getDoc, setDoc, updateDoc, collection, query, where, getDocs, deleteDoc } from 'firebase/firestore';\n\nexport interface TrialPhaseData {\n    name: string;\n    duration: string;\n    description: string;\n    keyActivities: string[];\n    risks: string;\n}\n\nexport interface RoadmapData {\n    summary: string;\n    phases: TrialPhaseData[];\n    successProbability: number;\n    generatedAt: number;\n}\n\n// Exported types for shared usage across components\nexport interface CachedTrialEvent {\n    phaseIndex?: number;\n    title: string;\n    description: string;\n    choices: Array<{\n        text: string;\n        budgetEffect: number;\n        efficacyEffect: number;\n        safetyEffect: number;\n        outcomeText: string;\n    }>;\n    isPhaseComplete?: boolean;\n}\n\nexport interface SimulationState {\n    currentPhaseIndex: number;\n    eventIndex: number;\n    budget: number;\n    efficacy: number;\n    safety: number;\n    logs: string[];\n    previousEvents: string[];\n    cachedEvents?: CachedTrialEvent[];\n}\n\nexport interface TrialSubmission {\n    id: string;\n    userId: string;\n    moleculeName: string;\n    missionId: number;\n    missionTitle: string;\n    atomCount: number;\n    stats: {\n        efficacy: number;\n        safety: number;\n        stability: number;\n    };\n    aiAnalysis?: string;\n    imageUrl?: string;\n    generatedImageUrl?: string;\n    roadmap?: RoadmapData;\n    submittedAt: number;\n    status: 'pending' | 'in_progress' | 'completed' | 'failed';\n    simulationState?: SimulationState;\n}\n\nexport const TrialService = {\n    /**\n     * Get all trial submissions for a user from Firebase\n     */\n    async getSubmissions(userId: string): Promise<TrialSubmission[]> {\n        try {\n            const q = query(\n                collection(db, 'trials'),\n                where('userId', '==', userId)\n            );\n            const querySnapshot = await getDocs(q);\n            const submissions = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as TrialSubmission));\n            return submissions.sort((a, b) => (b.submittedAt || 0) - (a.submittedAt || 0));\n        } catch (e) {\n            console.error('Failed to load trial submissions:', e);\n            return [];\n        }\n    },\n\n    /**\n     * Save a new trial submission to Firebase\n     */\n    async saveSubmission(\n        userId: string,\n        submission: Omit<TrialSubmission, 'id' | 'userId' | 'submittedAt' | 'status'>\n    ): Promise<TrialSubmission> {\n        const id = `trial_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n\n        const newSubmission: TrialSubmission = {\n            ...submission,\n            id,\n            userId: userId,\n            submittedAt: Date.now(),\n            status: 'pending'\n        };\n\n        await setDoc(doc(db, 'trials', id), newSubmission);\n        return newSubmission;\n    },\n\n    /**\n     * Update an existing submission (including roadmap)\n     */\n    async updateSubmission(id: string, updates: Partial<TrialSubmission>): Promise<TrialSubmission | null> {\n        try {\n            const docRef = doc(db, 'trials', id);\n            await updateDoc(docRef, updates);\n\n            const docSnap = await getDoc(docRef);\n            if (docSnap.exists()) {\n                return { id: docSnap.id, ...docSnap.data() } as TrialSubmission;\n            }\n            return null;\n        } catch (e) {\n            console.error('Failed to update trial:', e);\n            return null;\n        }\n    },\n\n    /**\n     * Get a single submission by ID\n     */\n    async getSubmission(id: string): Promise<TrialSubmission | null> {\n        try {\n            const docRef = doc(db, 'trials', id);\n            const docSnap = await getDoc(docRef);\n            if (docSnap.exists()) {\n                return { id: docSnap.id, ...docSnap.data() } as TrialSubmission;\n            }\n            return null;\n        } catch (e) {\n            console.error('Failed to get trial:', e);\n            return null;\n        }\n    },\n\n    /**\n     * Delete a submission\n     */\n    async deleteSubmission(id: string): Promise<boolean> {\n        try {\n            await deleteDoc(doc(db, 'trials', id));\n            return true;\n        } catch (e) {\n            console.error('Failed to delete trial:', e);\n            return false;\n        }\n    },\n\n    /**\n     * Save roadmap to a trial\n     */\n    async saveRoadmap(trialId: string, roadmap: Omit<RoadmapData, 'generatedAt'>): Promise<boolean> {\n        try {\n            await updateDoc(doc(db, 'trials', trialId), {\n                roadmap: {\n                    ...roadmap,\n                    generatedAt: Date.now()\n                }\n            });\n            return true;\n        } catch (e) {\n            console.error('Failed to save roadmap:', e);\n            return false;\n        }\n    },\n\n    /**\n     * Update simulation state\n     */\n    async updateSimulationState(\n        trialId: string,\n        state: SimulationState\n    ): Promise<boolean> {\n        try {\n            await updateDoc(doc(db, 'trials', trialId), {\n                simulationState: state,\n                status: 'in_progress'\n            });\n            return true;\n        } catch (e) {\n            console.error('Failed to update simulation state:', e);\n            return false;\n        }\n    }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5076, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/imageService.ts"],"sourcesContent":["/**\n * Image Service - AI-powered molecule image generation with Firebase Storage\n * Generates unique molecule visualizations and stores them persistently\n */\n\nimport { storage } from './firebase';\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\n\n// API Key for image generation (AI Guru Lab or similar)\nconst IMAGE_API_KEY = process.env.NEXT_PUBLIC_AI_GURU_LAB_API_KEY || '';\nconst GEMINI_API_KEY = process.env.NEXT_PUBLIC_GOOGLE_GENAI_API_KEY || '';\n\n// Molecule color palettes based on molecule type\nconst MOLECULE_COLORS: Record<string, string[]> = {\n    paracetamol: ['#4FC3F7', '#29B6F6', '#03A9F4', '#039BE5'],\n    aspirin: ['#81C784', '#66BB6A', '#4CAF50', '#43A047'],\n    ibuprofen: ['#FFB74D', '#FFA726', '#FF9800', '#FB8C00'],\n    caffeine: ['#BA68C8', '#AB47BC', '#9C27B0', '#8E24AA'],\n    default: ['#7C4DFF', '#651FFF', '#6200EA', '#536DFE']\n};\n\nexport interface GeneratedImage {\n    url: string;\n    generatedAt: number;\n    prompt: string;\n}\n\nexport const ImageService = {\n    /**\n     * Generate a molecule image using AI and upload to Firebase Storage\n     */\n    async generateMoleculeImage(\n        moleculeName: string,\n        trialId: string,\n        efficacy: number = 50,\n        safety: number = 50\n    ): Promise<GeneratedImage | null> {\n        try {\n            // Create a descriptive prompt for molecule visualization\n            const prompt = this.createMoleculePrompt(moleculeName, efficacy, safety);\n\n            // Try AI Guru Lab API first, then fallback to procedural\n            let imageBlob: Blob | null = null;\n\n            if (IMAGE_API_KEY && IMAGE_API_KEY.length > 10) {\n                try {\n                    imageBlob = await this.callAIGuruLabAPI(prompt);\n                } catch (apiError) {\n                    console.warn('AI Guru Lab API error, using procedural fallback');\n                    imageBlob = null;\n                }\n            }\n\n            // If AI API fails or not configured, generate procedural SVG\n            if (!imageBlob) {\n                console.log('Generating procedural molecule SVG for:', moleculeName);\n                imageBlob = await this.generateProceduralMolecule(moleculeName, efficacy, safety);\n            }\n\n            // Upload to Firebase Storage\n            let url = '';\n            try {\n                url = await this.uploadToFirebase(imageBlob, trialId);\n            } catch (uploadError: any) {\n                console.warn('Firebase Upload Failed:', uploadError.message);\n                // Fallback: Convert Blob to Base64 Data URI so image still shows up\n                if (imageBlob) {\n                    url = await new Promise<string>((resolve) => {\n                        const reader = new FileReader();\n                        reader.onloadend = () => resolve(reader.result as string);\n                        reader.readAsDataURL(imageBlob as Blob);\n                    });\n                }\n            }\n\n            return {\n                url,\n                generatedAt: Date.now(),\n                prompt\n            };\n        } catch (error) {\n            console.error('Failed to generate molecule image:', error);\n            return null;\n        }\n    },\n\n    /**\n     * Create a descriptive prompt for molecule image generation\n     */\n    createMoleculePrompt(moleculeName: string, efficacy: number, safety: number): string {\n        const quality = efficacy > 70 ? 'high-quality, well-structured' : 'experimental';\n        const stability = safety > 70 ? 'stable' : 'reactive';\n\n        return `Scientific 3D molecular structure visualization of ${moleculeName}, ${quality} ${stability} pharmaceutical compound, glowing atoms, dark background, neon blue and purple accents, professional medical illustration, high detail`;\n    },\n\n    /**\n     * Call AI Guru Lab API for image generation\n     */\n    async callAIGuruLabAPI(prompt: string): Promise<Blob | null> {\n        if (!IMAGE_API_KEY) return null;\n\n        try {\n            // AI Guru Lab API endpoint (adjust based on actual API documentation)\n            const response = await fetch('https://api.aigurulab.tech/api/generate-image', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'x-api-key': IMAGE_API_KEY\n                },\n                body: JSON.stringify({\n                    prompt: prompt,\n                    width: 512,\n                    height: 512,\n                    model: 'flux' // or another model\n                })\n            });\n\n            if (!response.ok) {\n                console.warn('AI Guru Lab API failed:', response.status);\n                return null;\n            }\n\n            const data = await response.json();\n\n            // Handle response based on format (base64 or URL)\n            if (data.image) {\n                // Base64 response\n                const base64Data = data.image.replace(/^data:image\\/\\w+;base64,/, '');\n                const binaryString = atob(base64Data);\n                const bytes = new Uint8Array(binaryString.length);\n                for (let i = 0; i < binaryString.length; i++) {\n                    bytes[i] = binaryString.charCodeAt(i);\n                }\n                return new Blob([bytes], { type: 'image/png' });\n            } else if (data.url) {\n                // URL response - fetch and convert to blob\n                const imageResponse = await fetch(data.url);\n                return await imageResponse.blob();\n            }\n\n            return null;\n        } catch (error) {\n            console.warn('AI Guru Lab API error:', error);\n            return null;\n        }\n    },\n\n    /**\n     * Generate a procedural molecule SVG (fallback when AI is unavailable)\n     */\n    async generateProceduralMolecule(\n        moleculeName: string,\n        efficacy: number,\n        safety: number\n    ): Promise<Blob> {\n        // Determine colors based on molecule type\n        const lowerName = moleculeName.toLowerCase();\n        let colors = MOLECULE_COLORS.default;\n        for (const [key, palette] of Object.entries(MOLECULE_COLORS)) {\n            if (lowerName.includes(key)) {\n                colors = palette;\n                break;\n            }\n        }\n\n        // Generate atom positions based on molecule \"hash\"\n        const seed = this.hashString(moleculeName + efficacy + safety);\n        const atoms = this.generateAtomPositions(seed, 6 + (efficacy % 5));\n        const bonds = this.generateBonds(atoms);\n\n        // Create SVG\n        const svg = `\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"512\" height=\"512\" viewBox=\"0 0 512 512\">\n                <defs>\n                    <radialGradient id=\"bg\" cx=\"50%\" cy=\"50%\" r=\"70%\">\n                        <stop offset=\"0%\" stop-color=\"#1a1a2e\"/>\n                        <stop offset=\"100%\" stop-color=\"#0a0a15\"/>\n                    </radialGradient>\n                    <filter id=\"glow\">\n                        <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\"/>\n                        <feMerge>\n                            <feMergeNode in=\"coloredBlur\"/>\n                            <feMergeNode in=\"SourceGraphic\"/>\n                        </feMerge>\n                    </filter>\n                    <radialGradient id=\"atom\" cx=\"30%\" cy=\"30%\" r=\"60%\">\n                        <stop offset=\"0%\" stop-color=\"${colors[0]}\"/>\n                        <stop offset=\"100%\" stop-color=\"${colors[2]}\"/>\n                    </radialGradient>\n                </defs>\n                <rect width=\"512\" height=\"512\" fill=\"url(#bg)\"/>\n                \n                <!-- Bonds -->\n                <g stroke=\"${colors[1]}\" stroke-width=\"3\" opacity=\"0.7\" filter=\"url(#glow)\">\n                    ${bonds.map(b => `<line x1=\"${b.x1}\" y1=\"${b.y1}\" x2=\"${b.x2}\" y2=\"${b.y2}\"/>`).join('\\n')}\n                </g>\n                \n                <!-- Atoms -->\n                <g filter=\"url(#glow)\">\n                    ${atoms.map((a, i) => `\n                        <circle cx=\"${a.x}\" cy=\"${a.y}\" r=\"${15 + (i % 3) * 5}\" fill=\"url(#atom)\"/>\n                        <circle cx=\"${a.x - 4}\" cy=\"${a.y - 4}\" r=\"${5 + (i % 2) * 2}\" fill=\"white\" opacity=\"0.3\"/>\n                    `).join('\\n')}\n                </g>\n                \n                <!-- Center glow effect -->\n                <circle cx=\"256\" cy=\"256\" r=\"100\" fill=\"none\" stroke=\"${colors[0]}\" stroke-width=\"1\" opacity=\"0.2\"/>\n                <circle cx=\"256\" cy=\"256\" r=\"150\" fill=\"none\" stroke=\"${colors[1]}\" stroke-width=\"0.5\" opacity=\"0.1\"/>\n            </svg>\n        `;\n\n        return new Blob([svg], { type: 'image/svg+xml' });\n    },\n\n    /**\n     * Upload image blob to Firebase Storage\n     */\n    async uploadToFirebase(blob: Blob, trialId: string): Promise<string> {\n        const extension = blob.type.includes('svg') ? 'svg' : 'png';\n        const storageRef = ref(storage, `molecules/${trialId}.${extension}`);\n\n        await uploadBytes(storageRef, blob);\n        const downloadUrl = await getDownloadURL(storageRef);\n\n        return downloadUrl;\n    },\n\n    /**\n     * Get existing molecule image URL from storage\n     */\n    async getMoleculeImageUrl(trialId: string): Promise<string | null> {\n        try {\n            // Try PNG first, then SVG\n            const pngRef = ref(storage, `molecules/${trialId}.png`);\n            try {\n                return await getDownloadURL(pngRef);\n            } catch {\n                const svgRef = ref(storage, `molecules/${trialId}.svg`);\n                return await getDownloadURL(svgRef);\n            }\n        } catch {\n            return null;\n        }\n    },\n\n    // Helper: Simple string hash for deterministic generation\n    hashString(str: string): number {\n        let hash = 0;\n        for (let i = 0; i < str.length; i++) {\n            const char = str.charCodeAt(i);\n            hash = ((hash << 5) - hash) + char;\n            hash = hash & hash;\n        }\n        return Math.abs(hash);\n    },\n\n    // Helper: Generate atom positions in a somewhat structured way\n    generateAtomPositions(seed: number, count: number): Array<{ x: number, y: number }> {\n        const atoms: Array<{ x: number, y: number }> = [];\n        const centerX = 256, centerY = 256;\n\n        for (let i = 0; i < count; i++) {\n            const angle = ((seed + i * 137.5) % 360) * (Math.PI / 180);\n            const radius = 60 + ((seed * (i + 1)) % 120);\n            atoms.push({\n                x: centerX + Math.cos(angle) * radius,\n                y: centerY + Math.sin(angle) * radius\n            });\n        }\n\n        return atoms;\n    },\n\n    // Helper: Generate bonds between nearby atoms\n    generateBonds(atoms: Array<{ x: number, y: number }>): Array<{ x1: number, y1: number, x2: number, y2: number }> {\n        const bonds: Array<{ x1: number, y1: number, x2: number, y2: number }> = [];\n\n        for (let i = 0; i < atoms.length; i++) {\n            // Connect to next atom (ring structure)\n            const j = (i + 1) % atoms.length;\n            bonds.push({\n                x1: atoms[i].x, y1: atoms[i].y,\n                x2: atoms[j].x, y2: atoms[j].y\n            });\n\n            // Connect some atoms to center for structure\n            if (i % 2 === 0) {\n                bonds.push({\n                    x1: atoms[i].x, y1: atoms[i].y,\n                    x2: 256, y2: 256\n                });\n            }\n        }\n\n        return bonds;\n    }\n};\n"],"names":[],"mappings":";;;;AAAA;;;CAGC,GAED;AACA;AAAA;;;AAEA,wDAAwD;AACxD,MAAM,gBAAgB,4EAA+C;AACrE,MAAM,iBAAiB,+EAAgD;AAEvE,iDAAiD;AACjD,MAAM,kBAA4C;IAC9C,aAAa;QAAC;QAAW;QAAW;QAAW;KAAU;IACzD,SAAS;QAAC;QAAW;QAAW;QAAW;KAAU;IACrD,WAAW;QAAC;QAAW;QAAW;QAAW;KAAU;IACvD,UAAU;QAAC;QAAW;QAAW;QAAW;KAAU;IACtD,SAAS;QAAC;QAAW;QAAW;QAAW;KAAU;AACzD;AAQO,MAAM,eAAe;IACxB;;KAEC,GACD,MAAM,uBACF,YAAoB,EACpB,OAAe,EACf,WAAmB,EAAE,EACrB,SAAiB,EAAE;QAEnB,IAAI;YACA,yDAAyD;YACzD,MAAM,SAAS,IAAI,CAAC,oBAAoB,CAAC,cAAc,UAAU;YAEjE,yDAAyD;YACzD,IAAI,YAAyB;YAE7B,IAAI,iBAAiB,cAAc,MAAM,GAAG,IAAI;gBAC5C,IAAI;oBACA,YAAY,MAAM,IAAI,CAAC,gBAAgB,CAAC;gBAC5C,EAAE,OAAO,UAAU;oBACf,QAAQ,IAAI,CAAC;oBACb,YAAY;gBAChB;YACJ;YAEA,6DAA6D;YAC7D,IAAI,CAAC,WAAW;gBACZ,QAAQ,GAAG,CAAC,2CAA2C;gBACvD,YAAY,MAAM,IAAI,CAAC,0BAA0B,CAAC,cAAc,UAAU;YAC9E;YAEA,6BAA6B;YAC7B,IAAI,MAAM;YACV,IAAI;gBACA,MAAM,MAAM,IAAI,CAAC,gBAAgB,CAAC,WAAW;YACjD,EAAE,OAAO,aAAkB;gBACvB,QAAQ,IAAI,CAAC,2BAA2B,YAAY,OAAO;gBAC3D,oEAAoE;gBACpE,IAAI,WAAW;oBACX,MAAM,MAAM,IAAI,QAAgB,CAAC;wBAC7B,MAAM,SAAS,IAAI;wBACnB,OAAO,SAAS,GAAG,IAAM,QAAQ,OAAO,MAAM;wBAC9C,OAAO,aAAa,CAAC;oBACzB;gBACJ;YACJ;YAEA,OAAO;gBACH;gBACA,aAAa,KAAK,GAAG;gBACrB;YACJ;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,sCAAsC;YACpD,OAAO;QACX;IACJ;IAEA;;KAEC,GACD,sBAAqB,YAAoB,EAAE,QAAgB,EAAE,MAAc;QACvE,MAAM,UAAU,WAAW,KAAK,kCAAkC;QAClE,MAAM,YAAY,SAAS,KAAK,WAAW;QAE3C,OAAO,CAAC,mDAAmD,EAAE,aAAa,EAAE,EAAE,QAAQ,CAAC,EAAE,UAAU,sIAAsI,CAAC;IAC9O;IAEA;;KAEC,GACD,MAAM,kBAAiB,MAAc;QACjC;;QAEA,IAAI;YACA,sEAAsE;YACtE,MAAM,WAAW,MAAM,MAAM,iDAAiD;gBAC1E,QAAQ;gBACR,SAAS;oBACL,gBAAgB;oBAChB,aAAa;gBACjB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACjB,QAAQ;oBACR,OAAO;oBACP,QAAQ;oBACR,OAAO,OAAO,mBAAmB;gBACrC;YACJ;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBACd,QAAQ,IAAI,CAAC,2BAA2B,SAAS,MAAM;gBACvD,OAAO;YACX;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,kDAAkD;YAClD,IAAI,KAAK,KAAK,EAAE;gBACZ,kBAAkB;gBAClB,MAAM,aAAa,KAAK,KAAK,CAAC,OAAO,CAAC,4BAA4B;gBAClE,MAAM,eAAe,KAAK;gBAC1B,MAAM,QAAQ,IAAI,WAAW,aAAa,MAAM;gBAChD,IAAK,IAAI,IAAI,GAAG,IAAI,aAAa,MAAM,EAAE,IAAK;oBAC1C,KAAK,CAAC,EAAE,GAAG,aAAa,UAAU,CAAC;gBACvC;gBACA,OAAO,IAAI,KAAK;oBAAC;iBAAM,EAAE;oBAAE,MAAM;gBAAY;YACjD,OAAO,IAAI,KAAK,GAAG,EAAE;gBACjB,2CAA2C;gBAC3C,MAAM,gBAAgB,MAAM,MAAM,KAAK,GAAG;gBAC1C,OAAO,MAAM,cAAc,IAAI;YACnC;YAEA,OAAO;QACX,EAAE,OAAO,OAAO;YACZ,QAAQ,IAAI,CAAC,0BAA0B;YACvC,OAAO;QACX;IACJ;IAEA;;KAEC,GACD,MAAM,4BACF,YAAoB,EACpB,QAAgB,EAChB,MAAc;QAEd,0CAA0C;QAC1C,MAAM,YAAY,aAAa,WAAW;QAC1C,IAAI,SAAS,gBAAgB,OAAO;QACpC,KAAK,MAAM,CAAC,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,iBAAkB;YAC1D,IAAI,UAAU,QAAQ,CAAC,MAAM;gBACzB,SAAS;gBACT;YACJ;QACJ;QAEA,mDAAmD;QACnD,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC,eAAe,WAAW;QACvD,MAAM,QAAQ,IAAI,CAAC,qBAAqB,CAAC,MAAM,IAAK,WAAW;QAC/D,MAAM,QAAQ,IAAI,CAAC,aAAa,CAAC;QAEjC,aAAa;QACb,MAAM,MAAM,CAAC;;;;;;;;;;;;;;;sDAeiC,EAAE,MAAM,CAAC,EAAE,CAAC;wDACV,EAAE,MAAM,CAAC,EAAE,CAAC;;;;;;2BAMzC,EAAE,MAAM,CAAC,EAAE,CAAC;oBACnB,EAAE,MAAM,GAAG,CAAC,CAAA,IAAK,CAAC,UAAU,EAAE,EAAE,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,MAAM;;;;;oBAK3F,EAAE,MAAM,GAAG,CAAC,CAAC,GAAG,IAAM,CAAC;oCACP,EAAE,EAAE,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,KAAK,EAAE,KAAK,AAAC,IAAI,IAAK,EAAE;oCAC1C,EAAE,EAAE,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,AAAC,IAAI,IAAK,EAAE;oBACjE,CAAC,EAAE,IAAI,CAAC,MAAM;;;;sEAIoC,EAAE,MAAM,CAAC,EAAE,CAAC;sEACZ,EAAE,MAAM,CAAC,EAAE,CAAC;;QAE1E,CAAC;QAED,OAAO,IAAI,KAAK;YAAC;SAAI,EAAE;YAAE,MAAM;QAAgB;IACnD;IAEA;;KAEC,GACD,MAAM,kBAAiB,IAAU,EAAE,OAAe;QAC9C,MAAM,YAAY,KAAK,IAAI,CAAC,QAAQ,CAAC,SAAS,QAAQ;QACtD,MAAM,aAAa,IAAA,2LAAG,EAAC,iIAAO,EAAE,CAAC,UAAU,EAAE,QAAQ,CAAC,EAAE,WAAW;QAEnE,MAAM,IAAA,mMAAW,EAAC,YAAY;QAC9B,MAAM,cAAc,MAAM,IAAA,sMAAc,EAAC;QAEzC,OAAO;IACX;IAEA;;KAEC,GACD,MAAM,qBAAoB,OAAe;QACrC,IAAI;YACA,0BAA0B;YAC1B,MAAM,SAAS,IAAA,2LAAG,EAAC,iIAAO,EAAE,CAAC,UAAU,EAAE,QAAQ,IAAI,CAAC;YACtD,IAAI;gBACA,OAAO,MAAM,IAAA,sMAAc,EAAC;YAChC,EAAE,OAAM;gBACJ,MAAM,SAAS,IAAA,2LAAG,EAAC,iIAAO,EAAE,CAAC,UAAU,EAAE,QAAQ,IAAI,CAAC;gBACtD,OAAO,MAAM,IAAA,sMAAc,EAAC;YAChC;QACJ,EAAE,OAAM;YACJ,OAAO;QACX;IACJ;IAEA,0DAA0D;IAC1D,YAAW,GAAW;QAClB,IAAI,OAAO;QACX,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,MAAM,EAAE,IAAK;YACjC,MAAM,OAAO,IAAI,UAAU,CAAC;YAC5B,OAAO,AAAC,CAAC,QAAQ,CAAC,IAAI,OAAQ;YAC9B,OAAO,OAAO;QAClB;QACA,OAAO,KAAK,GAAG,CAAC;IACpB;IAEA,+DAA+D;IAC/D,uBAAsB,IAAY,EAAE,KAAa;QAC7C,MAAM,QAAyC,EAAE;QACjD,MAAM,UAAU,KAAK,UAAU;QAE/B,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,IAAK;YAC5B,MAAM,QAAQ,AAAC,CAAC,OAAO,IAAI,KAAK,IAAI,MAAO,CAAC,KAAK,EAAE,GAAG,GAAG;YACzD,MAAM,SAAS,KAAM,AAAC,OAAO,CAAC,IAAI,CAAC,IAAK;YACxC,MAAM,IAAI,CAAC;gBACP,GAAG,UAAU,KAAK,GAAG,CAAC,SAAS;gBAC/B,GAAG,UAAU,KAAK,GAAG,CAAC,SAAS;YACnC;QACJ;QAEA,OAAO;IACX;IAEA,8CAA8C;IAC9C,eAAc,KAAsC;QAChD,MAAM,QAAmE,EAAE;QAE3E,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;YACnC,wCAAwC;YACxC,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,MAAM,MAAM;YAChC,MAAM,IAAI,CAAC;gBACP,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;gBAAE,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;gBAC9B,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;gBAAE,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;YAClC;YAEA,6CAA6C;YAC7C,IAAI,IAAI,MAAM,GAAG;gBACb,MAAM,IAAI,CAAC;oBACP,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;oBAAE,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;oBAC9B,IAAI;oBAAK,IAAI;gBACjB;YACJ;QACJ;QAEA,OAAO;IACX;AACJ"}},
    {"offset": {"line": 5368, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/components/builder/Builder.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport View3D from './View3D';\nimport { Atom, Bond, PeriodicTable } from '@/lib/chemistry';\nimport { SYLLABUS_DATA, SyllabusLevel } from '@/lib/syllabusData';\nimport { AiService } from '@/lib/aiService';\nimport * as THREE from 'three';\nimport { validateMolecule, ValidationResult } from '@/lib/validation';\nimport { parseSmiles, SMILES_EXAMPLES } from '@/lib/smilesParser';\nimport styles from './Builder.module.css';\nimport { useAuth } from '@/context/AuthContext';\nimport { UserService } from '@/lib/userService';\nimport MissionSelector from './MissionSelector';\nimport ChemistryReference from './ChemistryReference';\nimport { useRouter } from 'next/navigation';\nimport { TrialService } from '@/lib/trialService';\nimport { ImageService } from '@/lib/imageService';\n\nexport default function Builder() {\n    const [atoms, setAtoms] = useState<Atom[]>([]);\n    const [bonds, setBonds] = useState<Bond[]>([]);\n    const [selectedElement, setSelectedElement] = useState<string>('C');\n    const [mode, setMode] = useState<'build' | 'delete' | 'bond'>('build');\n    const [message, setMessage] = useState<string>('Select an element and click on the canvas.');\n    const [bondingSource, setBondingSource] = useState<number | null>(null);\n\n    // Properties State\n    const [properties, setProperties] = useState({\n        stability: 0,\n        efficacy: 0,\n        toxicity: 'Low'\n    });\n\n    const { user, refreshProfile, profile } = useAuth();\n    const [submitting, setSubmitting] = useState(false);\n\n    // --- Syllabus & AI State ---\n    const [currentMission, setCurrentMission] = useState<SyllabusLevel>(SYLLABUS_DATA[0]);\n    const [aiFeedback, setAiFeedback] = useState<{ analysis: string; efficacy: number; safety: number; feedback: string } | null>(null);\n    const [analyzing, setAnalyzing] = useState(false);\n    const [validationResult, setValidationResult] = useState<ValidationResult | null>(null);\n    const [missionLoaded, setMissionLoaded] = useState(false);\n\n    // --- SMILES Input State ---\n    const [smilesInput, setSmilesInput] = useState('');\n    const [showSmilesInput, setShowSmilesInput] = useState(false);\n    const [smilesError, setSmilesError] = useState<string | null>(null);\n\n    // --- Chemistry Reference State ---\n    const [showReference, setShowReference] = useState(false);\n\n    // Helper: Load a mission template\n    const loadMission = useCallback((mission: SyllabusLevel) => {\n        setCurrentMission(mission);\n\n        // Load atoms from template\n        const templateAtoms = mission.moleculeTemplate.atoms.map(a => ({\n            id: a.id,\n            element: a.element,\n            x: a.position[0],\n            y: a.position[1],\n            z: a.position[2]\n        }));\n\n        // Reconstruct bonds with proper bond order\n        const templateBonds: Bond[] = [];\n        let bondIdCounter = Date.now();\n        mission.moleculeTemplate.bonds.forEach(b => {\n            const sourceAtom = templateAtoms.find(a => a.id === b.source);\n            const targetAtom = templateAtoms.find(a => a.id === b.target);\n            if (sourceAtom && targetAtom) {\n                templateBonds.push({\n                    id: bondIdCounter++,\n                    sourceId: sourceAtom.id,\n                    targetId: targetAtom.id,\n                    order: b.order || 1 // Use template bond order\n                });\n            }\n        });\n\n        setAtoms(templateAtoms);\n        setBonds(templateBonds);\n        setAiFeedback(null);\n        updateProperties(templateAtoms, templateBonds);\n        setMessage(`Loaded Mission: ${mission.title}`);\n    }, []);\n\n    // Initial Load: Check User Level and Load Highest Unlocked Template\n    useEffect(() => {\n        if (profile && !missionLoaded) {\n            const userLevel = Math.min(profile.level || 1, 8);\n            const mission = SYLLABUS_DATA.find(s => s.level === userLevel) || SYLLABUS_DATA[0];\n            loadMission(mission);\n            setMissionLoaded(true);\n        }\n    }, [profile, missionLoaded, loadMission]);\n\n    // Run validation whenever atoms/bonds change\n    useEffect(() => {\n        if (atoms.length > 0) {\n            const result = validateMolecule(atoms, bonds);\n            setValidationResult(result);\n        } else {\n            setValidationResult(null);\n        }\n    }, [atoms, bonds]);\n\n\n    const handleEmptyClick = (position: THREE.Vector3) => {\n        if (mode === 'build') {\n            const newAtom: Atom = {\n                id: Date.now(),\n                element: selectedElement,\n                x: position.x,\n                y: position.y,\n                z: position.z\n            };\n\n            const newBonds: Bond[] = [];\n            let bondIdCounter = Date.now();\n\n            atoms.forEach(atom => {\n                const dist = new THREE.Vector3(atom.x, atom.y, atom.z).distanceTo(position);\n                if (dist < 2.0) {\n                    newBonds.push({\n                        id: bondIdCounter++,\n                        sourceId: atom.id,\n                        targetId: newAtom.id,\n                        order: 1\n                    });\n                }\n            });\n\n            const updatedAtoms = [...atoms, newAtom];\n            const updatedBonds = [...bonds, ...newBonds];\n\n            setAtoms(updatedAtoms);\n            setBonds(updatedBonds);\n            updateProperties(updatedAtoms, updatedBonds);\n            setMessage(`Added ${PeriodicTable[selectedElement].name}`);\n        }\n    };\n\n    const handleAtomClick = (id: number) => {\n        if (mode === 'delete') {\n            const updatedAtoms = atoms.filter(a => a.id !== id);\n            const updatedBonds = bonds.filter(b => b.sourceId !== id && b.targetId !== id);\n            setAtoms(updatedAtoms);\n            setBonds(updatedBonds);\n            updateProperties(updatedAtoms, updatedBonds);\n            setMessage('Atom deleted');\n        } else if (mode === 'bond') {\n            // Bonding mode: click two atoms to connect them\n            if (bondingSource === null) {\n                setBondingSource(id);\n                setMessage(`Bonding: Selected first atom (ID: ${id}). Click another atom to connect.`);\n            } else if (bondingSource !== id) {\n                // Check if bond already exists\n                const exists = bonds.some(b =>\n                    (b.sourceId === bondingSource && b.targetId === id) ||\n                    (b.sourceId === id && b.targetId === bondingSource)\n                );\n                if (!exists) {\n                    const newBond: Bond = {\n                        id: Date.now(),\n                        sourceId: bondingSource,\n                        targetId: id,\n                        order: 1\n                    };\n                    const updatedBonds = [...bonds, newBond];\n                    setBonds(updatedBonds);\n                    updateProperties(atoms, updatedBonds);\n                    setMessage(`Bond created between atoms!`);\n                } else {\n                    setMessage('Bond already exists between these atoms.');\n                }\n                setBondingSource(null);\n            } else {\n                setBondingSource(null);\n                setMessage('Bonding cancelled.');\n            }\n        } else {\n            // Build mode: clicking atom does nothing (only empty space adds atoms)\n            const atom = atoms.find(a => a.id === id);\n            if (atom) {\n                const el = PeriodicTable[atom.element];\n                setMessage(`${el?.name || atom.element} atom selected`);\n            }\n        }\n    };\n\n    const updateProperties = (currentAtoms: Atom[], currentBonds: Bond[]) => {\n        const result = validateMolecule(currentAtoms, currentBonds);\n        if (result.valid) {\n            setProperties({\n                stability: Math.min(100, 50 + result.score),\n                efficacy: Math.min(100, 20 + result.score * 0.5),\n                toxicity: 'Low'\n            });\n        } else {\n            setProperties({\n                stability: Math.max(0, 30 - currentAtoms.length * 2),\n                efficacy: 0,\n                toxicity: 'High'\n            });\n        }\n    };\n\n    const handleReset = () => {\n        loadMission(currentMission);\n        setMessage('Template reset to initial state.');\n    };\n\n    const handleAIAnalysis = async () => {\n        setAnalyzing(true);\n        try {\n            const result = await AiService.analyzeMolecule(\n                currentMission.moleculeTemplate.name,\n                atoms.length,\n                \"User modified the structure.\"\n            );\n            setAiFeedback(result);\n            setMessage(\"AI analysis complete!\");\n        } catch (error) {\n            console.error(\"AI Analysis error:\", error);\n            setMessage(\"Error during AI analysis.\");\n        } finally {\n            setAnalyzing(false);\n        }\n    };\n\n    const router = useRouter();\n\n    const handleSubmit = async () => {\n        if (submitting || !user) return;\n        setSubmitting(true);\n\n        try {\n            const score = aiFeedback ? Math.floor((aiFeedback.efficacy + aiFeedback.safety) / 2) : 50;\n            const xpAwarded = score * 2;\n\n            await UserService.addXP(user.uid, xpAwarded);\n            await UserService.updateQuestProgress(user.uid, 'build_molecule', 1);\n\n            // Save trial data for the Clinical Trials phase using TrialService (Firebase)\n            const submission = await TrialService.saveSubmission(user.uid, {\n                moleculeName: currentMission.moleculeTemplate.name + \" (Modified)\",\n                missionId: currentMission.level,\n                missionTitle: currentMission.title,\n                atomCount: atoms.length,\n                stats: {\n                    efficacy: aiFeedback?.efficacy || properties.efficacy,\n                    safety: aiFeedback?.safety || (properties.toxicity === 'Low' ? 80 : 40),\n                    stability: properties.stability\n                },\n                aiAnalysis: aiFeedback?.analysis,\n                imageUrl: AiService.generateMoleculeImageUrl(currentMission.moleculeTemplate.name)\n            });\n\n            // Generate AI molecule image and save to Firebase Storage\n            setMessage('Generating molecule visualization...');\n            const generatedImage = await ImageService.generateMoleculeImage(\n                currentMission.moleculeTemplate.name,\n                submission.id,\n                aiFeedback?.efficacy || properties.efficacy,\n                aiFeedback?.safety || 50\n            );\n\n            // Update trial with generated image URL\n            if (generatedImage) {\n                await TrialService.updateSubmission(submission.id, {\n                    generatedImageUrl: generatedImage.url\n                });\n            }\n\n            // Save trial ID to localStorage for quick access\n            localStorage.setItem('active_trial_id', submission.id);\n\n            if (atoms.length >= 5) {\n                await UserService.unlockAchievement(user.uid, {\n                    id: 'first_complex',\n                    title: 'Molecular Architect',\n                    description: 'Built a molecule with 5+ atoms',\n                    icon: 'ðŸ§¬'\n                });\n            }\n\n            await refreshProfile();\n            setMessage(`SUCCESS: Design Submitted! Redirecting to Clinical Trials...`);\n\n            // Short delay then redirect\n            setTimeout(() => {\n                router.push('/dashboard/clinical-trials');\n            }, 1500);\n\n        } catch (error) {\n            console.error(error);\n            setMessage('Error submitting design');\n        } finally {\n            setSubmitting(false);\n        }\n    };\n\n    // --- SMILES Parsing Handler ---\n    const handleSmilesLoad = () => {\n        if (!smilesInput.trim()) {\n            setSmilesError('Please enter a SMILES string');\n            return;\n        }\n\n        const result = parseSmiles(smilesInput.trim());\n\n        if (!result.success) {\n            setSmilesError(result.error || 'Failed to parse SMILES');\n            return;\n        }\n\n        // Successfully parsed - load into builder\n        setAtoms(result.atoms);\n        setBonds(result.bonds);\n        setSmilesError(null);\n        setShowSmilesInput(false);\n        setSmilesInput('');\n        setAiFeedback(null);\n        updateProperties(result.atoms, result.bonds);\n        setMessage(`Loaded molecule from SMILES: ${smilesInput.trim()}`);\n    };\n\n    const handleSmilesExample = (smiles: string, name: string) => {\n        const result = parseSmiles(smiles);\n\n        if (result.success) {\n            setAtoms(result.atoms);\n            setBonds(result.bonds);\n            setSmilesError(null);\n            setShowSmilesInput(false);\n            setAiFeedback(null);\n            updateProperties(result.atoms, result.bonds);\n            setMessage(`Loaded ${name} from SMILES`);\n        } else {\n            setSmilesError(result.error || 'Failed to parse example');\n        }\n    };\n\n    const elementList = ['C', 'O', 'N', 'H', 'S', 'P', 'F', 'Cl', 'Br'];\n\n    return (\n        <div className={styles.container}>\n            <div className={styles.sidebar}>\n                {/* Mission Selector Component */}\n                {profile && (\n                    <MissionSelector\n                        userLevel={profile.level || 1}\n                        currentMissionId={currentMission.level}\n                        onSelectMission={loadMission}\n                    />\n                )}\n\n                <div className={styles.header}>\n                    <h2><span style={{ color: '#60a5fa' }}>LABORATORY:</span> {currentMission.title}</h2>\n                    <p style={{ fontSize: '0.8rem', color: '#9ca3af', marginTop: '4px' }}>{currentMission.description}</p>\n                </div>\n\n                <div className={styles.elementList}>\n                    <h3>Elements</h3>\n                    <div className={styles.elementsGrid}>\n                        {elementList.map(symbol => {\n                            const el = PeriodicTable[symbol];\n                            if (!el) return null;\n                            const isSelected = selectedElement === symbol && mode === 'build';\n                            const colorHex = '#' + el.color.toString(16).padStart(6, '0');\n                            return (\n                                <div\n                                    key={symbol}\n                                    className={`${styles.elementCard} ${isSelected ? styles.selected : ''}`}\n                                    onClick={() => { setSelectedElement(symbol); setMode('build'); setBondingSource(null); }}\n                                    style={{\n                                        borderColor: isSelected ? colorHex : undefined,\n                                        boxShadow: isSelected ? `0 0 12px ${colorHex}40` : undefined\n                                    }}\n                                >\n                                    <div style={{\n                                        width: '24px',\n                                        height: '24px',\n                                        borderRadius: '50%',\n                                        background: colorHex,\n                                        marginBottom: '4px',\n                                        boxShadow: `inset 0 -3px 6px rgba(0,0,0,0.3), 0 0 8px ${colorHex}50`\n                                    }} />\n                                    <b style={{ fontSize: '0.9rem' }}>{symbol}</b>\n                                    <small>{el.name}</small>\n                                </div>\n                            );\n                        })}\n                    </div>\n                </div>\n\n                <div className={styles.controls}>\n                    <div style={{ display: 'flex', gap: '8px' }}>\n                        <button\n                            className={`${styles.btn} ${mode === 'delete' ? styles.active : ''}`}\n                            onClick={() => { setMode(mode === 'delete' ? 'build' : 'delete'); setBondingSource(null); }}\n                            style={{ flex: 1 }}\n                        >\n                            ðŸ—‘ï¸ Eraser\n                        </button>\n                        <button\n                            className={`${styles.btn} ${mode === 'bond' ? styles.active : ''}`}\n                            onClick={() => { setMode(mode === 'bond' ? 'build' : 'bond'); setBondingSource(null); }}\n                            style={{ flex: 1, background: mode === 'bond' ? '#7c3aed' : undefined }}\n                        >\n                            ðŸ”— Bond\n                        </button>\n                    </div>\n                    <button className={styles.btn} onClick={handleReset}>â†º Reset Template</button>\n\n                    {/* SMILES Input Toggle */}\n                    <button\n                        className={`${styles.btn} ${showSmilesInput ? styles.active : ''}`}\n                        onClick={() => setShowSmilesInput(!showSmilesInput)}\n                        style={{ background: showSmilesInput ? '#0ea5e9' : undefined }}\n                    >\n                        ðŸ“ SMILES Input\n                    </button>\n\n                    {/* SMILES Input Panel */}\n                    {showSmilesInput && (\n                        <div style={{\n                            background: 'rgba(15, 23, 42, 0.9)',\n                            border: '1px solid rgba(14, 165, 233, 0.4)',\n                            borderRadius: '10px',\n                            padding: '12px',\n                            marginTop: '4px'\n                        }}>\n                            <div style={{ marginBottom: '8px', fontSize: '0.75rem', color: '#94a3b8' }}>\n                                Enter SMILES notation:\n                            </div>\n                            <input\n                                type=\"text\"\n                                value={smilesInput}\n                                onChange={(e) => { setSmilesInput(e.target.value); setSmilesError(null); }}\n                                placeholder=\"e.g., CCO (ethanol)\"\n                                style={{\n                                    width: '100%',\n                                    padding: '10px 12px',\n                                    background: 'rgba(30, 41, 59, 0.8)',\n                                    border: smilesError ? '1px solid #ef4444' : '1px solid rgba(148, 163, 184, 0.3)',\n                                    borderRadius: '8px',\n                                    color: '#e2e8f0',\n                                    fontSize: '0.9rem',\n                                    fontFamily: 'monospace',\n                                    marginBottom: '8px'\n                                }}\n                                onKeyDown={(e) => e.key === 'Enter' && handleSmilesLoad()}\n                            />\n                            {smilesError && (\n                                <div style={{ color: '#ef4444', fontSize: '0.75rem', marginBottom: '8px' }}>\n                                    âš ï¸ {smilesError}\n                                </div>\n                            )}\n                            <button\n                                className={`${styles.btn}`}\n                                onClick={handleSmilesLoad}\n                                style={{ width: '100%', marginBottom: '8px', background: '#0ea5e9' }}\n                            >\n                                ðŸ§¬ Generate Structure\n                            </button>\n\n                            {/* Quick Examples */}\n                            <div style={{ fontSize: '0.7rem', color: '#64748b', marginBottom: '6px' }}>Quick Examples:</div>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>\n                                {SMILES_EXAMPLES.slice(0, 8).map((ex) => (\n                                    <button\n                                        key={ex.name}\n                                        onClick={() => handleSmilesExample(ex.smiles, ex.name)}\n                                        style={{\n                                            padding: '4px 8px',\n                                            fontSize: '0.65rem',\n                                            background: 'rgba(59, 130, 246, 0.2)',\n                                            border: '1px solid rgba(59, 130, 246, 0.3)',\n                                            borderRadius: '4px',\n                                            color: '#60a5fa',\n                                            cursor: 'pointer'\n                                        }}\n                                        title={ex.smiles}\n                                    >\n                                        {ex.name}\n                                    </button>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n\n                    <button className={`${styles.btn} ${styles.btnPrimary}`} onClick={handleAIAnalysis} disabled={analyzing}>\n                        {analyzing ? 'ðŸ¤– Analyzing...' : 'ðŸ§  AI Analysis'}\n                    </button>\n\n                    {/* Chemistry Reference Button */}\n                    <button\n                        className={styles.btn}\n                        onClick={() => setShowReference(true)}\n                        style={{ background: 'rgba(139, 92, 246, 0.3)', borderColor: '#8b5cf6' }}\n                    >\n                        ðŸ“š Chemistry Reference\n                    </button>\n                </div>\n\n                {aiFeedback && (\n                    <div className={styles.aiFeedback}>\n                        <h4>AI Analysis Report</h4>\n                        <p>{aiFeedback.analysis}</p>\n                        <div className={styles.feedbackStats}>\n                            <div>Eff: {Math.round(aiFeedback.efficacy)}%</div>\n                            <div>Saf: {Math.round(aiFeedback.safety)}%</div>\n                        </div>\n                    </div>\n                )}\n\n                <button\n                    className={`${styles.btn} ${styles.btnSuccess}`}\n                    onClick={handleSubmit}\n                    disabled={submitting || !aiFeedback}\n                    style={{ marginTop: 'auto' }}\n                >\n                    {submitting ? 'Submitting...' : 'ðŸš€ Submit for Trials'}\n                </button>\n            </div>\n\n            <div className={styles.canvasArea}>\n                <div className={styles.canvasHeader}>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px', flexWrap: 'wrap' }}>\n                        <div className={styles.statusMsg}>{message}</div>\n                        {validationResult && (\n                            <div style={{\n                                display: 'flex',\n                                alignItems: 'center',\n                                gap: '8px',\n                                padding: '4px 10px',\n                                borderRadius: '6px',\n                                fontSize: '0.75rem',\n                                fontWeight: 600,\n                                background: validationResult.valid ? 'rgba(16, 185, 129, 0.2)' : 'rgba(239, 68, 68, 0.2)',\n                                border: `1px solid ${validationResult.valid ? '#10b981' : '#ef4444'}`,\n                                color: validationResult.valid ? '#10b981' : '#ef4444'\n                            }}>\n                                {validationResult.valid ? 'âœ“ Valid' : 'âœ— Invalid'}\n                                {validationResult.name && (\n                                    <span style={{ color: '#60a5fa', marginLeft: '4px' }}>â€¢ {validationResult.name}</span>\n                                )}\n                            </div>\n                        )}\n                        {/* Formula & MW Badge */}\n                        {validationResult?.formula && (\n                            <div style={{\n                                padding: '4px 10px',\n                                borderRadius: '6px',\n                                fontSize: '0.75rem',\n                                fontWeight: 600,\n                                background: 'rgba(96, 165, 250, 0.15)',\n                                border: '1px solid rgba(96, 165, 250, 0.4)',\n                                color: '#60a5fa'\n                            }}>\n                                {validationResult.formula} â€¢ {validationResult.molecularWeight} g/mol\n                            </div>\n                        )}\n                    </div>\n                    <div className={styles.propTags}>\n                        {validationResult?.properties?.complexity !== undefined && (\n                            <span className={styles.tag} style={{ color: '#a78bfa' }}>\n                                Complexity: {validationResult.properties.complexity}%\n                            </span>\n                        )}\n                        <span className={styles.tag}>Stab: {Math.round(properties.stability)}%</span>\n                        <span className={styles.tag}>Eff: {Math.round(properties.efficacy)}%</span>\n                        <span className={styles.tag} style={{ color: properties.toxicity === 'Low' ? '#10b981' : '#ef4444' }}>\n                            Tox: {properties.toxicity}\n                        </span>\n                    </div>\n                </div>\n\n                {/* Functional Groups Panel (Top Right) */}\n                {validationResult?.functionalGroups && validationResult.functionalGroups.length > 0 && (\n                    <div style={{\n                        position: 'absolute',\n                        top: '60px',\n                        right: '16px',\n                        background: 'rgba(30, 41, 59, 0.95)',\n                        border: '1px solid rgba(148, 163, 184, 0.2)',\n                        borderRadius: '10px',\n                        padding: '12px',\n                        zIndex: 10,\n                        maxWidth: '220px',\n                        fontSize: '0.75rem',\n                        backdropFilter: 'blur(8px)'\n                    }}>\n                        <div style={{ fontWeight: 700, marginBottom: '8px', color: '#94a3b8', textTransform: 'uppercase', letterSpacing: '0.5px' }}>\n                            Functional Groups\n                        </div>\n                        {validationResult.functionalGroups.map((fg, i) => (\n                            <div key={i} style={{ marginBottom: '4px', color: '#e2e8f0' }}>{fg}</div>\n                        ))}\n                    </div>\n                )}\n\n                {/* Validation Info Panel (Bottom Left) */}\n                {validationResult && (validationResult.errors.length > 0 || validationResult.warnings.length > 0) && (\n                    <div style={{\n                        position: 'absolute',\n                        bottom: '16px',\n                        left: '16px',\n                        background: validationResult.valid\n                            ? 'rgba(30, 58, 95, 0.95)'\n                            : 'rgba(127, 29, 29, 0.9)',\n                        border: `1px solid ${validationResult.valid ? 'rgba(96, 165, 250, 0.4)' : 'rgba(239, 68, 68, 0.4)'}`,\n                        borderRadius: '10px',\n                        padding: '12px',\n                        zIndex: 10,\n                        maxWidth: '380px',\n                        fontSize: '0.75rem',\n                        backdropFilter: 'blur(8px)'\n                    }}>\n                        {/* Errors */}\n                        {!validationResult.valid && validationResult.errors.length > 0 && (\n                            <>\n                                <div style={{ fontWeight: 700, marginBottom: '6px', color: '#ef4444' }}>âš ï¸ Valence Issues:</div>\n                                {validationResult.errors.slice(0, 3).map((err, i) => (\n                                    <div key={`err-${i}`} style={{ marginBottom: '2px', color: '#fca5a5' }}>â€¢ {err}</div>\n                                ))}\n                                {validationResult.errors.length > 3 && (\n                                    <div style={{ color: '#9ca3af', marginTop: '4px' }}>...and {validationResult.errors.length - 3} more</div>\n                                )}\n                            </>\n                        )}\n\n                        {/* Warnings / Info */}\n                        {validationResult.warnings.length > 0 && (\n                            <div style={{ marginTop: validationResult.errors.length > 0 ? '10px' : '0' }}>\n                                {validationResult.warnings.slice(0, 4).map((warn, i) => (\n                                    <div key={`warn-${i}`} style={{\n                                        marginBottom: '4px',\n                                        color: warn.startsWith('âœ…') ? '#86efac' :\n                                            warn.startsWith('âš ï¸') ? '#fcd34d' :\n                                                warn.startsWith('ðŸ’Š') ? '#c4b5fd' :\n                                                    warn.startsWith('ðŸ”µ') ? '#93c5fd' : '#e2e8f0'\n                                    }}>\n                                        {warn}\n                                    </div>\n                                ))}\n                            </div>\n                        )}\n                    </div>\n                )}\n\n                <View3D\n                    atoms={atoms}\n                    bonds={bonds}\n                    selectedElement={mode === 'build' ? selectedElement : null}\n                    onEmptyClick={handleEmptyClick}\n                    onAtomClick={handleAtomClick}\n                />\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6443, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/app/dashboard/builder/page.tsx"],"sourcesContent":["\n'use client';\n\nimport TopHeader from '@/components/layout/TopHeader';\nimport Builder from '@/components/builder/Builder';\n\nexport default function BuilderPage() {\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', height: '100%' }}>\n            <TopHeader title=\"Molecular Builder\" subtitle=\"Design complex molecular chains with real-time stability simulation.\" />\n            <div style={{ flex: 1, padding: '0 40px 40px' }}>\n                <Builder />\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAHA;;;;AAKe,SAAS;IACpB,qBACI,8OAAC;QAAI,OAAO;YAAE,SAAS;YAAQ,eAAe;YAAU,QAAQ;QAAO;;0BACnE,8OAAC,oJAAS;gBAAC,OAAM;gBAAoB,UAAS;;;;;;0BAC9C,8OAAC;gBAAI,OAAO;oBAAE,MAAM;oBAAG,SAAS;gBAAc;0BAC1C,cAAA,8OAAC,mJAAO;;;;;;;;;;;;;;;;AAIxB"}}]
}