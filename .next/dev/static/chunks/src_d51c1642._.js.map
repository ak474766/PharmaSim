{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps } from 'firebase/app';\nimport { getAuth, GoogleAuthProvider } from 'firebase/auth';\nimport { getFirestore } from 'firebase/firestore';\nimport { getStorage } from 'firebase/storage';\n\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID\n};\n\nconst app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];\nexport const auth = getAuth(app);\nexport const db = getFirestore(app);\nexport const storage = getStorage(app);\nexport const googleProvider = new GoogleAuthProvider();\nexport default app;\n"],"names":[],"mappings":";;;;;;;;;;;;AAMY;AANZ;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,MAAM,iBAAiB;IACnB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACT;AAEA,MAAM,MAAM,IAAA,8KAAO,IAAG,MAAM,KAAK,IAAI,IAAA,oLAAa,EAAC,kBAAkB,IAAA,8KAAO,GAAE,CAAC,EAAE;AAC1E,MAAM,OAAO,IAAA,oMAAO,EAAC;AACrB,MAAM,KAAK,IAAA,kLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,8KAAU,EAAC;AAC3B,MAAM,iBAAiB,IAAI,+MAAkB;uCACrC"}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/lib/userService.ts"],"sourcesContent":["\nimport { db } from './firebase';\nimport { doc, getDoc, setDoc, updateDoc, collection, query, orderBy, limit, getDocs } from 'firebase/firestore';\n\nexport interface Quest {\n    id: string;\n    title: string;\n    description: string;\n    progress: number;\n    total: number;\n    completed: boolean;\n    type: 'build_molecule' | 'earn_xp';\n}\n\nexport interface Achievement {\n    id: string;\n    title: string;\n    description: string;\n    icon: string;\n    unlockedAt: number; // Timestamp\n}\n\nexport interface UserProfile {\n    uid: string;\n    displayName: string;\n    email: string;\n    xp: number;\n    level: number;\n    reputation: number;\n    moleculesDiscovered: number;\n    dailyQuests?: Quest[];\n    lastLogin?: number;\n    achievements?: Achievement[];\n    topicMastery?: Record<string, number>;\n}\n\nconst QUEST_TEMPLATES: Omit<Quest, 'progress' | 'completed'>[] = [\n    { id: 'q1', title: 'Synthesis Master', description: 'Build 3 Molecules', total: 3, type: 'build_molecule' },\n    { id: 'q2', title: 'Lab Rat', description: 'Earn 500 XP', total: 500, type: 'earn_xp' },\n    { id: 'q3', title: 'Daily Discovery', description: 'Build 1 Complex Molecule', total: 1, type: 'build_molecule' }\n];\n\nexport const UserService = {\n    // Get user profile or create if not exists\n    async getProfile(uid: string, email: string, displayName: string): Promise<UserProfile> {\n        const docRef = doc(db, 'users', uid);\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const data = docSnap.data() as UserProfile;\n            // Check for daily quest reset\n            const now = Date.now();\n            const oneDay = 24 * 60 * 60 * 1000;\n            if (!data.lastLogin || (now - data.lastLogin) > oneDay || !data.dailyQuests) {\n                // Reset quests\n                const newQuests = QUEST_TEMPLATES.slice(0, 2).map(q => ({ ...q, progress: 0, completed: false })); // Pick first 2 for now\n                await updateDoc(docRef, { dailyQuests: newQuests, lastLogin: now });\n                data.dailyQuests = newQuests;\n            }\n            return data;\n        } else {\n            // Create new profile\n            const newQuests = QUEST_TEMPLATES.slice(0, 2).map(q => ({ ...q, progress: 0, completed: false }));\n            const newProfile: UserProfile = {\n                uid,\n                email,\n                displayName: displayName || 'Researcher ' + uid.slice(0, 4),\n                xp: 0,\n                level: 1,\n                reputation: 100,\n                moleculesDiscovered: 0,\n                dailyQuests: newQuests,\n                lastLogin: Date.now(),\n                achievements: [],\n                topicMastery: { kinetics: 1, regulatory: 1, pharmacology: 1, chemistry: 1 }\n            };\n            await setDoc(docRef, newProfile);\n            return newProfile;\n        }\n    },\n\n    // Update Quest Progress\n    async updateQuestProgress(uid: string, type: string, amount: number) {\n        const docRef = doc(db, 'users', uid);\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const data = docSnap.data() as UserProfile;\n            let questsUpdated = false;\n\n            const newQuests = (data.dailyQuests || []).map(q => {\n                if (q.type === type && !q.completed) {\n                    const newProgress = Math.min(q.progress + amount, q.total);\n                    questsUpdated = true;\n                    return {\n                        ...q,\n                        progress: newProgress,\n                        completed: newProgress >= q.total\n                    };\n                }\n                return q;\n            });\n\n            if (questsUpdated) {\n                await updateDoc(docRef, { dailyQuests: newQuests });\n            }\n        }\n    },\n\n    // Unlock Achievement\n    async unlockAchievement(uid: string, achievement: Omit<Achievement, 'unlockedAt'>) {\n        const docRef = doc(db, 'users', uid);\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const data = docSnap.data() as UserProfile;\n            const existing = (data.achievements || []).find(a => a.id === achievement.id);\n            if (!existing) {\n                const newAchievement = { ...achievement, unlockedAt: Date.now() };\n                await updateDoc(docRef, {\n                    achievements: [...(data.achievements || []), newAchievement]\n                });\n                return newAchievement;\n            }\n        }\n        return null;\n    },\n\n    // Add XP and check for level up\n    async addXP(uid: string, amount: number) {\n        const docRef = doc(db, 'users', uid);\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const data = docSnap.data() as UserProfile;\n            const newXP = data.xp + amount;\n            const newLevel = Math.floor(newXP / 1000) + 1; // Simple level formula: 1000 XP per level\n\n            await updateDoc(docRef, {\n                xp: newXP,\n                level: newLevel,\n                moleculesDiscovered: data.moleculesDiscovered + 1 // Assuming 1 molecule per XP grant for now\n            });\n            return { newXP, newLevel };\n        }\n        return null;\n    },\n\n    // Get Leaderboard (Top 50 by XP)\n    async getLeaderboard(): Promise<UserProfile[]> {\n        const q = query(collection(db, 'users'), orderBy('xp', 'desc'), limit(50));\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => doc.data() as UserProfile);\n    },\n\n    // Get User Rank (Client-side calculation for demo)\n    async getUserRank(uid: string): Promise<number> {\n        // Fetch specific number of top users to determine rank\n        // Note: In production you'd use a cloud function or dedicated rank field\n        const q = query(collection(db, 'users'), orderBy('xp', 'desc'), limit(100));\n        const querySnapshot = await getDocs(q);\n        const users = querySnapshot.docs.map(doc => doc.id);\n        const rank = users.indexOf(uid);\n        return rank !== -1 ? rank + 1 : 1000; // Return >100 if not in top 100\n    },\n\n    // Update Topic Mastery\n    async updateTopicMastery(uid: string, topic: string, change: number) {\n        const docRef = doc(db, 'users', uid);\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const data = docSnap.data() as UserProfile;\n            const currentMastery = data.topicMastery?.[topic] || 1;\n            const newMastery = Math.max(1, Math.min(5, currentMastery + change)); // Clamp between 1 and 5\n\n            await updateDoc(docRef, {\n                [`topicMastery.${topic}`]: newMastery\n            });\n            return newMastery;\n        }\n        return 1;\n    }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/khana/OneDrive/Desktop/PharmaSim/src/context/AuthContext.tsx"],"sourcesContent":["'use client';\n\n\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport { onAuthStateChanged, User } from 'firebase/auth';\nimport { auth } from '@/lib/firebase';\nimport { UserService, UserProfile } from '@/lib/userService';\n\ninterface AuthContextType {\n    user: User | null;\n    profile: UserProfile | null;\n    loading: boolean;\n    refreshProfile: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType>({ user: null, profile: null, loading: true, refreshProfile: async () => { } });\n\nexport const AuthProvider = ({ children }: { children: React.ReactNode }) => {\n    const [user, setUser] = useState<User | null>(null);\n    const [profile, setProfile] = useState<UserProfile | null>(null);\n    const [loading, setLoading] = useState(true);\n\n    const fetchProfile = async (currentUser: User) => {\n        try {\n            const userProfile = await UserService.getProfile(\n                currentUser.uid,\n                currentUser.email || '',\n                currentUser.displayName || ''\n            );\n            setProfile(userProfile);\n        } catch (error) {\n            console.error(\"Error fetching profile:\", error);\n        }\n    };\n\n    useEffect(() => {\n        const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\n            setUser(currentUser);\n            if (currentUser) {\n                await fetchProfile(currentUser);\n            } else {\n                setProfile(null);\n            }\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, []);\n\n    const refreshProfile = async () => {\n        if (user) {\n            await fetchProfile(user);\n        }\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, profile, loading, refreshProfile }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n"],"names":[],"mappings":";;;;;;;AAGA;AACA;AAAA;AACA;AACA;;;AANA;;;;;AAeA,MAAM,4BAAc,IAAA,8KAAa,EAAkB;IAAE,MAAM;IAAM,SAAS;IAAM,SAAS;IAAM,gBAAgB,WAAc;AAAE;AAExH,MAAM,eAAe,CAAC,EAAE,QAAQ,EAAiC;;IACpE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAqB;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,eAAe,OAAO;QACxB,IAAI;YACA,MAAM,cAAc,MAAM,2IAAW,CAAC,UAAU,CAC5C,YAAY,GAAG,EACf,YAAY,KAAK,IAAI,IACrB,YAAY,WAAW,IAAI;YAE/B,WAAW;QACf,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,2BAA2B;QAC7C;IACJ;IAEA,IAAA,0KAAS;kCAAC;YACN,MAAM,cAAc,IAAA,+MAAkB,EAAC,iIAAI;sDAAE,OAAO;oBAChD,QAAQ;oBACR,IAAI,aAAa;wBACb,MAAM,aAAa;oBACvB,OAAO;wBACH,WAAW;oBACf;oBACA,WAAW;gBACf;;YAEA;0CAAO,IAAM;;QACjB;iCAAG,EAAE;IAEL,MAAM,iBAAiB;QACnB,IAAI,MAAM;YACN,MAAM,aAAa;QACvB;IACJ;IAEA,qBACI,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;YAAS;QAAe;kBACjE;;;;;;AAGb;GA3Ca;KAAA;AA6CN,MAAM,UAAU;;IAAM,OAAA,IAAA,2KAAU,EAAC;AAAW;IAAtC"}}]
}