(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94438,e=>{e.v({active:"Builder-module__puRpEa__active",aiFeedback:"Builder-module__puRpEa__aiFeedback",btn:"Builder-module__puRpEa__btn",btnPrimary:"Builder-module__puRpEa__btnPrimary",btnSuccess:"Builder-module__puRpEa__btnSuccess",builderContainer:"Builder-module__puRpEa__builderContainer",canvasArea:"Builder-module__puRpEa__canvasArea",canvasContainer:"Builder-module__puRpEa__canvasContainer",canvasHeader:"Builder-module__puRpEa__canvasHeader",container:"Builder-module__puRpEa__container",controls:"Builder-module__puRpEa__controls",elementCard:"Builder-module__puRpEa__elementCard",elementList:"Builder-module__puRpEa__elementList",elementsGrid:"Builder-module__puRpEa__elementsGrid",feedbackStats:"Builder-module__puRpEa__feedbackStats",header:"Builder-module__puRpEa__header",hintCard:"Builder-module__puRpEa__hintCard",hintText:"Builder-module__puRpEa__hintText",hintTitle:"Builder-module__puRpEa__hintTitle",iconPurple:"Builder-module__puRpEa__iconPurple",palette:"Builder-module__puRpEa__palette",propBar:"Builder-module__puRpEa__propBar",propFill:"Builder-module__puRpEa__propFill",propHeader:"Builder-module__puRpEa__propHeader",propLabel:"Builder-module__puRpEa__propLabel",propSection:"Builder-module__puRpEa__propSection",propTags:"Builder-module__puRpEa__propTags",propValue:"Builder-module__puRpEa__propValue",properties:"Builder-module__puRpEa__properties",selected:"Builder-module__puRpEa__selected",sidebar:"Builder-module__puRpEa__sidebar",statusMsg:"Builder-module__puRpEa__statusMsg",tag:"Builder-module__puRpEa__tag"})},16015,(e,t,r)=>{},98547,(e,t,r)=>{var n=e.i(47167);e.r(16015);var a=e.r(71645),o=a&&"object"==typeof a&&"default"in a?a:{default:a},i=void 0!==n.default&&n.default.env&&!0,s=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,n=void 0===r?"stylesheet":r,a=t.optimizeForSpeed,o=void 0===a?i:a;c(s(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",c("boolean"==typeof o,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=o,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="u">typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"u">typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(i||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(s(e),"`insertRule` accepts only strings"),"u"<typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return i||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"u"<typeof window){var r="u">typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(n){i||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];c(n,"old rule at index `"+e+"` not found"),n.textContent=t}return e},r.deleteRule=function(e){if("u"<typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"u">typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"u"<typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(s(t),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),t&&n.appendChild(document.createTextNode(t));var a=document.head||document.getElementsByTagName("head")[0];return r?a.insertBefore(n,r):a.appendChild(n),n},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},u={};function m(e,t){if(!t)return"jsx-"+e;var r=String(t),n=e+r;return u[n]||(u[n]="jsx-"+d(e+"-"+r)),u[n]}function h(e,t){"u"<typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return u[r]||(u[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[r]}var p=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,n=void 0===r?null:r,a=t.optimizeForSpeed,o=void 0!==a&&a;this._sheet=n||new l({name:"styled-jsx",optimizeForSpeed:o}),this._sheet.inject(),n&&"boolean"==typeof o&&(this._sheet.setOptimizeForSpeed(o),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"u">typeof window&&!this._fromServer&&(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),n=r.styleId,a=r.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var o=a.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=o,this._instancesCounts[n]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var n=this._fromServer&&this._fromServer[r];n?(n.parentNode.removeChild(n),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],n=e[1];return o.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,n=e.id;if(r){var a=m(n,r);return{styleId:a,rules:Array.isArray(t)?t.map(function(e){return h(a,e)}):[h(a,t)]}}return{styleId:m(n),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=a.createContext(null);function g(){return new p}function y(){return a.useContext(f)}f.displayName="StyleSheetContext";var b=o.default.useInsertionEffect||o.default.useLayoutEffect,x="u">typeof window?g():void 0;function C(e){var t=x||y();return t&&("u"<typeof window?t.add(e):b(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}C.dynamic=function(e){return e.map(function(e){return m(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,n=a.useContext(f),i=a.useState(function(){return n||t||g()})[0];return o.default.createElement(f.Provider,{value:i},r)},r.createStyleRegistry=g,r.style=C,r.useStyleRegistry=y},37902,(e,t,r)=>{t.exports=e.r(98547).style},51865,e=>{e.v({activeTab:"ChemistryReference-module__K33AyG__activeTab",bondCard:"ChemistryReference-module__K33AyG__bondCard",bondDescription:"ChemistryReference-module__K33AyG__bondDescription",bondElectrons:"ChemistryReference-module__K33AyG__bondElectrons",bondExamples:"ChemistryReference-module__K33AyG__bondExamples",bondHeader:"ChemistryReference-module__K33AyG__bondHeader",bondName:"ChemistryReference-module__K33AyG__bondName",bondStrength:"ChemistryReference-module__K33AyG__bondStrength",bondSymbol:"ChemistryReference-module__K33AyG__bondSymbol",bondsList:"ChemistryReference-module__K33AyG__bondsList",closeBtn:"ChemistryReference-module__K33AyG__closeBtn",content:"ChemistryReference-module__K33AyG__content",detailGrid:"ChemistryReference-module__K33AyG__detailGrid",detailItem:"ChemistryReference-module__K33AyG__detailItem",detailLabel:"ChemistryReference-module__K33AyG__detailLabel",detailValue:"ChemistryReference-module__K33AyG__detailValue",elementCard:"ChemistryReference-module__K33AyG__elementCard",elementDetail:"ChemistryReference-module__K33AyG__elementDetail",elementName:"ChemistryReference-module__K33AyG__elementName",elementNumber:"ChemistryReference-module__K33AyG__elementNumber",elementSymbol:"ChemistryReference-module__K33AyG__elementSymbol",elementsGrid:"ChemistryReference-module__K33AyG__elementsGrid",groupCard:"ChemistryReference-module__K33AyG__groupCard",groupDescription:"ChemistryReference-module__K33AyG__groupDescription",groupExamples:"ChemistryReference-module__K33AyG__groupExamples",groupHeader:"ChemistryReference-module__K33AyG__groupHeader",groupIcon:"ChemistryReference-module__K33AyG__groupIcon",groupName:"ChemistryReference-module__K33AyG__groupName",groupRelevance:"ChemistryReference-module__K33AyG__groupRelevance",groupStructure:"ChemistryReference-module__K33AyG__groupStructure",groupsList:"ChemistryReference-module__K33AyG__groupsList",header:"ChemistryReference-module__K33AyG__header",overlay:"ChemistryReference-module__K33AyG__overlay",panel:"ChemistryReference-module__K33AyG__panel",selected:"ChemistryReference-module__K33AyG__selected",smilesExample:"ChemistryReference-module__K33AyG__smilesExample",smilesExamples:"ChemistryReference-module__K33AyG__smilesExamples",smilesGuide:"ChemistryReference-module__K33AyG__smilesGuide",smilesIntro:"ChemistryReference-module__K33AyG__smilesIntro",smilesTable:"ChemistryReference-module__K33AyG__smilesTable",smilesTitle:"ChemistryReference-module__K33AyG__smilesTitle",tab:"ChemistryReference-module__K33AyG__tab",tabs:"ChemistryReference-module__K33AyG__tabs",tipCard:"ChemistryReference-module__K33AyG__tipCard",tipContent:"ChemistryReference-module__K33AyG__tipContent",tipTitle:"ChemistryReference-module__K33AyG__tipTitle",tipsList:"ChemistryReference-module__K33AyG__tipsList",title:"ChemistryReference-module__K33AyG__title"})},16944,e=>{"use strict";var t=e.i(43476),r=e.i(49474),n=e.i(71645),a=e.i(32009),o=a;let i={type:"change"},s={type:"start"},l={type:"end"},c=new o.Ray,d=new o.Plane,u=Math.cos(70*o.MathUtils.DEG2RAD);class m extends o.EventDispatcher{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new o.Vector3,this.cursor=new o.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:o.MOUSE.ROTATE,MIDDLE:o.MOUSE.DOLLY,RIGHT:o.MOUSE.PAN},this.touches={ONE:o.TOUCH.ROTATE,TWO:o.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",et),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",et),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),a=n.NONE},this.update=function(){let t=new o.Vector3,s=new o.Quaternion().setFromUnitVectors(e.up,new o.Vector3(0,1,0)),l=s.clone().invert(),y=new o.Vector3,b=new o.Quaternion,x=new o.Vector3,C=2*Math.PI;return function(_=null){var v;let S=r.object.position;t.copy(S).sub(r.target),t.applyQuaternion(s),h.setFromVector3(t),r.autoRotate&&a===n.NONE&&k(null!==(v=_)?2*Math.PI/60*r.autoRotateSpeed*v:2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(h.theta+=p.theta*r.dampingFactor,h.phi+=p.phi*r.dampingFactor):(h.theta+=p.theta,h.phi+=p.phi);let A=r.minAzimuthAngle,j=r.maxAzimuthAngle;isFinite(A)&&isFinite(j)&&(A<-Math.PI?A+=C:A>Math.PI&&(A-=C),j<-Math.PI?j+=C:j>Math.PI&&(j-=C),A<=j?h.theta=Math.max(A,Math.min(j,h.theta)):h.theta=h.theta>(A+j)/2?Math.max(A,h.theta):Math.min(j,h.theta)),h.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,h.phi)),h.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(g,r.dampingFactor):r.target.add(g),r.target.sub(r.cursor),r.target.clampLength(r.minTargetRadius,r.maxTargetRadius),r.target.add(r.cursor),r.zoomToCursor&&O||r.object.isOrthographicCamera?h.radius=G(h.radius):h.radius=G(h.radius*f),t.setFromSpherical(h),t.applyQuaternion(l),S.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,g.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),g.set(0,0,0));let N=!1;if(r.zoomToCursor&&O){let n=null;if(r.object.isPerspectiveCamera){let e=t.length();n=G(e*f);let a=e-n;r.object.position.addScaledVector(w,a),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){let e=new o.Vector3(E.x,E.y,0);e.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/f)),r.object.updateProjectionMatrix(),N=!0;let a=new o.Vector3(E.x,E.y,0);a.unproject(r.object),r.object.position.sub(a).add(e),r.object.updateMatrixWorld(),n=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==n&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(n).add(r.object.position):(c.origin.copy(r.object.position),c.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(c.direction))<u?e.lookAt(r.target):(d.setFromNormalAndCoplanarPoint(r.object.up,r.target),c.intersectPlane(d,r.target))))}else r.object.isOrthographicCamera&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/f)),r.object.updateProjectionMatrix(),N=!0);return f=1,O=!1,!!(N||y.distanceToSquared(r.object.position)>m||8*(1-b.dot(r.object.quaternion))>m||x.distanceToSquared(r.target)>0)&&(r.dispatchEvent(i),y.copy(r.object.position),b.copy(r.object.quaternion),x.copy(r.target),!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",er),r.domElement.removeEventListener("pointerdown",q),r.domElement.removeEventListener("pointercancel",Q),r.domElement.removeEventListener("wheel",J),r.domElement.removeEventListener("pointermove",Z),r.domElement.removeEventListener("pointerup",Q),null!==r._domElementKeyEvents&&(r._domElementKeyEvents.removeEventListener("keydown",et),r._domElementKeyEvents=null)};const r=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=n.NONE;const m=1e-6,h=new o.Spherical,p=new o.Spherical;let f=1;const g=new o.Vector3,y=new o.Vector2,b=new o.Vector2,x=new o.Vector2,C=new o.Vector2,_=new o.Vector2,v=new o.Vector2,S=new o.Vector2,A=new o.Vector2,j=new o.Vector2,w=new o.Vector3,E=new o.Vector2;let O=!1;const N=[],R={};let M=!1;function I(e){let t=Math.abs(.01*e);return Math.pow(.95,r.zoomSpeed*t)}function k(e){p.theta-=e}function z(e){p.phi-=e}const T=function(){let e=new o.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),g.add(e)}}(),H=function(){let e=new o.Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),g.add(e)}}(),P=function(){let e=new o.Vector3;return function(t,n){let a=r.domElement;if(r.object.isPerspectiveCamera){let o=r.object.position;e.copy(o).sub(r.target);let i=e.length();T(2*t*(i*=Math.tan(r.object.fov/2*Math.PI/180))/a.clientHeight,r.object.matrix),H(2*n*i/a.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(T(t*(r.object.right-r.object.left)/r.object.zoom/a.clientWidth,r.object.matrix),H(n*(r.object.top-r.object.bottom)/r.object.zoom/a.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function B(e){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?f/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function L(e){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?f*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(e,t){if(!r.zoomToCursor)return;O=!0;let n=r.domElement.getBoundingClientRect(),a=e-n.left,o=t-n.top,i=n.width,s=n.height;E.x=a/i*2-1,E.y=-(o/s*2)+1,w.set(E.x,E.y,1).unproject(r.object).sub(r.object.position).normalize()}function G(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function D(e){y.set(e.clientX,e.clientY)}function $(e){C.set(e.clientX,e.clientY)}function K(e){if(1===N.length)y.set(e.pageX,e.pageY);else{let t=ea(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);y.set(r,n)}}function V(e){if(1===N.length)C.set(e.pageX,e.pageY);else{let t=ea(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);C.set(r,n)}}function U(e){let t=ea(e),r=e.pageX-t.x,n=e.pageY-t.y,a=Math.sqrt(r*r+n*n);S.set(0,a)}function Y(e){if(1==N.length)b.set(e.pageX,e.pageY);else{let t=ea(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);b.set(r,n)}x.subVectors(b,y).multiplyScalar(r.rotateSpeed);let t=r.domElement;k(2*Math.PI*x.x/t.clientHeight),z(2*Math.PI*x.y/t.clientHeight),y.copy(b)}function W(e){if(1===N.length)_.set(e.pageX,e.pageY);else{let t=ea(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);_.set(r,n)}v.subVectors(_,C).multiplyScalar(r.panSpeed),P(v.x,v.y),C.copy(_)}function X(e){let t=ea(e),n=e.pageX-t.x,a=e.pageY-t.y,o=Math.sqrt(n*n+a*a);A.set(0,o),j.set(0,Math.pow(A.y/S.y,r.zoomSpeed)),B(j.y),S.copy(A),F((e.pageX+t.x)*.5,(e.pageY+t.y)*.5)}function q(e){var t;!1!==r.enabled&&(0===N.length&&(r.domElement.setPointerCapture(e.pointerId),r.domElement.addEventListener("pointermove",Z),r.domElement.addEventListener("pointerup",Q)),t=e,N.push(t.pointerId),"touch"===e.pointerType?function(e){switch(en(e),N.length){case 1:switch(r.touches.ONE){case o.TOUCH.ROTATE:if(!1===r.enableRotate)return;K(e),a=n.TOUCH_ROTATE;break;case o.TOUCH.PAN:if(!1===r.enablePan)return;V(e),a=n.TOUCH_PAN;break;default:a=n.NONE}break;case 2:switch(r.touches.TWO){case o.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&U(e),r.enablePan&&V(e),a=n.TOUCH_DOLLY_PAN;break;case o.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&U(e),r.enableRotate&&K(e),a=n.TOUCH_DOLLY_ROTATE;break;default:a=n.NONE}break;default:a=n.NONE}a!==n.NONE&&r.dispatchEvent(s)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case o.MOUSE.DOLLY:if(!1===r.enableZoom)return;F(e.clientX,e.clientX),S.set(e.clientX,e.clientY),a=n.DOLLY;break;case o.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;$(e),a=n.PAN}else{if(!1===r.enableRotate)return;D(e),a=n.ROTATE}break;case o.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;D(e),a=n.ROTATE}else{if(!1===r.enablePan)return;$(e),a=n.PAN}break;default:a=n.NONE}a!==n.NONE&&r.dispatchEvent(s)}(e))}function Z(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(en(e),a){case n.TOUCH_ROTATE:if(!1===r.enableRotate)return;Y(e),r.update();break;case n.TOUCH_PAN:if(!1===r.enablePan)return;W(e),r.update();break;case n.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&X(e),r.enablePan&&W(e),r.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&X(e),r.enableRotate&&Y(e),r.update();break;default:a=n.NONE}}(e):function(e){switch(a){case n.ROTATE:let t;if(!1===r.enableRotate)return;b.set(e.clientX,e.clientY),x.subVectors(b,y).multiplyScalar(r.rotateSpeed),t=r.domElement,k(2*Math.PI*x.x/t.clientHeight),z(2*Math.PI*x.y/t.clientHeight),y.copy(b),r.update();break;case n.DOLLY:if(!1===r.enableZoom)return;A.set(e.clientX,e.clientY),j.subVectors(A,S),j.y>0?B(I(j.y)):j.y<0&&L(I(j.y)),S.copy(A),r.update();break;case n.PAN:if(!1===r.enablePan)return;_.set(e.clientX,e.clientY),v.subVectors(_,C).multiplyScalar(r.panSpeed),P(v.x,v.y),C.copy(_),r.update()}}(e))}function Q(e){(function(e){delete R[e.pointerId];for(let t=0;t<N.length;t++)if(N[t]==e.pointerId)return void N.splice(t,1)})(e),0===N.length&&(r.domElement.releasePointerCapture(e.pointerId),r.domElement.removeEventListener("pointermove",Z),r.domElement.removeEventListener("pointerup",Q)),r.dispatchEvent(l),a=n.NONE}function J(e){if(!1!==r.enabled&&!1!==r.enableZoom&&a===n.NONE){var t;e.preventDefault(),r.dispatchEvent(s),F((t=function(e){let t=e.deltaMode,r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100}return e.ctrlKey&&!M&&(r.deltaY*=10),r}(e)).clientX,t.clientY),t.deltaY<0?L(I(t.deltaY)):t.deltaY>0&&B(I(t.deltaY)),r.update(),r.dispatchEvent(l)}}function ee(e){"Control"===e.key&&(M=!1,document.removeEventListener("keyup",ee,{passive:!0,capture:!0}))}function et(e){if(!1!==r.enabled&&!1!==r.enablePan){let t=!1;switch(e.code){case r.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?z(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?z(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?k(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?k(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}}function er(e){!1!==r.enabled&&e.preventDefault()}function en(e){let t=R[e.pointerId];void 0===t&&(t=new o.Vector2,R[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ea(e){return R[e.pointerId===N[0]?N[1]:N[0]]}r.domElement.addEventListener("contextmenu",er),r.domElement.addEventListener("pointerdown",q),r.domElement.addEventListener("pointercancel",Q),r.domElement.addEventListener("wheel",J,{passive:!1}),document.addEventListener("keydown",function(e){"Control"===e.key&&(M=!0,document.addEventListener("keyup",ee,{passive:!0,capture:!0}))},{passive:!0,capture:!0}),this.update()}}let h={H:{name:"Hydrogen",symbol:"H",atomicNumber:1,color:0xffffff,radius:.8,mass:1.008,valence:[1]},C:{name:"Carbon",symbol:"C",atomicNumber:6,color:9474192,radius:1.2,mass:12.011,valence:[4]},N:{name:"Nitrogen",symbol:"N",atomicNumber:7,color:3166456,radius:1.1,mass:14.007,valence:[3,4,5]},O:{name:"Oxygen",symbol:"O",atomicNumber:8,color:0xff0d0d,radius:1,mass:15.999,valence:[2]},F:{name:"Fluorine",symbol:"F",atomicNumber:9,color:9494608,radius:.9,mass:18.998,valence:[1]},P:{name:"Phosphorus",symbol:"P",atomicNumber:15,color:0xff8000,radius:1.3,mass:30.974,valence:[3,5]},S:{name:"Sulfur",symbol:"S",atomicNumber:16,color:0xffff30,radius:1.3,mass:32.06,valence:[2,4,6]},Cl:{name:"Chlorine",symbol:"Cl",atomicNumber:17,color:2093087,radius:1.2,mass:35.45,valence:[1]},Br:{name:"Bromine",symbol:"Br",atomicNumber:35,color:0xa62929,radius:1.4,mass:79.904,valence:[1]},I:{name:"Iodine",symbol:"I",atomicNumber:53,color:9699476,radius:1.6,mass:126.9,valence:[1]}};class p{scene;camera;renderer;controls;raycaster;mouse;container;atoms=[];bonds=[];atomMeshes=new Map;bondMeshes=new Map;onAtomClick;onEmptyClick;onAtomHover;ghostMesh=null;hoveredAtomId=null;constructor(e,t,r,n,o,i){this.container=e,this.onAtomClick=n,this.onEmptyClick=o,this.onAtomHover=i,this.scene=new a.Scene,this.scene.background=new a.Color(328968),this.scene.fog=new a.Fog(328968,15,60),this.camera=new a.PerspectiveCamera(55,t/r,.1,1e3),this.camera.position.set(0,8,18),this.renderer=new a.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(t,r),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),e.appendChild(this.renderer.domElement),this.controls=new m(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.minDistance=5,this.controls.maxDistance=50;const s=new a.AmbientLight(4210768,2);this.scene.add(s);const l=new a.PointLight(0xffffff,2.5);l.position.set(10,15,10),this.scene.add(l);const c=new a.DirectionalLight(0xffffff,1.5);c.position.set(-5,10,-5),this.scene.add(c);const d=new a.GridHelper(40,40,3355456,1710629);this.scene.add(d),this.raycaster=new a.Raycaster,this.mouse=new a.Vector2,this.renderer.domElement.addEventListener("click",this.handleClick.bind(this)),this.renderer.domElement.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.animate()}updateGhost(e){if(this.ghostMesh&&(this.scene.remove(this.ghostMesh),this.ghostMesh=null),e&&h[e]){let t=h[e],r=new a.SphereGeometry(1,32,32),n=new a.MeshPhongMaterial({color:t.color,opacity:.4,transparent:!0,emissive:t.color,emissiveIntensity:.3});this.ghostMesh=new a.Mesh(r,n);let o=.5*t.radius;this.ghostMesh.scale.set(o,o,o),this.scene.add(this.ghostMesh)}}handleMouseMove(e){let t=this.renderer.domElement.getBoundingClientRect();this.mouse.x=(e.clientX-t.left)/t.width*2-1,this.mouse.y=-(2*((e.clientY-t.top)/t.height))+1,this.raycaster.setFromCamera(this.mouse,this.camera);let r=Array.from(this.atomMeshes.values()),n=this.raycaster.intersectObjects(r);if(n.length>0){let e=n[0].object;for(let[t,r]of this.atomMeshes.entries())if(r===e){if(this.hoveredAtomId!==t){this.hoveredAtomId=t;let e=this.atoms.find(e=>e.id===t);this.onAtomHover&&this.onAtomHover(e||null)}break}}else null!==this.hoveredAtomId&&(this.hoveredAtomId=null,this.onAtomHover&&this.onAtomHover(null));if(this.ghostMesh){let e=new a.Plane(new a.Vector3(0,1,0),0),t=new a.Vector3,r=this.raycaster.ray.intersectPlane(e,t);r?(this.ghostMesh.position.copy(r),this.ghostMesh.visible=!0):this.ghostMesh.visible=!1}}handleClick(e){let t=this.renderer.domElement.getBoundingClientRect();this.mouse.x=(e.clientX-t.left)/t.width*2-1,this.mouse.y=-(2*((e.clientY-t.top)/t.height))+1,this.raycaster.setFromCamera(this.mouse,this.camera);let r=Array.from(this.atomMeshes.values()),n=this.raycaster.intersectObjects(r);if(n.length>0){let e=n[0].object;for(let[t,r]of this.atomMeshes.entries())if(r===e&&this.onAtomClick)return void this.onAtomClick(t)}else{let e=new a.Plane(new a.Vector3(0,1,0),0),t=new a.Vector3,r=this.raycaster.ray.intersectPlane(e,t);r&&this.onEmptyClick&&this.onEmptyClick(r)}}updateMolecule(e,t){this.atoms=e,this.bonds=t,this.renderMolecule()}renderMolecule(){this.atomMeshes.forEach(e=>this.scene.remove(e)),this.atomMeshes.clear(),this.bondMeshes.forEach(e=>e.forEach(e=>this.scene.remove(e))),this.bondMeshes.clear();let e=new a.SphereGeometry(1,32,32),t=new a.CylinderGeometry(.15,.15,1,16);this.atoms.forEach(t=>{let r=h[t.element];if(!r)return;let n=new a.MeshPhongMaterial({color:r.color,shininess:80,specular:4473924}),o=new a.Mesh(e,n),i=.5*r.radius;o.scale.set(i,i,i),o.position.set(t.x,t.y,t.z),this.scene.add(o),this.atomMeshes.set(t.id,o)}),this.bonds.forEach(e=>{let r=this.atoms.find(t=>t.id===e.sourceId),n=this.atoms.find(t=>t.id===e.targetId);if(!r||!n)return;let o=new a.Vector3(r.x,r.y,r.z),i=new a.Vector3(n.x,n.y,n.z),s=o.distanceTo(i),l=new a.Vector3().addVectors(o,i).multiplyScalar(.5),c=new a.Vector3().subVectors(i,o).normalize(),d=new a.Quaternion;if(d.setFromUnitVectors(new a.Vector3(0,1,0),c),1===e.order){let r=new a.MeshPhongMaterial({color:6710912}),n=new a.Mesh(t,r);n.position.copy(l),n.quaternion.copy(d),n.scale.set(1,s,1),this.scene.add(n),this.bondMeshes.set(e.id,[n])}else if(e.order>=2){let r=new a.Vector3(0,0,1);Math.abs(c.z)>.9&&r.set(1,0,0);let n=new a.Vector3().crossVectors(c,r).normalize().multiplyScalar(.2),o=new a.Mesh(t,new a.MeshPhongMaterial({color:6710912}));o.position.copy(l).add(n),o.quaternion.copy(d),o.scale.set(.8,s,.8);let i=new a.Mesh(t,new a.MeshPhongMaterial({color:6710912}));i.position.copy(l).sub(n),i.quaternion.copy(d),i.scale.set(.8,s,.8),this.scene.add(o),this.scene.add(i),this.bondMeshes.set(e.id,[o,i])}})}resize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}dispose(){this.renderer.dispose(),this.container.contains(this.renderer.domElement)&&this.container.removeChild(this.renderer.domElement)}animate(){requestAnimationFrame(this.animate.bind(this)),this.controls.update(),this.renderer.render(this.scene,this.camera)}}let f=(0,n.forwardRef)(({atoms:e,bonds:r,selectedElement:a,onAtomClick:o,onEmptyClick:i},s)=>{let l=(0,n.useRef)(null),c=(0,n.useRef)(null),[d,u]=(0,n.useState)(null),[m,f]=(0,n.useState)({x:0,y:0}),g=(0,n.useRef)(o),y=(0,n.useRef)(i);return(0,n.useEffect)(()=>{g.current=o},[o]),(0,n.useEffect)(()=>{y.current=i},[i]),(0,n.useImperativeHandle)(s,()=>({resize:()=>{if(c.current&&l.current){let{clientWidth:e,clientHeight:t}=l.current;c.current.resize(e,t)}}})),(0,n.useEffect)(()=>{if(!l.current)return;let{clientWidth:e,clientHeight:t}=l.current,r=new p(l.current,e,t,e=>g.current?.(e),e=>y.current?.(e),e=>u(e));c.current=r;let n=new ResizeObserver(()=>{if(l.current&&c.current){let{clientWidth:e,clientHeight:t}=l.current;c.current.resize(e,t)}});return n.observe(l.current),()=>{r.dispose(),n.disconnect()}},[]),(0,n.useEffect)(()=>{c.current&&(c.current.updateMolecule(e,r),c.current.updateGhost(a||null))},[e,r,a]),(0,t.jsx)("div",{ref:l,onMouseMove:e=>{if(l.current){let t=l.current.getBoundingClientRect();f({x:e.clientX-t.left+15,y:e.clientY-t.top-10})}},style:{width:"100%",height:"100%",position:"relative",cursor:d?"pointer":"crosshair"},children:d&&(0,t.jsxs)("div",{style:{position:"absolute",left:m.x,top:m.y,background:"rgba(0, 0, 0, 0.9)",color:"#fff",padding:"8px 12px",borderRadius:"8px",fontSize:"0.85rem",fontWeight:600,pointerEvents:"none",zIndex:100,display:"flex",alignItems:"center",gap:"8px",border:"1px solid rgba(255,255,255,0.15)",boxShadow:"0 4px 12px rgba(0,0,0,0.4)"},children:[(0,t.jsx)("div",{style:{width:"14px",height:"14px",borderRadius:"50%",background:`#${h[d.element]?.color.toString(16).padStart(6,"0")||"ffffff"}`}}),(0,t.jsx)("span",{children:h[d.element]?.name||d.element}),(0,t.jsxs)("span",{style:{color:"#6b7280",fontWeight:400,fontSize:"0.75rem"},children:["(",d.element,")"]})]})})});f.displayName="View3D";var g=e.i(28783),y=e.i(76480);let b=[{formula:"H2",name:"Hydrogen Gas",score:10,category:"simple"},{formula:"O2",name:"Oxygen Gas",score:10,category:"simple"},{formula:"N2",name:"Nitrogen Gas",score:10,category:"simple"},{formula:"H2O",name:"Water",score:30,category:"simple",description:"Universal solvent"},{formula:"CO2",name:"Carbon Dioxide",score:40,category:"simple"},{formula:"NH3",name:"Ammonia",score:35,category:"simple"},{formula:"HCl",name:"Hydrochloric Acid",score:25,category:"simple"},{formula:"HF",name:"Hydrofluoric Acid",score:25,category:"simple"},{formula:"H2S",name:"Hydrogen Sulfide",score:30,category:"simple"},{formula:"CH4",name:"Methane",score:50,category:"organic",description:"Simplest alkane"},{formula:"C2H6",name:"Ethane",score:60,category:"organic"},{formula:"C3H8",name:"Propane",score:70,category:"organic"},{formula:"C4H10",name:"Butane",score:80,category:"organic"},{formula:"C2H4",name:"Ethylene",score:65,category:"organic",description:"Simplest alkene"},{formula:"C2H2",name:"Acetylene",score:70,category:"organic",description:"Simplest alkyne"},{formula:"C6H6",name:"Benzene",score:150,category:"organic",description:"Aromatic ring"},{formula:"CH4O",name:"Methanol",score:80,category:"organic"},{formula:"C2H6O",name:"Ethanol",score:100,category:"organic",description:"Drinking alcohol"},{formula:"C3H8O",name:"Propanol",score:110,category:"organic"},{formula:"C3H8O3",name:"Glycerol",score:140,category:"organic"},{formula:"CH2O",name:"Formaldehyde",score:70,category:"organic"},{formula:"C2H4O",name:"Acetaldehyde",score:85,category:"organic"},{formula:"C3H6O",name:"Acetone",score:95,category:"organic"},{formula:"CH2O2",name:"Formic Acid",score:75,category:"organic"},{formula:"C2H4O2",name:"Acetic Acid",score:90,category:"organic",description:"Vinegar"},{formula:"C3H6O2",name:"Propionic Acid",score:100,category:"organic"},{formula:"CH5N",name:"Methylamine",score:70,category:"organic"},{formula:"C2H7N",name:"Ethylamine",score:80,category:"organic"},{formula:"C6H7N",name:"Aniline",score:130,category:"organic"},{formula:"C8H9NO2",name:"Paracetamol",score:300,category:"drug",description:"Acetaminophen - analgesic"},{formula:"C9H8O4",name:"Aspirin",score:350,category:"drug",description:"Acetylsalicylic acid - NSAID"},{formula:"C13H18O2",name:"Ibuprofen",score:400,category:"drug",description:"NSAID anti-inflammatory"},{formula:"C8H10N4O2",name:"Caffeine",score:450,category:"drug",description:"Stimulant"},{formula:"C17H19NO3",name:"Morphine",score:500,category:"drug",description:"Opioid analgesic"},{formula:"C16H18N2O4S",name:"Penicillin G",score:550,category:"drug",description:"Beta-lactam antibiotic"},{formula:"C10H15N",name:"Amphetamine",score:380,category:"drug"},{formula:"C20H25N3O",name:"LSD",score:600,category:"drug"},{formula:"C21H23NO5",name:"Codeine",score:480,category:"drug"},{formula:"C14H18N2O5",name:"Aspartame",score:350,category:"organic"},{formula:"C6H12O6",name:"Glucose",score:250,category:"biomolecule",description:"Simple sugar"},{formula:"C5H10O5",name:"Ribose",score:220,category:"biomolecule"},{formula:"C4H8N2O3",name:"Asparagine",score:280,category:"biomolecule",description:"Amino acid"},{formula:"C5H9NO4",name:"Glutamic Acid",score:290,category:"biomolecule",description:"Amino acid"},{formula:"C3H7NO2",name:"Alanine",score:200,category:"biomolecule",description:"Simple amino acid"},{formula:"C2H5NO2",name:"Glycine",score:180,category:"biomolecule",description:"Simplest amino acid"},{formula:"CHCl3",name:"Chloroform",score:120,category:"organic"},{formula:"CCl4",name:"Carbon Tetrachloride",score:110,category:"organic"},{formula:"C4H8O2",name:"Ethyl Acetate",score:130,category:"organic",description:"Common solvent"}],x=[{name:"hydroxyl",displayName:"Hydroxyl (-OH)",icon:"ðŸ’§",drugRelevance:"Increases water solubility",pattern:(e,t,r)=>{let n=0;return e.forEach(a=>{if("O"===a.element){let o=r.get(a.id)||[];if(2===C(a.id,t).totalOrder){let t=o.some(t=>e.find(e=>e.id===t)?.element==="H"),r=o.some(t=>e.find(e=>e.id===t)?.element==="C");t&&r&&n++}}}),n}},{name:"carbonyl",displayName:"Carbonyl (C=O)",icon:"âš—ï¸",drugRelevance:"Reactive center, H-bond acceptor",pattern:(e,t)=>{let r=0;return t.forEach(t=>{if(2===t.order){let n=e.find(e=>e.id===t.sourceId),a=e.find(e=>e.id===t.targetId);(n?.element==="C"&&a?.element==="O"||n?.element==="O"&&a?.element==="C")&&r++}}),r}},{name:"carboxyl",displayName:"Carboxyl (-COOH)",icon:"ðŸ§ª",drugRelevance:"Acidic, increases solubility",pattern:(e,t,r)=>{let n=0;return e.forEach(a=>{if("C"===a.element){let o=(r.get(a.id)||[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),i=t.some(t=>{if(2!==t.order)return!1;let r=t.sourceId===a.id?t.targetId:t.targetId===a.id?t.sourceId:null;return!!r&&e.find(e=>e.id===r)?.element==="O"}),s=o.some(t=>t?.element==="O"&&(r.get(t.id)||[]).some(t=>e.find(e=>e.id===t)?.element==="H"));i&&s&&n++}}),n}},{name:"amine",displayName:"Amine (-NHâ‚‚/-NHR)",icon:"ðŸ”µ",drugRelevance:"Basic, H-bond donor",pattern:(e,t,r)=>{let n=0;return e.forEach(a=>{if("N"===a.element){let o=(r.get(a.id)||[]).some(t=>e.find(e=>e.id===t)?.element==="H"),i=C(a.id,t);o&&i.totalOrder<=3&&!t.some(t=>{if(2!==t.order)return!1;let r=t.sourceId===a.id?t.targetId:t.targetId===a.id?t.sourceId:null;return r&&e.find(e=>e.id===r)?.element==="C"})&&n++}}),n}},{name:"amide",displayName:"Amide (-CONHâ‚‚)",icon:"ðŸ”—",drugRelevance:"Peptide bond mimic, stable",pattern:(e,t,r)=>{let n=0;return e.forEach(a=>{if("C"===a.element){let o=r.get(a.id)||[],i=t.some(t=>{if(2!==t.order)return!1;let r=t.sourceId===a.id?t.targetId:t.targetId===a.id?t.sourceId:null;return r&&e.find(e=>e.id===r)?.element==="O"}),s=o.some(r=>{let n=e.find(e=>e.id===r);if(n?.element!=="N")return!1;let o=t.find(e=>e.sourceId===a.id&&e.targetId===r||e.targetId===a.id&&e.sourceId===r);return o?.order===1});i&&s&&n++}}),n}},{name:"ether",displayName:"Ether (C-O-C)",icon:"â­•",drugRelevance:"Increases lipophilicity",pattern:(e,t,r)=>{let n=0;return e.forEach(a=>{if("O"===a.element){let o=r.get(a.id)||[];2===C(a.id,t).totalOrder&&2===o.length&&o.every(t=>e.find(e=>e.id===t)?.element==="C")&&n++}}),n}},{name:"ester",displayName:"Ester (-COO-)",icon:"ðŸ‹",drugRelevance:"Prodrug linkage, good absorption",pattern:(e,t,r)=>{let n=0;return e.forEach(a=>{if("C"===a.element){let o=r.get(a.id)||[],i=!1,s=!1;o.forEach(n=>{let o=e.find(e=>e.id===n);if(!o)return;let l=t.find(e=>e.sourceId===a.id&&e.targetId===n||e.targetId===a.id&&e.sourceId===n);"O"===o.element&&l?.order===2&&(i=!0),"O"===o.element&&l?.order===1&&(r.get(n)||[]).some(t=>t!==a.id&&e.find(e=>e.id===t)?.element==="C")&&(s=!0)}),i&&s&&n++}}),n}},{name:"halogen",displayName:"Halogen (F/Cl/Br/I)",icon:"ðŸŸ¢",drugRelevance:"Metabolic stability, lipophilicity",pattern:e=>e.filter(e=>["F","Cl","Br","I"].includes(e.element)).length},{name:"thiol",displayName:"Thiol (-SH)",icon:"ðŸŸ¡",drugRelevance:"Reactive, covalent drug target",pattern:(e,t,r)=>{let n=0;return e.forEach(t=>{"S"===t.element&&(r.get(t.id)||[]).some(t=>e.find(e=>e.id===t)?.element==="H")&&n++}),n}},{name:"phosphate",displayName:"Phosphate (-POâ‚„)",icon:"ðŸŸ ",drugRelevance:"Energy transfer, nucleotides",pattern:(e,t,r)=>{let n=0;return e.forEach(t=>{"P"===t.element&&(r.get(t.id)||[]).filter(t=>e.find(e=>e.id===t)?.element==="O").length>=3&&n++}),n}}];function C(e,t){let r=t.filter(t=>t.sourceId===e||t.targetId===e);return{count:r.length,totalOrder:r.reduce((e,t)=>e+t.order,0)}}function _(e,t){var r;let n,a,o,i,s,l,c,d,u,m,p=[],f=[],g=0;if(0===e.length)return{valid:!1,errors:["Molecule is empty"],warnings:[],score:0};let y=(a=new Map,e.forEach(e=>a.set(e.id,[])),t.forEach(e=>{a.get(e.sourceId)?.push(e.targetId),a.get(e.targetId)?.push(e.sourceId)}),a),_=function(e,t){if(0===e.length||1===e.length)return!0;let r=new Set,n=[e[0].id];for(;n.length>0;){let e=n.shift();r.has(e)||(r.add(e),(t.get(e)||[]).forEach(e=>{r.has(e)||n.push(e)}))}return r.size===e.length}(e,y);_||f.push("âš ï¸ Molecule has disconnected fragments");let v=!0;e.forEach(e=>{let r=C(e.id,t),n=h[e.element];if(!n){p.push(`Unknown element: ${e.element}`),v=!1;return}if(!n.valence.includes(r.totalOrder)){v=!1;let t=`${n.name} #${e.id.toString().slice(-4)}`,a=r.totalOrder,o=n.valence.join(" or ");0===a?p.push(`${t} has no bonds (needs ${o})`):a<Math.min(...n.valence)?p.push(`${t} needs more bonds: has ${a}, needs ${o}`):a>Math.max(...n.valence)?p.push(`${t} has too many bonds: has ${a}, max is ${Math.max(...n.valence)}`):p.push(`${t} has ${a} bonds (needs exactly ${o})`)}"C"===e.element&&3===r.totalOrder&&f.push("Carbon atom may be a carbocation (unstable)")});let S=(o=[],i=new Set,e.forEach(r=>{i.has(r.id)||(!function r(n,a,s){if(!(s.length>7))for(let l of y.get(n)||[]){if(l===a)continue;let c=s.indexOf(l);if(-1!==c){let r=s.slice(c),n=r.length;if(n>=3&&n<=7){let a=[...r].sort((e,t)=>e-t).join(",");if(!o.some(e=>[...e.atomIds].sort((e,t)=>e-t).join(",")===a)){let a=function(e,t,r){if(6!==e.length&&5!==e.length)return!1;let n=e.map(e=>t.find(t=>t.id===e)).filter(Boolean);if(n.length!==e.length)return!1;let a=["C","N","O","S"];if(!n.every(e=>a.includes(e.element)))return!1;let o=0;for(let t=0;t<e.length;t++){let n=e[t],a=e[(t+1)%e.length],i=r.find(e=>e.sourceId===n&&e.targetId===a||e.sourceId===a&&e.targetId===n);i?.order===2&&o++}return 6===e.length&&!!(o>=2)||5===e.length&&!!(o>=2)}(r,e,t);o.push({size:n,atomIds:r,isAromatic:a})}}}else i.has(l)||r(l,n,[...s,l])}}(r.id,null,[r.id]),i.add(r.id))}),o);S.forEach(e=>{3===e.size?f.push(`âš ï¸ 3-membered ring detected (high ring strain)`):4===e.size&&f.push(`âš ï¸ 4-membered ring detected (moderate ring strain)`)});let A=[],j=0;x.forEach(r=>{let n=r.pattern(e,t,y);n>0&&(j+=n,A.push(`${r.icon} ${r.displayName}${n>1?` (\xd7${n})`:""}`))});let w=(s={},e.forEach(e=>{s[e.element]=(s[e.element]||0)+1}),Object.keys(s).sort((e,t)=>"C"===e?-1:"C"===t?1:"H"===e?-1:"H"===t?1:e.localeCompare(t)).map(e=>`${e}${s[e]>1?s[e]:""}`).join("")),E=e.reduce((e,t)=>{let r=h[t.element];return e+(r?.mass||0)},0),O=e.filter(e=>"H"!==e.element).length,N=(l=0,t.forEach(t=>{if(1!==t.order)return;let r=e.find(e=>e.id===t.sourceId),n=e.find(e=>e.id===t.targetId);if(!r||!n||"H"===r.element||"H"===n.element)return;let a=y.get(r.id)?.length||0,o=y.get(n.id)?.length||0;a>1&&o>1&&l++}),l),R=(c=0,e.forEach(t=>{("O"===t.element||"N"===t.element)&&(y.get(t.id)||[]).some(t=>e.find(e=>e.id===t)?.element==="H")&&c++}),c),M=e.filter(e=>"O"===e.element||"N"===e.element).length,I=S.some(e=>e.isAromatic),k=(r=j,d=Math.min(2*e.length,30),u=Math.min(1.5*t.length,20),m=Math.min(10*S.length,25),Math.min(100,Math.round(d+u+m+5*S.filter(e=>e.isAromatic).length+Math.min(5*r,20)))),z={atomCount:e.length,bondCount:t.length,heavyAtomCount:O,rotableBonds:N,hBondDonors:R,hBondAcceptors:M,isConnected:_,hasAromaticRing:I,complexity:k};if(v){let t=b.find(e=>e.formula===w);t?(n=t.name,g=t.score,t.description&&f.unshift(`ðŸ’Š ${t.description}`)):(n="Valid Unknown Compound",g=Math.round(8*e.length+20*S.length+15*j+50*!!I)),I&&f.unshift("ðŸ”µ Contains aromatic ring system"),E<=500&&R<=5&&M<=10?O>=5&&(f.unshift("âœ… Passes Lipinski drug-likeness criteria"),g+=25):E>500&&f.push("âš ï¸ Molecular weight >500 (may have poor absorption)")}return{valid:v,errors:p,warnings:f,score:g,name:n,formula:w,molecularWeight:Math.round(100*E)/100,functionalGroups:A,rings:S,properties:z}}let v={H:[1],B:[3],C:[4],N:[3,4,5],O:[2],P:[3,5],S:[2,4,6],F:[1],Cl:[1],Br:[1],I:[1]},S=new Set(["B","C","N","O","P","S","F","Cl","Br","I"]),A={c:"C",n:"N",o:"O",s:"S",p:"P"};function j(e,t){return e[t.pos]||""}function w(e,t){return e[t.pos++]||""}function E(e,t){let r="";for(;t.pos<e.length&&/[0-9]/.test(e[t.pos]);)r+=w(e,t);return r?parseInt(r,10):null}function O(e,t,r,n){!e.bonds.some(e=>e.source===t&&e.target===r||e.source===r&&e.target===t)&&t!==r&&t>=0&&r>=0&&e.bonds.push({source:t,target:r,order:n})}let N={"C-C":1.54,"C=C":1.34,"C#C":1.2,"C-N":1.47,"C=N":1.29,"C#N":1.16,"C-O":1.43,"C=O":1.23,"C-S":1.82,"C=S":1.71,"C-H":1.09,"C-F":1.35,"C-Cl":1.77,"C-Br":1.94,"C-I":2.14,"N-N":1.45,"N=N":1.25,"N#N":1.1,"N-O":1.4,"N=O":1.21,"N-H":1.01,"O-O":1.48,"O=O":1.21,"O-H":.96,"S-S":2.05,"S-H":1.34,"P-O":1.63,"P=O":1.48,"P-H":1.42,DEFAULT:1.5};function R(e,t,r){let[n,a]=[e,t].sort(),o=`${n}${1===r?"-":2===r?"=":"#"}${a}`,i=`${n}-${a}`;return N[o]||N[i]||N.DEFAULT}let M=[{x:1,y:1,z:1},{x:1,y:-1,z:-1},{x:-1,y:1,z:-1},{x:-1,y:-1,z:1}].map(e=>{let t=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);return{x:e.x/t,y:e.y/t,z:e.z/t}}),I=[{x:1,y:0,z:0},{x:-.5,y:Math.sqrt(3)/2,z:0},{x:-.5,y:-Math.sqrt(3)/2,z:0}],k=[{x:1,y:0,z:0},{x:-1,y:0,z:0}];function z(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function T(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}}function H(e,t){return{x:e.x*t,y:e.y*t,z:e.z*t}}function P(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}function B(e){let t=P(e)||1;return{x:e.x/t,y:e.y/t,z:e.z/t}}function L(e,t){return{x:e.y*t.z-e.z*t.y,y:e.z*t.x-e.x*t.z,z:e.x*t.y-e.y*t.x}}function F(e,t){let r=new Map;for(let t=0;t<e;t++)r.set(t,[]);return t.forEach(e=>{r.get(e.source)?.push({neighbor:e.target,order:e.order}),r.get(e.target)?.push({neighbor:e.source,order:e.order})}),r}function G(e,t,r){let n=t.filter(t=>t.source===e||t.target===e),a=n.some(e=>3===e.order),o=n.filter(e=>2===e.order).length;return a?"sp":o>=1?"sp2":"sp3"}function D(e){if(!(e=e.trim()))return{success:!1,atoms:[],bonds:[],error:"Empty SMILES string"};let t={pos:0,atoms:[],bonds:[],ringClosures:new Map,branchStack:[],lastAtomIndex:-1,pendingBondOrder:0};try{for(var r,n;t.pos<e.length;){let r=j(e,t);if(/\s/.test(r)||"/"===r||"\\"===r){w(e,t);continue}if("-"===r||"="===r||"#"===r||":"===r){t.pendingBondOrder=function(e,t){switch(j(e,t)){case"-":case":":return w(e,t),1;case"=":return w(e,t),2;case"#":return w(e,t),3;default:return 0}}(e,t);continue}if("("===r){w(e,t),t.branchStack.push(t.lastAtomIndex);continue}if(")"===r){w(e,t),t.branchStack.length>0&&(t.lastAtomIndex=t.branchStack.pop());continue}if("."===r){w(e,t),t.lastAtomIndex=-1;continue}let n=function(e,t){let r=j(e,t);return/[0-9]/.test(r)?(w(e,t),parseInt(r,10)):"%"===r?(w(e,t),E(e,t)):null}(e,t);if(null!==n){let e=t.pendingBondOrder||1;if(t.pendingBondOrder=0,t.ringClosures.has(n)){let r=t.ringClosures.get(n),a=Math.max(r.bondOrder,e);O(t,r.atomIndex,t.lastAtomIndex,a),t.ringClosures.delete(n)}else t.ringClosures.set(n,{atomIndex:t.lastAtomIndex,bondOrder:e});continue}if("["===r){w(e,t);let r=function(e,t){let r=null,n="",a=!1,o=null,i=0,s=E(e,t);null!==s&&(r=s);let l=w(e,t);if(!l)return null;if(l===l.toLowerCase()&&A[l])a=!0,n=A[l];else{n=l.toUpperCase();let r=j(e,t);r&&r===r.toLowerCase()&&/[a-z]/.test(r)&&(n+=w(e,t))}for(;t.pos<e.length&&"]"!==j(e,t);){let r=j(e,t);if("H"===r){w(e,t);let r=E(e,t);o=null!==r?r:1}else if("+"===r){w(e,t);let r=E(e,t);i=null!==r?r:1}else if("-"===r){w(e,t);let r=E(e,t);i=-(null!==r?r:1)}else"@"===r?(w(e,t),"@"===j(e,t)&&w(e,t)):w(e,t)}return"]"===j(e,t)&&w(e,t),{element:n,aromatic:a,charge:i,hCount:o,isotope:r}}(e,t);if(!r)return{success:!1,atoms:[],bonds:[],error:`Invalid bracket atom at position ${t.pos}`};let n=t.atoms.length;if(t.atoms.push(r),t.lastAtomIndex>=0){let e=t.pendingBondOrder||1;O(t,t.lastAtomIndex,n,e)}t.pendingBondOrder=0,t.lastAtomIndex=n;continue}let a=function(e,t){let r=j(e,t);if(A[r])return w(e,t),{element:A[r],aromatic:!0,charge:0,hCount:null,isotope:null};let n=e.slice(t.pos,t.pos+2);if("Cl"===n||"Br"===n)return t.pos+=2,{element:n,aromatic:!1,charge:0,hCount:null,isotope:null};let a=r.toUpperCase();return S.has(a)&&r===a?(w(e,t),{element:a,aromatic:!1,charge:0,hCount:null,isotope:null}):null}(e,t);if(a){let e=t.atoms.length;if(t.atoms.push(a),t.lastAtomIndex>=0){let r=t.pendingBondOrder||(a.aromatic&&t.atoms[t.lastAtomIndex]?.aromatic,1);O(t,t.lastAtomIndex,e,r)}t.pendingBondOrder=0,t.lastAtomIndex=e;continue}return{success:!1,atoms:[],bonds:[],error:`Unexpected character '${r}' at position ${t.pos}`}}if(t.ringClosures.size>0){let e=Array.from(t.ringClosures.keys()).join(", ");return{success:!1,atoms:[],bonds:[],error:`Unclosed ring(s): ${e}`}}let a=(r=t.atoms,n=t.bonds,r.map((e,t)=>{if(null!==e.hCount)return e.hCount;let r=n.filter(e=>e.source===t||e.target===t).reduce((e,t)=>e+t.order,0),a=v[e.element]||[0],o=a.find(e=>e>=r)||a[a.length-1];return Math.max(0,o-r-!!e.aromatic)})),o=[...t.atoms],i=[...t.bonds];a.forEach((e,t)=>{for(let r=0;r<e;r++){let e=o.length;o.push({element:"H",aromatic:!1,charge:0,hCount:0,isotope:null}),i.push({source:t,target:e,order:1})}});let s=o.map(e=>e.element),l=function(e,t,r){let n;if(0===e)return[];if(1===e)return[{x:0,y:0,z:0}];let a=Array(e).fill(null).map(()=>({x:0,y:0,z:0})),o=new Set,i=F(e,t),s=(n=Array(e).fill(0),t.forEach(e=>{n[e.source]++,n[e.target]++}),n),l=function(e,t){let r=new Map;for(let t=0;t<e;t++)r.set(t,[]);t.forEach(e=>{r.get(e.source)?.push(e.target),r.get(e.target)?.push(e.source)});let n=[],a=new Set;for(let t=0;t<e;t++)a.has(t)||(!function e(t,o,i){if(!(i.length>8))for(let s of r.get(t)||[]){if(s===o)continue;let r=i.indexOf(s);if(-1!==r){let e=i.slice(r);if(e.length>=3&&e.length<=7){let t=[...e].sort((e,t)=>e-t).join(",");n.some(e=>[...e].sort((e,t)=>e-t).join(",")===t)||n.push(e)}}else a.has(s)||e(s,t,[...i,s])}}(t,-1,[t]),a.add(t));return n}(e,t),c=new Set;l.forEach(e=>e.forEach(e=>c.add(e)));let d=0,u=-1;for(let t=0;t<e;t++){let e=s[t]*("H"===r[t]?.1:1);e>u&&(u=e,d=t)}a[d]={x:0,y:0,z:0},o.add(d);let m=[d],h=new Map;for(;m.length>0;){let e,n=m.shift(),s=i.get(n)||[],c=a[n],d=G(n,t,r[n]),u=s.filter(e=>o.has(e.neighbor)),p=s.filter(e=>!o.has(e.neighbor));if(0===p.length)continue;let f={x:1,y:0,z:0},g={x:0,y:0,z:1};switch(u.length>0&&(g=.9>Math.abs((f=B(T(a[u[0].neighbor],c))).z)?B(L(f,{x:0,y:0,z:1})):B(L(f,{x:1,y:0,z:0}))),d){case"sp":e=k;break;case"sp2":e=I;break;default:e=M}let y=L(g,f),b=u.length;for(let t of p){let i,s=t.neighbor,d=t.order,u=R(r[n],r[s],d),p=l.find(e=>e.includes(n)&&e.includes(s));if(p&&p.length>=5&&p.length<=6){let e=p.length;p.indexOf(n);let t=p.indexOf(s),r=2*Math.PI/e*t;i={x:Math.cos(r),y:Math.sin(r),z:0}}else{let t=e[b%e.length];i=B({x:t.x*f.x+t.y*g.x+t.z*y.x,y:t.x*f.y+t.y*g.y+t.z*y.y,z:t.x*f.z+t.y*g.z+t.z*y.z}),b++}a[s]=z(c,H(i,u)),o.add(s),m.push(s),h.has(n)||h.set(n,[]),h.get(n).push(i)}}for(let t=0;t<e;t++)o.has(t)||(a[t]={x:(Math.random()-.5)*5,y:(Math.random()-.5)*5,z:(Math.random()-.5)*5},o.add(t));!function(e,t,r,n){let a=e.length,o=e.map(()=>({x:0,y:0,z:0})),i=F(a,t);for(let n=0;n<80;n++){let n=e.map(()=>({x:0,y:0,z:0}));t.forEach(t=>{let a=t.source,o=t.target,i=R(r[a],r[o],t.order),s=T(e[o],e[a]),l=P(s)+.001-i,c=B(s),d=H(c,.15*l);n[a]=z(n[a],d),n[o]=T(n[o],d)});for(let o=0;o<a;o++)for(let i=o+1;i<a;i++){let a=t.some(e=>e.source===o&&e.target===i||e.source===i&&e.target===o),s=T(e[o],e[i]),l=P(s)+.001,c=a?0:"H"===r[o]||"H"===r[i]?1.5:2.5;if(!a&&l<c){let e=B(s),t=H(e,1.5*(c-l)/l);n[o]=z(n[o],t),n[i]=T(n[i],t)}}for(let o=0;o<a;o++){let a,s=i.get(o)||[];if(!(s.length<2)){switch(G(o,t,r[o])){case"sp":a=Math.PI;break;case"sp2":a=2*Math.PI/3;break;default:a=Math.acos(-1/3)}for(let t=0;t<s.length;t++)for(let r=t+1;r<s.length;r++){let i=s[t].neighbor,l=s[r].neighbor,c=B(T(e[i],e[o])),d=B(T(e[l],e[o])),u=Math.acos(Math.max(-1,Math.min(1,c.x*d.x+c.y*d.y+c.z*d.z)))-a;if(Math.abs(u)>.1){let e=.05*u,t=B(L(c,d)),r=L(t,c),a=L(d,t);n[i]=z(n[i],H(r,e)),n[l]=z(n[l],H(a,e))}}}}for(let t=0;t<a;t++){o[t]=H(z(o[t],n[t]),.85);let r=P(o[t]);r>.5&&(o[t]=H(o[t],.5/r)),e[t]=z(e[t],o[t])}}}(a,t,r,80);let p={x:0,y:0,z:0};return a.forEach(e=>{p.x+=e.x,p.y+=e.y,p.z+=e.z}),p.x/=e,p.y/=e,p.z/=e,a.map(e=>({x:Math.round((e.x-p.x)*100)/100,y:Math.round((e.y-p.y)*100)/100,z:Math.round((e.z-p.z)*100)/100}))}(o.length,i,s),c=o.map((e,t)=>({id:Date.now()+t,element:e.element,x:l[t]?.x||0,y:l[t]?.y||0,z:l[t]?.z||0})),d=i.map((e,t)=>({id:Date.now()+1e3+t,sourceId:c[e.source]?.id||0,targetId:c[e.target]?.id||0,order:e.order}));return{success:!0,atoms:c,bonds:d}}catch(e){return{success:!1,atoms:[],bonds:[],error:`Parse error: ${e instanceof Error?e.message:"Unknown error"}`}}}let $=[{name:"Water",smiles:"O",category:"Simple"},{name:"Ammonia",smiles:"N",category:"Simple"},{name:"Methane",smiles:"C",category:"Simple"},{name:"Carbon Dioxide",smiles:"O=C=O",category:"Simple"},{name:"Hydrogen Peroxide",smiles:"OO",category:"Simple"},{name:"Ethane",smiles:"CC",category:"Alkanes"},{name:"Propane",smiles:"CCC",category:"Alkanes"},{name:"Butane",smiles:"CCCC",category:"Alkanes"},{name:"Isobutane",smiles:"CC(C)C",category:"Alkanes"},{name:"Methanol",smiles:"CO",category:"Alcohols"},{name:"Ethanol",smiles:"CCO",category:"Alcohols"},{name:"Isopropanol",smiles:"CC(O)C",category:"Alcohols"},{name:"Glycerol",smiles:"OCC(O)CO",category:"Alcohols"},{name:"Benzene",smiles:"c1ccccc1",category:"Aromatics"},{name:"Toluene",smiles:"Cc1ccccc1",category:"Aromatics"},{name:"Phenol",smiles:"Oc1ccccc1",category:"Aromatics"},{name:"Aniline",smiles:"Nc1ccccc1",category:"Aromatics"},{name:"Aspirin",smiles:"CC(=O)Oc1ccccc1C(=O)O",category:"Drugs"},{name:"Paracetamol",smiles:"CC(=O)Nc1ccc(O)cc1",category:"Drugs"},{name:"Caffeine",smiles:"Cn1cnc2c1c(=O)n(C)c(=O)n2C",category:"Drugs"},{name:"Ibuprofen",smiles:"CC(C)Cc1ccc(C(C)C(=O)O)cc1",category:"Drugs"},{name:"Glycine",smiles:"NCC(=O)O",category:"Amino Acids"},{name:"Alanine",smiles:"CC(N)C(=O)O",category:"Amino Acids"},{name:"Serine",smiles:"NC(CO)C(=O)O",category:"Amino Acids"}];var K=e.i(94438),V=e.i(32341),U=e.i(10272),Y=e.i(37902);function W({userLevel:e,onSelectMission:r,currentMissionId:n}){let a=[...g.SYLLABUS_DATA].sort((e,t)=>e.level-t.level);return(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"20px"},children:[(0,t.jsx)("h3",{style:{margin:0,fontSize:"0.85rem",fontWeight:700,color:"#9ca3af",textTransform:"uppercase",letterSpacing:"0.5px"},children:"ðŸ—ºï¸ Syllabus Map"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",overflowX:"auto",paddingBottom:"4px",maskImage:"linear-gradient(to right, black 85%, transparent 100%)",WebkitMaskImage:"linear-gradient(to right, black 85%, transparent 100%)"},className:"jsx-e904ed44d668d0c7 no-scrollbar",children:[(0,t.jsx)(Y.default,{id:"e904ed44d668d0c7",children:".no-scrollbar.jsx-e904ed44d668d0c7::-webkit-scrollbar{display:none}.no-scrollbar.jsx-e904ed44d668d0c7{-ms-overflow-style:none;scrollbar-width:none}"}),a.map(a=>{let o=a.level>e,i=a.level===n,s=a.level<e;return(0,t.jsxs)("div",{onClick:()=>!o&&r(a),style:{minWidth:"120px",padding:"10px",borderRadius:"10px",background:i?"#2563eb":"#1f2937",border:i?"1px solid #60a5fa":"1px solid #374151",cursor:o?"not-allowed":"pointer",opacity:o?.5:1,display:"flex",flexDirection:"column",gap:"2px",position:"relative",transition:"all 0.2s",transform:i?"scale(1.02)":"scale(1)"},className:"jsx-e904ed44d668d0c7",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},className:"jsx-e904ed44d668d0c7",children:[(0,t.jsx)("span",{style:{fontSize:"0.65rem",fontWeight:"bold",color:i?"#e0e7ff":"#6b7280",textTransform:"uppercase"},className:"jsx-e904ed44d668d0c7",children:a.semester}),o&&(0,t.jsx)("span",{style:{fontSize:"0.7rem"},className:"jsx-e904ed44d668d0c7",children:"ðŸ”’"}),s&&(0,t.jsx)("span",{style:{fontSize:"0.7rem"},className:"jsx-e904ed44d668d0c7",children:"âœ…"})]}),(0,t.jsx)("div",{style:{fontSize:"0.85rem",fontWeight:"600",color:i?"#fff":"#e5e7eb",lineHeight:"1.2",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"jsx-e904ed44d668d0c7",children:a.moleculeTemplate.name}),i&&(0,t.jsx)("div",{style:{height:"2px",background:"#fff",marginTop:"6px",borderRadius:"1px",opacity:.5},className:"jsx-e904ed44d668d0c7"})]},a.level)})]}),(0,t.jsxs)("div",{style:{fontSize:"0.75rem",color:"#9ca3af",background:"#151921",padding:"10px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)",lineHeight:"1.4"},children:[(0,t.jsx)("span",{style:{color:"#60a5fa",fontWeight:600},children:"Objective:"})," ",g.SYLLABUS_DATA.find(t=>t.level===e)?.learningObjective||"Master the syllabus."]})]})}var X=e.i(51865);let q=[{name:"Hydroxyl (-OH)",structure:"R-O-H",icon:"ðŸ’§",description:"An oxygen atom bonded to a hydrogen. Found in alcohols and phenols.",drugRelevance:"Increases water solubility (hydrophilicity), enables hydrogen bonding for receptor binding.",examples:["Ethanol (CCO)","Phenol (Oc1ccccc1)"],color:"#60a5fa"},{name:"Carbonyl (C=O)",structure:"R-C(=O)-R",icon:"âš—ï¸",description:"A carbon double-bonded to oxygen. The defining feature of aldehydes, ketones, esters, and amides.",drugRelevance:"Reactive center for drug metabolism, hydrogen bond acceptor.",examples:["Acetone (CC(=O)C)","Formaldehyde (C=O)"],color:"#f59e0b"},{name:"Carboxyl (-COOH)",structure:"R-C(=O)-O-H",icon:"ðŸ§ª",description:"A carbonyl attached to a hydroxyl group. Found in carboxylic acids.",drugRelevance:"Acidic (pKa ~4-5), ionizes at physiological pH, increases water solubility.",examples:["Acetic Acid (CC(=O)O)","Aspirin (CC(=O)Oc1ccccc1C(=O)O)"],color:"#ef4444"},{name:"Amine (-NHâ‚‚)",structure:"R-N-Hâ‚‚",icon:"ðŸ”µ",description:"A nitrogen atom with hydrogen(s) attached. Can be primary, secondary, or tertiary.",drugRelevance:"Basic (pKa ~9-11), protonated at physiological pH, hydrogen bond donor.",examples:["Methylamine (CN)","Aniline (Nc1ccccc1)"],color:"#3b82f6"},{name:"Amide (-CONHâ‚‚)",structure:"R-C(=O)-N-Hâ‚‚",icon:"ðŸ”—",description:"A carbonyl attached to a nitrogen. The peptide bond is an amide.",drugRelevance:"Very stable, resistant to metabolism, mimics peptide bonds in proteins.",examples:["Acetamide (CC(=O)N)","Paracetamol (CC(=O)Nc1ccc(O)cc1)"],color:"#8b5cf6"},{name:"Ether (C-O-C)",structure:"R-O-R",icon:"â­•",description:"An oxygen between two carbon groups. Generally stable and non-reactive.",drugRelevance:"Increases lipophilicity, good for crossing cell membranes.",examples:["Diethyl Ether (CCOCC)","Anisole (COc1ccccc1)"],color:"#06b6d4"},{name:"Ester (-COO-)",structure:"R-C(=O)-O-R",icon:"ðŸ‹",description:"A carbonyl attached to an oxygen with an R group. Common in fats and flavors.",drugRelevance:"Used in prodrugs - can be cleaved by esterases to release active drug.",examples:["Ethyl Acetate (CCOC(=O)C)","Aspirin ester group"],color:"#84cc16"},{name:"Halogen (F/Cl/Br/I)",structure:"R-X",icon:"ðŸŸ¢",description:"Fluorine, chlorine, bromine, or iodine attached to a carbon.",drugRelevance:"F increases metabolic stability, Cl/Br add lipophilicity, useful for PET imaging (18F).",examples:["Chloroform (ClC(Cl)Cl)","Fluorobenzene (Fc1ccccc1)"],color:"#22c55e"},{name:"Thiol (-SH)",structure:"R-S-H",icon:"ðŸŸ¡",description:"A sulfur with a hydrogen. Also called mercaptan. Very reactive.",drugRelevance:"Can form covalent bonds with cysteine residues, used in covalent drugs.",examples:["Methanethiol (CS)","Cysteine (NC(CS)C(=O)O)"],color:"#eab308"},{name:"Aromatic Ring",structure:"c1ccccc1",icon:"ðŸ”µ",description:"A planar ring of carbons with delocalized Ï€ electrons. Benzene is the prototype.",drugRelevance:"Flat, hydrophobic, can stack with other aromatics (Ï€-Ï€ stacking).",examples:["Benzene (c1ccccc1)","Naphthalene (c1ccc2ccccc2c1)"],color:"#a78bfa"}],Z=[{name:"Single Bond",symbol:"-",electrons:2,description:"One pair of shared electrons. Allows free rotation around the bond axis.",examples:["C-C in ethane","C-H in methane"],strength:"Medium (347 kJ/mol for C-C)"},{name:"Double Bond",symbol:"=",electrons:4,description:"Two pairs of shared electrons (1 sigma + 1 pi). Restricts rotation, creates geometric isomers.",examples:["C=C in ethylene","C=O in aldehydes"],strength:"Strong (614 kJ/mol for C=C)"},{name:"Triple Bond",symbol:"â‰¡",electrons:6,description:"Three pairs of shared electrons (1 sigma + 2 pi). Very strong and linear.",examples:["Câ‰¡C in acetylene","Câ‰¡N in nitriles"],strength:"Very Strong (839 kJ/mol for Câ‰¡C)"},{name:"Aromatic Bond",symbol:"â—¯",electrons:1.5,description:"Delocalized electrons shared across a ring. Bond order is between single and double.",examples:["Benzene ring","Pyridine ring"],strength:"Intermediate (resonance stabilized)"}],Q=[{title:"ðŸŽ¯ Start with Carbon",tip:"Carbon forms 4 bonds and is the backbone of organic molecules. Place carbons first, then add other atoms."},{title:"âš¡ Watch Your Valence",tip:"Each element has a specific number of bonds it needs: H=1, O=2, N=3, C=4. The validation panel shows errors if bonds are wrong."},{title:"ðŸ”„ Use Bond Mode",tip:"After placing atoms, switch to Bond Mode to connect them. Click two atoms to create a bond. Click existing bonds to increase their order."},{title:"ðŸ—‘ï¸ Delete Mode",tip:"Use Delete Mode to remove atoms or bonds. Clicking an atom removes it and all its bonds."},{title:"ðŸ’Š Drug-like Molecules",tip:"For pharmaceutical compounds, follow Lipinski's Rule of 5: MW â‰¤ 500, H-bond donors â‰¤ 5, H-bond acceptors â‰¤ 10."},{title:"ðŸ”µ Aromatic Rings",tip:"To build benzene, create 6 carbons in a ring with alternating single and double bonds. The system will detect aromaticity."},{title:"ðŸ“ SMILES Input",tip:"Use the SMILES tab to quickly generate molecules from SMILES notation. Great for importing known structures!"},{title:"ðŸ§¬ Load Templates",tip:"Use the mission system to load pre-built molecule templates as starting points for modifications."}],J=[{syntax:"C, N, O, S, P, F, Cl, Br, I",description:"Organic atoms (implicit H added)"},{syntax:"c, n, o, s",description:"Aromatic atoms (lowercase)"},{syntax:"[NH4+], [O-], [Fe]",description:"Bracket atoms (charges, metals)"},{syntax:"- = #",description:"Single, double, triple bonds"},{syntax:"()",description:"Branches (side chains)"},{syntax:"1, 2, %10",description:"Ring closures"},{syntax:".",description:"Disconnected fragments"}];function ee({isOpen:e,onClose:r}){let[a,o]=(0,n.useState)("elements"),[i,s]=(0,n.useState)(null);if(!e)return null;let l=Object.entries(h);return(0,t.jsx)("div",{className:X.default.overlay,onClick:r,children:(0,t.jsxs)("div",{className:X.default.panel,onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:X.default.header,children:[(0,t.jsx)("h2",{className:X.default.title,children:"ðŸ“š Chemistry Reference"}),(0,t.jsx)("button",{className:X.default.closeBtn,onClick:r,children:"Ã—"})]}),(0,t.jsxs)("div",{className:X.default.tabs,children:[(0,t.jsx)("button",{className:`${X.default.tab} ${"elements"===a?X.default.activeTab:""}`,onClick:()=>o("elements"),children:"ðŸ§ª Elements"}),(0,t.jsx)("button",{className:`${X.default.tab} ${"bonds"===a?X.default.activeTab:""}`,onClick:()=>o("bonds"),children:"ðŸ”— Bonds"}),(0,t.jsx)("button",{className:`${X.default.tab} ${"groups"===a?X.default.activeTab:""}`,onClick:()=>o("groups"),children:"ðŸ§¬ Groups"}),(0,t.jsx)("button",{className:`${X.default.tab} ${"smiles"===a?X.default.activeTab:""}`,onClick:()=>o("smiles"),children:"ðŸ“ SMILES"}),(0,t.jsx)("button",{className:`${X.default.tab} ${"tips"===a?X.default.activeTab:""}`,onClick:()=>o("tips"),children:"ðŸ’¡ Tips"})]}),(0,t.jsxs)("div",{className:X.default.content,children:["elements"===a&&(0,t.jsxs)("div",{className:X.default.elementsGrid,children:[l.map(([e,r])=>(0,t.jsxs)("div",{className:`${X.default.elementCard} ${i===e?X.default.selected:""}`,onClick:()=>s(i===e?null:e),style:{borderColor:`#${r.color.toString(16).padStart(6,"0")}`},children:[(0,t.jsx)("div",{className:X.default.elementSymbol,style:{color:`#${r.color.toString(16).padStart(6,"0")}`},children:e}),(0,t.jsx)("div",{className:X.default.elementName,children:r.name}),(0,t.jsxs)("div",{className:X.default.elementNumber,children:["#",r.atomicNumber]})]},e)),i&&h[i]&&(0,t.jsxs)("div",{className:X.default.elementDetail,children:[(0,t.jsxs)("h4",{style:{color:`#${h[i].color.toString(16).padStart(6,"0")}`},children:[h[i].name," (",i,")"]}),(0,t.jsxs)("div",{className:X.default.detailGrid,children:[(0,t.jsxs)("div",{className:X.default.detailItem,children:[(0,t.jsx)("span",{className:X.default.detailLabel,children:"Atomic Number"}),(0,t.jsx)("span",{className:X.default.detailValue,children:h[i].atomicNumber})]}),(0,t.jsxs)("div",{className:X.default.detailItem,children:[(0,t.jsx)("span",{className:X.default.detailLabel,children:"Atomic Mass"}),(0,t.jsxs)("span",{className:X.default.detailValue,children:[h[i].mass," u"]})]}),(0,t.jsxs)("div",{className:X.default.detailItem,children:[(0,t.jsx)("span",{className:X.default.detailLabel,children:"Valence"}),(0,t.jsx)("span",{className:X.default.detailValue,children:h[i].valence.join(", ")})]}),(0,t.jsxs)("div",{className:X.default.detailItem,children:[(0,t.jsx)("span",{className:X.default.detailLabel,children:"Radius"}),(0,t.jsxs)("span",{className:X.default.detailValue,children:[h[i].radius," Ã…"]})]})]})]})]}),"bonds"===a&&(0,t.jsx)("div",{className:X.default.bondsList,children:Z.map((e,r)=>(0,t.jsxs)("div",{className:X.default.bondCard,children:[(0,t.jsxs)("div",{className:X.default.bondHeader,children:[(0,t.jsx)("span",{className:X.default.bondSymbol,children:e.symbol}),(0,t.jsx)("span",{className:X.default.bondName,children:e.name}),(0,t.jsxs)("span",{className:X.default.bondElectrons,children:[e.electrons," eâ»"]})]}),(0,t.jsx)("p",{className:X.default.bondDescription,children:e.description}),(0,t.jsxs)("div",{className:X.default.bondExamples,children:[(0,t.jsx)("strong",{children:"Examples:"})," ",e.examples.join(", ")]}),(0,t.jsxs)("div",{className:X.default.bondStrength,children:[(0,t.jsx)("strong",{children:"Strength:"})," ",e.strength]})]},r))}),"groups"===a&&(0,t.jsx)("div",{className:X.default.groupsList,children:q.map((e,r)=>(0,t.jsxs)("div",{className:X.default.groupCard,style:{borderLeftColor:e.color},children:[(0,t.jsxs)("div",{className:X.default.groupHeader,children:[(0,t.jsx)("span",{className:X.default.groupIcon,children:e.icon}),(0,t.jsx)("span",{className:X.default.groupName,children:e.name})]}),(0,t.jsx)("div",{className:X.default.groupStructure,children:(0,t.jsx)("code",{children:e.structure})}),(0,t.jsx)("p",{className:X.default.groupDescription,children:e.description}),(0,t.jsxs)("div",{className:X.default.groupRelevance,children:[(0,t.jsx)("strong",{children:"ðŸ’Š Drug Relevance:"})," ",e.drugRelevance]}),(0,t.jsxs)("div",{className:X.default.groupExamples,children:[(0,t.jsx)("strong",{children:"Examples:"})," ",e.examples.join(", ")]})]},r))}),"tips"===a&&(0,t.jsx)("div",{className:X.default.tipsList,children:Q.map((e,r)=>(0,t.jsxs)("div",{className:X.default.tipCard,children:[(0,t.jsx)("div",{className:X.default.tipTitle,children:e.title}),(0,t.jsx)("p",{className:X.default.tipContent,children:e.tip})]},r))}),"smiles"===a&&(0,t.jsxs)("div",{className:X.default.smilesGuide,children:[(0,t.jsx)("h4",{className:X.default.smilesTitle,children:"ðŸ“ SMILES Notation Guide"}),(0,t.jsx)("p",{className:X.default.smilesIntro,children:"SMILES (Simplified Molecular Input Line Entry System) is a way to represent molecules as text strings."}),(0,t.jsxs)("table",{className:X.default.smilesTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Syntax"}),(0,t.jsx)("th",{children:"Meaning"})]})}),(0,t.jsx)("tbody",{children:J.map((e,r)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("code",{children:e.syntax})}),(0,t.jsx)("td",{children:e.description})]},r))})]}),(0,t.jsx)("h4",{className:X.default.smilesTitle,style:{marginTop:"20px"},children:"ðŸ§ª Examples"}),(0,t.jsxs)("div",{className:X.default.smilesExamples,children:[(0,t.jsxs)("div",{className:X.default.smilesExample,children:[(0,t.jsx)("code",{children:"CCO"})," â†’ Ethanol (2 carbons + oxygen)"]}),(0,t.jsxs)("div",{className:X.default.smilesExample,children:[(0,t.jsx)("code",{children:"c1ccccc1"})," â†’ Benzene (aromatic ring)"]}),(0,t.jsxs)("div",{className:X.default.smilesExample,children:[(0,t.jsx)("code",{children:"CC(=O)O"})," â†’ Acetic acid (with carbonyl)"]}),(0,t.jsxs)("div",{className:X.default.smilesExample,children:[(0,t.jsx)("code",{children:"CC(C)C"})," â†’ Isobutane (with branch)"]}),(0,t.jsxs)("div",{className:X.default.smilesExample,children:[(0,t.jsx)("code",{children:"C1CCCCC1"})," â†’ Cyclohexane (6-ring)"]})]})]})]})]})})}var et=e.i(18566),er=e.i(72205);e.i(47167);var en=e.i(59141);e.i(61086);var ea=e.i(27215);let eo="b5830a60-e35a-4727-b311-5276cec06246",ei={paracetamol:["#4FC3F7","#29B6F6","#03A9F4","#039BE5"],aspirin:["#81C784","#66BB6A","#4CAF50","#43A047"],ibuprofen:["#FFB74D","#FFA726","#FF9800","#FB8C00"],caffeine:["#BA68C8","#AB47BC","#9C27B0","#8E24AA"],default:["#7C4DFF","#651FFF","#6200EA","#536DFE"]},es={async generateMoleculeImage(e,t,r=50,n=50,a){try{let o=a?`${a}, high quality, detailed scientific render, 8k resolution, photorealistic`:this.createMoleculePrompt(e,r,n),i=null;if(eo&&eo.length>10)try{i=await this.callAIGuruLabAPI(o)}catch(e){console.warn("AI Guru Lab API error, using procedural fallback"),i=null}i||(console.log("Generating procedural molecule SVG for:",e),i=await this.generateProceduralMolecule(e,r,n));let s="";try{s=await this.uploadToFirebase(i,t)}catch(e){console.warn("Firebase Upload Failed:",e.message),i&&(s=await new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(i)}))}return{url:s,generatedAt:Date.now(),prompt:o}}catch(e){return console.error("Failed to generate molecule image:",e),null}},createMoleculePrompt:(e,t,r)=>`Scientific 3D molecular structure visualization of ${e}, ${t>70?"high-quality, well-structured":"experimental"} ${r>70?"stable":"reactive"} pharmaceutical compound, glowing atoms, dark background, neon blue and purple accents, professional medical illustration, high detail`,async callAIGuruLabAPI(e){try{let t=await fetch("https://aigurulab.tech/api/generate-image",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":eo},body:JSON.stringify({input:e,width:1024,height:1024,model:"flux",aspectRatio:"1:1"})});if(!t.ok)return console.warn("AI Guru Lab API failed:",t.status),null;let r=await t.json();if(r.image){let e=r.image.replace(/^data:image\/\w+;base64,/,""),t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return new Blob([n],{type:"image/png"})}if(r.url){let e=await fetch(r.url);return await e.blob()}return null}catch(e){return console.warn("AI Guru Lab API error:",e),null}},async generateProceduralMolecule(e,t,r){let n=e.toLowerCase(),a=ei.default;for(let[e,t]of Object.entries(ei))if(n.includes(e)){a=t;break}let o=this.hashString(e+t+r),i=this.generateAtomPositions(o,6+t%5),s=this.generateBonds(i);return new Blob([`
            <svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512">
                <defs>
                    <radialGradient id="bg" cx="50%" cy="50%" r="70%">
                        <stop offset="0%" stop-color="#1a1a2e"/>
                        <stop offset="100%" stop-color="#0a0a15"/>
                    </radialGradient>
                    <filter id="glow">
                        <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                    <radialGradient id="atom" cx="30%" cy="30%" r="60%">
                        <stop offset="0%" stop-color="${a[0]}"/>
                        <stop offset="100%" stop-color="${a[2]}"/>
                    </radialGradient>
                </defs>
                <rect width="512" height="512" fill="url(#bg)"/>
                
                <!-- Bonds -->
                <g stroke="${a[1]}" stroke-width="3" opacity="0.7" filter="url(#glow)">
                    ${s.map(e=>`<line x1="${e.x1}" y1="${e.y1}" x2="${e.x2}" y2="${e.y2}"/>`).join("\n")}
                </g>
                
                <!-- Atoms -->
                <g filter="url(#glow)">
                    ${i.map((e,t)=>`
                        <circle cx="${e.x}" cy="${e.y}" r="${15+t%3*5}" fill="url(#atom)"/>
                        <circle cx="${e.x-4}" cy="${e.y-4}" r="${5+t%2*2}" fill="white" opacity="0.3"/>
                    `).join("\n")}
                </g>
                
                <!-- Center glow effect -->
                <circle cx="256" cy="256" r="100" fill="none" stroke="${a[0]}" stroke-width="1" opacity="0.2"/>
                <circle cx="256" cy="256" r="150" fill="none" stroke="${a[1]}" stroke-width="0.5" opacity="0.1"/>
            </svg>
        `],{type:"image/svg+xml"})},async uploadToFirebase(e,t){let r=e.type.includes("svg")?"svg":"png",n=(0,ea.ref)(en.storage,`molecules/${t}.${r}`);return await (0,ea.uploadBytes)(n,e),await (0,ea.getDownloadURL)(n)},async getMoleculeImageUrl(e){try{let t=(0,ea.ref)(en.storage,`molecules/${e}.png`);try{return await (0,ea.getDownloadURL)(t)}catch{let t=(0,ea.ref)(en.storage,`molecules/${e}.svg`);return await (0,ea.getDownloadURL)(t)}}catch{return null}},hashString(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return Math.abs(t)},generateAtomPositions(e,t){let r=[];for(let n=0;n<t;n++){let t=(e+137.5*n)%360*(Math.PI/180),a=60+e*(n+1)%120;r.push({x:256+Math.cos(t)*a,y:256+Math.sin(t)*a})}return r},generateBonds(e){let t=[];for(let r=0;r<e.length;r++){let n=(r+1)%e.length;t.push({x1:e[r].x,y1:e[r].y,x2:e[n].x,y2:e[n].y}),r%2==0&&t.push({x1:e[r].x,y1:e[r].y,x2:256,y2:256})}return t}};function el(){let[e,r]=(0,n.useState)([]),[o,i]=(0,n.useState)([]),[s,l]=(0,n.useState)("C"),[c,d]=(0,n.useState)("build"),[u,m]=(0,n.useState)("Select an element and click on the canvas."),[p,b]=(0,n.useState)(null),[x,C]=(0,n.useState)({stability:0,efficacy:0,toxicity:"Low"}),{user:v,refreshProfile:S,profile:A}=(0,V.useAuth)(),[j,w]=(0,n.useState)(!1),[E,O]=(0,n.useState)(g.SYLLABUS_DATA[0]),[N,R]=(0,n.useState)(null),[M,I]=(0,n.useState)(!1),[k,z]=(0,n.useState)(null),[T,H]=(0,n.useState)(!1),[P,B]=(0,n.useState)(""),[L,F]=(0,n.useState)(!1),[G,Y]=(0,n.useState)(null),[X,q]=(0,n.useState)(!1),Z=(0,n.useCallback)(e=>{O(e);let t=e.moleculeTemplate.atoms.map(e=>({id:e.id,element:e.element,x:e.position[0],y:e.position[1],z:e.position[2]})),n=[],a=Date.now();e.moleculeTemplate.bonds.forEach(e=>{let r=t.find(t=>t.id===e.source),o=t.find(t=>t.id===e.target);r&&o&&n.push({id:a++,sourceId:r.id,targetId:o.id,order:e.order||1})}),r(t),i(n),R(null),Q(t,n),m(`Loaded Mission: ${e.title}`)},[]);(0,n.useEffect)(()=>{if(A&&!T){let e=Math.min(A.level||1,8);Z(g.SYLLABUS_DATA.find(t=>t.level===e)||g.SYLLABUS_DATA[0]),H(!0)}},[A,T,Z]),(0,n.useEffect)(()=>{e.length>0?z(_(e,o)):z(null)},[e,o]);let Q=(e,t)=>{let r=_(e,t);r.valid?C({stability:Math.min(100,50+r.score),efficacy:Math.min(100,20+.5*r.score),toxicity:"Low"}):C({stability:Math.max(0,30-2*e.length),efficacy:0,toxicity:"High"})},J=async()=>{I(!0);try{let t=await y.AiService.analyzeMolecule(E.moleculeTemplate.name,e.length,"User modified the structure.");R(t),m("AI analysis complete!")}catch(e){console.error("AI Analysis error:",e),m("Error during AI analysis.")}finally{I(!1)}},en=(0,et.useRouter)(),ea=async()=>{if(!j&&v){w(!0);try{let t=N?Math.floor((N.efficacy+N.safety)/2):50;await U.UserService.addXP(v.uid,2*t),await U.UserService.updateQuestProgress(v.uid,"build_molecule",1);let r=_(e,o),n=await er.TrialService.saveSubmission(v.uid,{moleculeName:E.moleculeTemplate.name+" (Modified)",missionId:E.level,missionTitle:E.title,atomCount:e.length,stats:{efficacy:N?.efficacy||x.efficacy,safety:N?.safety||("Low"===x.toxicity?80:40),stability:x.stability},chemicalStats:{formula:r.formula||"Unknown",molecularWeight:r.molecularWeight||0,functionalGroups:r.functionalGroups||[],bonds:{single:o.filter(e=>1===e.order).length,double:o.filter(e=>2===e.order).length,triple:o.filter(e=>3===e.order).length,aromatic:r.rings?.filter(e=>e.isAromatic).length||0},warnings:r.warnings||[]},aiAnalysis:N?.analysis,imageUrl:y.AiService.generateMoleculeImageUrl(E.moleculeTemplate.name)});m("Generating molecule visualization...");let a=await es.generateMoleculeImage(E.moleculeTemplate.name,n.id,N?.efficacy||x.efficacy,N?.safety||50,N?.visualPrompt);a&&await er.TrialService.updateSubmission(n.id,{generatedImageUrl:a.url}),localStorage.setItem("active_trial_id",n.id),e.length>=5&&await U.UserService.unlockAchievement(v.uid,{id:"first_complex",title:"Molecular Architect",description:"Built a molecule with 5+ atoms",icon:"ðŸ§¬"}),await S(),m("SUCCESS: Design Submitted! Redirecting to Clinical Trials..."),setTimeout(()=>{en.push("/dashboard/clinical-trials")},1500)}catch(e){console.error(e),m("Error submitting design")}finally{w(!1)}}},eo=()=>{if(!P.trim())return void Y("Please enter a SMILES string");let e=D(P.trim());e.success?(r(e.atoms),i(e.bonds),Y(null),F(!1),B(""),R(null),Q(e.atoms,e.bonds),m(`Loaded molecule from SMILES: ${P.trim()}`)):Y(e.error||"Failed to parse SMILES")};return(0,t.jsxs)("div",{className:K.default.container,children:[(0,t.jsxs)("div",{className:K.default.sidebar,children:[A&&(0,t.jsx)(W,{userLevel:A.level||1,currentMissionId:E.level,onSelectMission:Z}),(0,t.jsxs)("div",{className:K.default.header,children:[(0,t.jsxs)("h2",{children:[(0,t.jsx)("span",{style:{color:"#60a5fa"},children:"LABORATORY:"})," ",E.title]}),(0,t.jsx)("p",{style:{fontSize:"0.8rem",color:"#9ca3af",marginTop:"4px"},children:E.description})]}),(0,t.jsxs)("div",{className:K.default.elementList,children:[(0,t.jsx)("h3",{children:"Elements"}),(0,t.jsx)("div",{className:K.default.elementsGrid,children:["C","O","N","H","S","P","F","Cl","Br"].map(e=>{let r=h[e];if(!r)return null;let n=s===e&&"build"===c,a="#"+r.color.toString(16).padStart(6,"0");return(0,t.jsxs)("div",{className:`${K.default.elementCard} ${n?K.default.selected:""}`,onClick:()=>{l(e),d("build"),b(null)},style:{borderColor:n?a:void 0,boxShadow:n?`0 0 12px ${a}40`:void 0},children:[(0,t.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:a,marginBottom:"4px",boxShadow:`inset 0 -3px 6px rgba(0,0,0,0.3), 0 0 8px ${a}50`}}),(0,t.jsx)("b",{style:{fontSize:"0.9rem"},children:e}),(0,t.jsx)("small",{children:r.name})]},e)})})]}),(0,t.jsxs)("div",{className:K.default.controls,children:[(0,t.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,t.jsx)("button",{className:`${K.default.btn} ${"delete"===c?K.default.active:""}`,onClick:()=>{d("delete"===c?"build":"delete"),b(null)},style:{flex:1},children:"ðŸ—‘ï¸ Eraser"}),(0,t.jsx)("button",{className:`${K.default.btn} ${"bond"===c?K.default.active:""}`,onClick:()=>{d("bond"===c?"build":"bond"),b(null)},style:{flex:1,background:"bond"===c?"#7c3aed":void 0},children:"ðŸ”— Bond"})]}),(0,t.jsx)("button",{className:K.default.btn,onClick:()=>{Z(E),m("Template reset to initial state.")},children:"â†º Reset Template"}),(0,t.jsx)("button",{className:`${K.default.btn} ${L?K.default.active:""}`,onClick:()=>F(!L),style:{background:L?"#0ea5e9":void 0},children:"ðŸ“ SMILES Input"}),L&&(0,t.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.9)",border:"1px solid rgba(14, 165, 233, 0.4)",borderRadius:"10px",padding:"12px",marginTop:"4px"},children:[(0,t.jsx)("div",{style:{marginBottom:"8px",fontSize:"0.75rem",color:"#94a3b8"},children:"Enter SMILES notation:"}),(0,t.jsx)("input",{type:"text",value:P,onChange:e=>{B(e.target.value),Y(null)},placeholder:"e.g., CCO (ethanol)",style:{width:"100%",padding:"10px 12px",background:"rgba(30, 41, 59, 0.8)",border:G?"1px solid #ef4444":"1px solid rgba(148, 163, 184, 0.3)",borderRadius:"8px",color:"#e2e8f0",fontSize:"0.9rem",fontFamily:"monospace",marginBottom:"8px"},onKeyDown:e=>"Enter"===e.key&&eo()}),G&&(0,t.jsxs)("div",{style:{color:"#ef4444",fontSize:"0.75rem",marginBottom:"8px"},children:["âš ï¸ ",G]}),(0,t.jsx)("button",{className:`${K.default.btn}`,onClick:eo,style:{width:"100%",marginBottom:"8px",background:"#0ea5e9"},children:"ðŸ§¬ Generate Structure"}),(0,t.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginBottom:"6px"},children:"Quick Examples:"}),(0,t.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:$.slice(0,8).map(e=>(0,t.jsx)("button",{onClick:()=>{var t,n;let a;return t=e.smiles,n=e.name,void((a=D(t)).success?(r(a.atoms),i(a.bonds),Y(null),F(!1),R(null),Q(a.atoms,a.bonds),m(`Loaded ${n} from SMILES`)):Y(a.error||"Failed to parse example"))},style:{padding:"4px 8px",fontSize:"0.65rem",background:"rgba(59, 130, 246, 0.2)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"4px",color:"#60a5fa",cursor:"pointer"},title:e.smiles,children:e.name},e.name))})]}),(0,t.jsx)("button",{className:`${K.default.btn} ${K.default.btnPrimary}`,onClick:J,disabled:M,children:M?"ðŸ¤– Analyzing...":"ðŸ§  AI Analysis"}),(0,t.jsx)("button",{className:K.default.btn,onClick:()=>q(!0),style:{background:"rgba(139, 92, 246, 0.3)",borderColor:"#8b5cf6"},children:"ðŸ“š Chemistry Reference"})]}),N&&(0,t.jsxs)("div",{className:K.default.aiFeedback,children:[(0,t.jsx)("h4",{children:"AI Analysis Report"}),(0,t.jsx)("p",{children:N.analysis}),(0,t.jsxs)("div",{className:K.default.feedbackStats,children:[(0,t.jsxs)("div",{children:["Eff: ",Math.round(N.efficacy),"%"]}),(0,t.jsxs)("div",{children:["Saf: ",Math.round(N.safety),"%"]})]})]}),(0,t.jsx)("button",{className:`${K.default.btn} ${K.default.btnSuccess}`,onClick:ea,disabled:j||!N,style:{marginTop:"auto"},children:j?"Submitting...":"ðŸš€ Submit for Trials"})]}),(0,t.jsxs)("div",{className:K.default.canvasArea,children:[(0,t.jsxs)("div",{className:K.default.canvasHeader,children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"},children:[(0,t.jsx)("div",{className:K.default.statusMsg,children:u}),k&&(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"4px 10px",borderRadius:"6px",fontSize:"0.75rem",fontWeight:600,background:k.valid?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)",border:`1px solid ${k.valid?"#10b981":"#ef4444"}`,color:k.valid?"#10b981":"#ef4444"},children:[k.valid?"âœ“ Valid":"âœ— Invalid",k.name&&(0,t.jsxs)("span",{style:{color:"#60a5fa",marginLeft:"4px"},children:["â€¢ ",k.name]})]}),k?.formula&&(0,t.jsxs)("div",{style:{padding:"4px 10px",borderRadius:"6px",fontSize:"0.75rem",fontWeight:600,background:"rgba(96, 165, 250, 0.15)",border:"1px solid rgba(96, 165, 250, 0.4)",color:"#60a5fa"},children:[k.formula," â€¢ ",k.molecularWeight," g/mol"]})]}),(0,t.jsxs)("div",{className:K.default.propTags,children:[k?.properties?.complexity!==void 0&&(0,t.jsxs)("span",{className:K.default.tag,style:{color:"#a78bfa"},children:["Complexity: ",k.properties.complexity,"%"]}),(0,t.jsxs)("span",{className:K.default.tag,children:["Stab: ",Math.round(x.stability),"%"]}),(0,t.jsxs)("span",{className:K.default.tag,children:["Eff: ",Math.round(x.efficacy),"%"]}),(0,t.jsxs)("span",{className:K.default.tag,style:{color:"Low"===x.toxicity?"#10b981":"#ef4444"},children:["Tox: ",x.toxicity]})]})]}),k?.functionalGroups&&k.functionalGroups.length>0&&(0,t.jsxs)("div",{style:{position:"absolute",top:"60px",right:"16px",background:"rgba(30, 41, 59, 0.95)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"10px",padding:"12px",zIndex:10,maxWidth:"220px",fontSize:"0.75rem",backdropFilter:"blur(8px)"},children:[(0,t.jsx)("div",{style:{fontWeight:700,marginBottom:"8px",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Functional Groups"}),k.functionalGroups.map((e,r)=>(0,t.jsx)("div",{style:{marginBottom:"4px",color:"#e2e8f0"},children:e},r))]}),k&&(k.errors.length>0||k.warnings.length>0)&&(0,t.jsxs)("div",{style:{position:"absolute",bottom:"16px",left:"16px",background:k.valid?"rgba(30, 58, 95, 0.95)":"rgba(127, 29, 29, 0.9)",border:`1px solid ${k.valid?"rgba(96, 165, 250, 0.4)":"rgba(239, 68, 68, 0.4)"}`,borderRadius:"10px",padding:"12px",zIndex:10,maxWidth:"380px",fontSize:"0.75rem",backdropFilter:"blur(8px)"},children:[!k.valid&&k.errors.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{fontWeight:700,marginBottom:"6px",color:"#ef4444"},children:"âš ï¸ Valence Issues:"}),k.errors.slice(0,3).map((e,r)=>(0,t.jsxs)("div",{style:{marginBottom:"2px",color:"#fca5a5"},children:["â€¢ ",e]},`err-${r}`)),k.errors.length>3&&(0,t.jsxs)("div",{style:{color:"#9ca3af",marginTop:"4px"},children:["...and ",k.errors.length-3," more"]})]}),k.warnings.length>0&&(0,t.jsx)("div",{style:{marginTop:k.errors.length>0?"10px":"0"},children:k.warnings.slice(0,4).map((e,r)=>(0,t.jsx)("div",{style:{marginBottom:"4px",color:e.startsWith("âœ…")?"#86efac":e.startsWith("âš ï¸")?"#fcd34d":e.startsWith("ðŸ’Š")?"#c4b5fd":e.startsWith("ðŸ”µ")?"#93c5fd":"#e2e8f0"},children:e},`warn-${r}`))})]}),(0,t.jsx)(f,{atoms:e,bonds:o,selectedElement:"build"===c?s:null,onEmptyClick:t=>{if("build"===c){let n={id:Date.now(),element:s,x:t.x,y:t.y,z:t.z},l=[],c=Date.now();e.forEach(e=>{2>new a.Vector3(e.x,e.y,e.z).distanceTo(t)&&l.push({id:c++,sourceId:e.id,targetId:n.id,order:1})});let d=[...e,n],u=[...o,...l];r(d),i(u),Q(d,u),m(`Added ${h[s].name}`)}},onAtomClick:t=>{if("delete"===c){let n=e.filter(e=>e.id!==t),a=o.filter(e=>e.sourceId!==t&&e.targetId!==t);r(n),i(a),Q(n,a),m("Atom deleted")}else if("bond"===c)if(null===p)b(t),m(`Bonding: Selected first atom (ID: ${t}). Click another atom to connect.`);else if(p!==t){if(o.some(e=>e.sourceId===p&&e.targetId===t||e.sourceId===t&&e.targetId===p))m("Bond already exists between these atoms.");else{let r=[...o,{id:Date.now(),sourceId:p,targetId:t,order:1}];i(r),Q(e,r),m("Bond created between atoms!")}b(null)}else b(null),m("Bonding cancelled.");else{let r=e.find(e=>e.id===t);if(r){let e=h[r.element];m(`${e?.name||r.element} atom selected`)}}}})]}),(0,t.jsx)(ee,{isOpen:X,onClose:()=>q(!1)})]})}function ec(){return(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,t.jsx)(r.default,{title:"Molecular Builder",subtitle:"Design complex molecular chains with real-time stability simulation."}),(0,t.jsx)("div",{style:{flex:1,padding:"0 40px 40px"},children:(0,t.jsx)(el,{})})]})}e.s(["default",()=>ec],16944)}]);